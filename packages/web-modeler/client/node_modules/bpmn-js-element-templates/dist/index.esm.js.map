{"version":3,"file":"index.esm.js","sources":["../src/cloud-element-templates/util/FeelUtil.js","../src/cloud-element-templates/Helper.js","../src/element-templates/Helper.js","../src/element-templates/ElementTemplates.js","../src/cloud-element-templates/util/bindingTypes.js","../src/cloud-element-templates/util/timerUtil.js","../src/cloud-element-templates/ElementTemplates.js","../src/element-templates/Validator.js","../src/cloud-element-templates/Validator.js","../src/element-templates/ElementTemplatesLoader.js","../src/cloud-element-templates/ElementTemplatesLoader.js","../src/utils/ElementUtil.js","../src/cloud-element-templates/CreateHelper.js","../src/cloud-element-templates/util/taskDefinition.js","../src/cloud-element-templates/util/rootElementUtil.js","../src/cloud-element-templates/util/bpmnExpressionUtil.js","../src/cloud-element-templates/cmd/ChangeElementTemplateHandler.js","../src/cloud-element-templates/cmd/RemoveElementTemplateHandler.js","../src/cloud-element-templates/cmd/UnlinkElementTemplateHandler.js","../src/element-templates/cmd/MultiCommandHandler.js","../src/cloud-element-templates/cmd/ElementTemplateCommands.js","../src/cloud-element-templates/cmd/index.js","../src/cloud-element-templates/create/PropertyBindingProvider.js","../src/cloud-element-templates/create/TaskDefinitionBindingProvider.js","../src/cloud-element-templates/create/InputBindingProvider.js","../src/cloud-element-templates/create/OutputBindingProvider.js","../src/cloud-element-templates/create/TaskHeaderBindingProvider.js","../src/cloud-element-templates/create/ZeebePropertiesProvider.js","../src/cloud-element-templates/create/MessagePropertyBindingProvider.js","../src/cloud-element-templates/create/MessageZeebeSubscriptionBindingProvider.js","../src/cloud-element-templates/create/SignalPropertyBindingProvider.js","../src/cloud-element-templates/create/TimerPropertyBindingProvider.js","../src/cloud-element-templates/create/CalledElementBindingProvider.js","../src/cloud-element-templates/create/LinkedResourceProvider.js","../src/cloud-element-templates/create/ZeebeUserTaskBindingProvider.js","../src/cloud-element-templates/create/CalledDecisionBindingProvider.js","../src/cloud-element-templates/create/ScriptTaskBindingProvider.js","../src/cloud-element-templates/create/FormDefinitionBindingProvider.js","../src/cloud-element-templates/create/AssignmentDefinitionBindingProvider.js","../src/cloud-element-templates/create/PriorityDefinitionBindingProvider.js","../src/cloud-element-templates/create/AdHocBindingProvider.js","../src/cloud-element-templates/create/TaskScheduleBindingProvider.js","../src/cloud-element-templates/util/propertyUtil.js","../src/cloud-element-templates/Condition.js","../src/cloud-element-templates/create/TemplateElementFactory.js","../src/cloud-element-templates/create/index.js","../src/cloud-element-templates/behavior/ConditionalBehavior.js","../src/cloud-element-templates/behavior/ReplaceBehavior.js","../src/cloud-element-templates/behavior/TimerTemplateBehavior.js","../src/cloud-element-templates/behavior/UpdatePropertiesOrderBehavior.js","../src/cloud-element-templates/behavior/ReferencedElementBehavior.js","../src/cloud-element-templates/behavior/GeneratedValueBehavior.js","../src/cloud-element-templates/behavior/CalledElementBehavior.js","../src/cloud-element-templates/behavior/UserTaskBehavior.js","../src/cloud-element-templates/behavior/index.js","../src/cloud-element-templates/core/index.js","../src/utils/templateUtil.js","../src/components/ElementTemplatesGroup.js","../src/components/TemplateProps.js","../node_modules/preact-markup/dist/preact-markup.module.js","../src/utils/sanitize.js","../src/cloud-element-templates/properties-panel/components/PropertyTooltip.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/util.js","../src/components/PropertyDescription.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/TextAreaProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/StringProperty.js","../src/entries/HOCs/withVariableContext.js","../src/entries/HOCs/withTooltipContainer.js","../src/entries/FeelEntryWithContext.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/FeelProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/FeelTextAreaProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/DropdownProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/BooleanProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/NumberProperty.js","../src/cloud-element-templates/properties-panel/properties/custom-properties/index.js","../src/entries/ReferenceSelect.js","../src/utils/EventDefinitionUtil.js","../src/cloud-element-templates/properties-panel/properties/MessageProps.js","../src/cloud-element-templates/properties-panel/properties/SignalProps.js","../src/cloud-element-templates/properties-panel/ElementTemplatesPropertiesProvider.js","../src/cloud-element-templates/properties-panel/index.js","../src/cloud-element-templates/index.js","../src/element-templates/util/handleLegacyScopes.js","../src/element-templates/CreateHelper.js","../src/element-templates/cmd/ChangeElementTemplateHandler.js","../src/element-templates/cmd/RemoveElementTemplateHandler.js","../src/element-templates/cmd/UnlinkElementTemplateHandler.js","../src/element-templates/cmd/ElementTemplateCommands.js","../src/element-templates/cmd/index.js","../src/element-templates/behavior/ReplaceBehavior.js","../src/element-templates/behavior/index.js","../src/element-templates/core/index.js","../src/element-templates/util/bindingTypes.js","../src/element-templates/properties-panel/properties/CustomProperties.js","../src/element-templates/properties-panel/properties/ErrorProperties.js","../src/element-templates/properties-panel/properties/InputProperties.js","../src/element-templates/util/validationUtil.js","../src/element-templates/properties-panel/properties/OutputProperties.js","../src/element-templates/properties-panel/ElementTemplatesPropertiesProvider.js","../src/element-templates/properties-panel/index.js","../src/element-templates/index.js","../src/cloud-element-templates/linting/rules/element-templates-validate.js","../src/cloud-element-templates/linting/rules/element-templates-compatibility.js","../node_modules/bpmn-moddle/node_modules/moddle/dist/index.js","../node_modules/bpmn-moddle/node_modules/saxen/dist/index.js","../node_modules/bpmn-moddle/node_modules/moddle-xml/dist/index.js","../node_modules/bpmn-moddle/dist/index.js","../src/cloud-element-templates/linting/index.js"],"sourcesContent":["/**\n * Check if the property is cast to FEEL expression:\n * - Boolean and Number properties with feel set to 'optional' or 'static'\n * - Boolean and Number input/output parameters have default feel=static\n *\n * @returns {boolean}\n */\nexport const shouldCastToFeel = (property) => {\n  const feel = getFeelValue(property);\n\n  return [ 'optional', 'static' ].includes(feel) && [ 'Boolean', 'Number' ].includes(property.type);\n};\n\nconst ALWAYS_CAST_TO_FEEL = [\n  'zeebe:input',\n  'zeebe:output'\n];\n\nfunction getFeelValue(property) {\n  if (ALWAYS_CAST_TO_FEEL.includes(property.binding.type)) {\n    return property.feel || 'static';\n  }\n\n  return property.feel;\n}\n\nexport const toFeelExpression = (value, type) => {\n  if (typeof value === 'string' && value.startsWith('=')) {\n    return value;\n  }\n\n  if (type === 'Boolean') {\n    value = value === 'false' ? false : value;\n    return '=' + !!value;\n  }\n\n  if (typeof value === 'undefined') {\n    return value;\n  }\n\n  return '=' + value.toString();\n};","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { is, isAny } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { v4 as uuid } from 'uuid';\nimport { shouldCastToFeel, toFeelExpression } from './util/FeelUtil';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template ID is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_ID_ATTR = 'zeebe:modelerTemplate';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template version is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_VERSION_ATTR = 'zeebe:modelerTemplateVersion';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template icon is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_ICON_ATTR = 'zeebe:modelerTemplateIcon';\n\n\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateId(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_ID_ATTR);\n  }\n}\n\n/**\n * Get template version for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateVersion(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_VERSION_ATTR);\n  }\n}\n\n/**\n * Get template icon for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateIcon(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_ICON_ATTR);\n  }\n}\n\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\nexport function findExtension(element, type) {\n  const businessObject = getBusinessObject(element);\n\n  let extensionElements;\n\n  if (is(businessObject, 'bpmn:ExtensionElements')) {\n    extensionElements = businessObject;\n  } else {\n    extensionElements = businessObject.get('extensionElements');\n  }\n\n  if (!extensionElements) {\n    return;\n  }\n\n  return extensionElements.get('values').find((value) => {\n    return is(value, type);\n  });\n}\n\nexport function findExtensions(element, types) {\n  const businessObject = getBusinessObject(element);\n\n  let extensionElements;\n\n  if (is(businessObject, 'bpmn:ExtensionElements')) {\n    extensionElements = businessObject;\n  } else {\n    extensionElements = businessObject.get('extensionElements');\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return extensionElements.get('values').filter((value) => {\n    return isAny(value, types);\n  });\n}\n\nexport function findZeebeProperty(zeebeProperties, binding) {\n  return zeebeProperties.get('properties').find((value) => {\n    return value.name === binding.name;\n  });\n}\n\nexport function findInputParameter(ioMapping, binding) {\n  const parameters = ioMapping.get('inputParameters');\n\n  return parameters.find((parameter) => {\n    return parameter.target === binding.name;\n  });\n}\n\nexport function findOutputParameter(ioMapping, binding) {\n  const parameters = ioMapping.get('outputParameters');\n\n  return parameters.find((parameter) => {\n    return parameter.source === binding.source;\n  });\n}\n\nexport function findTaskHeader(taskHeaders, binding) {\n  const headers = taskHeaders.get('values');\n\n  return headers.find((header) => {\n    return header.key === binding.key;\n  });\n}\n\n/**\n * Find message referred to in an event, an event definition, or a task.\n * @param {ModdleElement} businessObject\n */\nexport function findMessage(businessObject) {\n  if (is(businessObject, 'bpmn:Event')) {\n    const eventDefinitions = businessObject.get('eventDefinitions');\n\n    if (!eventDefinitions || !eventDefinitions.length) {\n      return;\n    }\n\n    businessObject = eventDefinitions[0];\n  }\n\n  if (!businessObject) {\n    return;\n  }\n\n  return businessObject.get('messageRef');\n}\n\n/**\n * Find signal referred to in an event or an event definition.\n * @param {ModdleElement} businessObject\n */\nexport function findSignal(businessObject) {\n  if (is(businessObject, 'bpmn:Event')) {\n    const eventDefinitions = businessObject.get('eventDefinitions');\n\n    if (!eventDefinitions || !eventDefinitions.length) {\n      return;\n    }\n\n    businessObject = eventDefinitions[0];\n  }\n\n  if (!businessObject) {\n    return;\n  }\n\n  return businessObject.get('signalRef');\n}\n\n/**\n * Find timer event definition in an event.\n * @param {ModdleElement|element} element\n */\nexport function findTimerEventDefinition(element) {\n  const businessObject = getBusinessObject(element);\n  if (is(businessObject, 'bpmn:Event')) {\n    const eventDefinitions = businessObject.get('eventDefinitions');\n\n    if (!eventDefinitions.length) {\n      return;\n    }\n\n    return eventDefinitions.find(def => is(def, 'bpmn:TimerEventDefinition'));\n  }\n}\n\nexport function findZeebeSubscription(message) {\n  return findExtension(message, 'zeebe:Subscription');\n}\n\n/**\n * Get the default value disregarding generated values.\n */\nexport function getDefaultFixedValue(property) {\n  if (\n    shouldCastToFeel(property) || property.feel === 'required'\n  ) {\n    return toFeelExpression(property.value, property.type);\n  }\n\n  return property.value;\n}\n\nexport function getDefaultValue(property) {\n\n  const value = getDefaultFixedValue(property);\n\n  if (value !== undefined) {\n    return value;\n  }\n\n  if (property.generatedValue) {\n    const { type } = property.generatedValue;\n\n    if (type === 'uuid') {\n      return uuid();\n    }\n  }\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { is, isAny } from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  filter,\n  flatten,\n  has,\n  isNil,\n  isObject,\n  isString,\n  isUndefined,\n  reduce,\n  values\n} from 'min-dash';\n\nimport {\n  satisfies as isSemverCompatible\n} from 'semver';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template ID is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_ID_ATTR = 'camunda:modelerTemplate';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template version is stored.\n *\n * @type {String}\n */\nexport const TEMPLATE_VERSION_ATTR = 'camunda:modelerTemplateVersion';\n\n/**\n * Returns incompatible engines for a given template.\n *\n * @param {Object} template\n * @param {Object} checkEngines\n *\n * @return {Object}\n */\nexport function getIncompatibleEngines(template, checkEngines) {\n  const templateEngines = template.engines;\n\n  return reduce(templateEngines, (result, _, engine) => {\n\n    if (!has(checkEngines, engine)) {\n      return result;\n    }\n\n    if (!isSemverCompatible(checkEngines[engine], templateEngines[engine])) {\n      result[engine] = {\n        actual: checkEngines[engine],\n        required: templateEngines[engine]\n      };\n    }\n\n    return result;\n  }, {});\n}\n\n/**\n * Returns whether a template is compatible with the given engines.\n *\n * @param {Object} template\n * @param {Object} checkEngines\n *\n * @return {boolean}\n */\nexport function isCompatible(template, checkEngines) {\n  return !Object.keys(getIncompatibleEngines(template, checkEngines)).length;\n}\n\n/**\n * Build a map of templates grouped by id.\n *\n * @param {Array<Object>} templates\n * @param {Object} engines\n *\n * @return {Object}\n */\nexport function buildTemplatesById(templates, engines) {\n  const templatesById = {};\n\n  templates.forEach((template) => {\n    const id = template.id;\n    const version = isUndefined(template.version) ? '_' : template.version;\n\n    if (!templatesById[id]) {\n      templatesById[id] = {};\n    }\n\n    templatesById[id][version] = template;\n\n    const latest = templatesById[id].latest;\n\n    if (isCompatible(template, engines)) {\n      if (!latest || isUndefined(latest.version) || latest.version < version)\n      {\n        templatesById[id].latest = template;\n      }\n    }\n  });\n\n  return templatesById;\n}\n\n/**\n * Finds the list of templates that match the given criteria within a template index.\n *\n * @param {string|djs.model.Base} [elementOrTemplateId]\n * @param {Object} templatesIndex\n * @param {Object} [options]\n * @param {boolean} [options.latest]\n * @param {boolean} [options.deprecated]\n *\n * @return {Array<Object>}\n */\nexport function findTemplates(elementOrTemplateId, templatesIndex, options = {}) {\n  const {\n    latest: includeLatestOnly,\n    deprecated: includeDeprecated\n  } = options;\n\n  const getVersions = (template) => {\n    const { latest, ...versions } = template;\n    return includeLatestOnly ? (\n      !includeDeprecated && (latest && latest.deprecated) ? [] : (latest ? [ latest ] : [])\n    ) : values(versions) ;\n  };\n\n  if (isNil(elementOrTemplateId)) {\n    return flatten(values(templatesIndex).map(getVersions));\n  }\n\n  if (isObject(elementOrTemplateId)) {\n    const element = elementOrTemplateId;\n\n    return filter(findTemplates(null, templatesIndex, options), function(template) {\n      return isAny(element, template.appliesTo);\n    }) || [];\n  }\n\n  if (isString(elementOrTemplateId)) {\n    return templatesIndex[ elementOrTemplateId ] && getVersions(templatesIndex[ elementOrTemplateId ]);\n  }\n\n  throw new Error('argument must be of type {string|djs.model.Base|undefined}');\n}\n\n\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateId(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_ID_ATTR);\n  }\n}\n\n/**\n * Get template version for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nexport function getTemplateVersion(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (businessObject) {\n    return businessObject.get(TEMPLATE_VERSION_ATTR);\n  }\n}\n\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\nexport function findExtension(element, type) {\n  const businessObject = getBusinessObject(element);\n\n  let extensionElements;\n\n  if (is(businessObject, 'bpmn:ExtensionElements')) {\n    extensionElements = businessObject;\n  } else {\n    extensionElements = businessObject.get('extensionElements');\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return extensionElements.get('values').find((value) => {\n    return is(value, type);\n  });\n}\n\nexport function findExtensions(element, types) {\n  const extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return [];\n  }\n\n  return extensionElements.get('values').filter((value) => {\n    return isAny(value, types);\n  });\n}\n\nexport function findCamundaInOut(element, binding) {\n  const extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return;\n  }\n\n  const { type } = binding;\n\n  let matcher;\n\n  if (type === 'camunda:in') {\n    matcher = (element) => {\n      return is(element, 'camunda:In') && isInOut(element, binding);\n    };\n  } else if (type === 'camunda:out') {\n    matcher = (element) => {\n      return is(element, 'camunda:Out') && isInOut(element, binding);\n    };\n  } else if (type === 'camunda:in:businessKey') {\n    matcher = (element) => {\n      return is(element, 'camunda:In') && 'businessKey' in element;\n    };\n  }\n\n  return extensionElements.get('values').find(matcher);\n}\n\nexport function findCamundaProperty(camundaProperties, binding) {\n  return camundaProperties.get('values').find((value) => {\n    return value.name === binding.name;\n  });\n}\n\nexport function findInputParameter(inputOutput, binding) {\n  const parameters = inputOutput.get('inputParameters');\n\n  return parameters.find((parameter) => {\n    return parameter.name === binding.name;\n  });\n}\n\nexport function findOutputParameter(inputOutput, binding) {\n  const parameters = inputOutput.get('outputParameters');\n\n  return parameters.find(function(parameter) {\n    const { value } = parameter;\n\n    if (!binding.scriptFormat) {\n      return value === binding.source;\n    }\n\n    const definition = parameter.get('camunda:definition');\n\n    if (!definition || binding.scriptFormat !== definition.get('camunda:scriptFormat')) {\n      return false;\n    }\n\n    return definition.get('camunda:value') === binding.source;\n  });\n}\n\nexport function findCamundaErrorEventDefinition(element, errorRef) {\n  const errorEventDefinitions = findExtensions(element, [ 'camunda:ErrorEventDefinition' ]);\n\n  let error;\n\n  // error ID has to start with <Error_${ errorRef }_>\n  return errorEventDefinitions.find((definition) => {\n    error = definition.get('bpmn:errorRef');\n\n    if (error) {\n      return error.get('bpmn:id').startsWith(`Error_${ errorRef }`);\n    }\n  });\n}\n\nexport function findError(element, errorRef) {\n  const root = getRoot(getBusinessObject(element)),\n        rootElements = root.get('rootElements');\n\n  return rootElements.find((rootElement) => {\n    return is(rootElement, 'bpmn:Error')\n      && rootElement.get('id').startsWith(`Error_${ errorRef }`);\n  });\n}\n\n\n// helpers //////////\n\nfunction getExtensionElements(element) {\n  const businessObject = getBusinessObject(element);\n\n  if (is(businessObject, 'bpmn:ExtensionElements')) {\n    return businessObject;\n  } else {\n    return businessObject.get('extensionElements');\n  }\n}\n\n\nfunction isInOut(element, binding) {\n\n  if (binding.type === 'camunda:in') {\n\n    // find based on target attribute\n    if (binding.target) {\n      return element.target === binding.target;\n    }\n  }\n\n  if (binding.type === 'camunda:out') {\n\n    // find based on source / sourceExpression\n    if (binding.source) {\n      return element.source === binding.source;\n    }\n\n    if (binding.sourceExpression) {\n      return element.sourceExpression === binding.sourceExpression;\n    }\n  }\n\n  // find based variables / local combination\n  if (binding.variables) {\n    return element.variables === 'all' && (\n      binding.variables !== 'local' || element.local\n    );\n  }\n}\n\nfunction getRoot(businessObject) {\n  let parent = businessObject;\n\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n\n  return parent;\n}","import {\n  find,\n  isString,\n  isUndefined,\n  reduce\n} from 'min-dash';\n\nimport {\n  getTemplateId,\n  getTemplateVersion,\n  findTemplates,\n  buildTemplatesById,\n  getIncompatibleEngines as _getIncompatibleEngines,\n  isCompatible as _isCompatible\n} from './Helper';\n\nimport { coerce, valid as isSemverValid } from 'semver';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\n// eslint-disable-next-line no-undef\nconst packageVersion = process.env.PKG_VERSION;\n\n/**\n * @typedef {import('bpmn-js/lib/model/Types').Element} Element\n */\n\n/**\n * Registry for element templates.\n */\nexport default class ElementTemplates {\n  constructor(commandStack, eventBus, modeling, injector, config) {\n    this._commandStack = commandStack;\n    this._eventBus = eventBus;\n    this._injector = injector;\n    this._modeling = modeling;\n\n    this._templatesById = {};\n    this._templates = [];\n\n    config = config || {};\n\n    this._engines = this._coerceEngines(config.engines || {});\n\n    eventBus.on('elementTemplates.engines.changed', event => {\n      this.set(this._templates);\n    });\n  }\n\n  /**\n   * Get template with given ID and optional version or for element.\n   *\n   * @param {String|Element} elementOrTemplateId\n   * @param {number} [version]\n   *\n   * @return {ElementTemplate}\n   */\n  get(elementOrTemplateId, version) {\n    const templates = this._templatesById;\n\n    let element;\n\n    if (isUndefined(elementOrTemplateId)) {\n      return null;\n    } else if (isString(elementOrTemplateId)) {\n\n      if (isUndefined(version)) {\n        version = '_';\n      }\n\n      if (templates[ elementOrTemplateId ] && templates[ elementOrTemplateId ][ version ]) {\n        return templates[ elementOrTemplateId ][ version ];\n      } else {\n        return null;\n      }\n    } else {\n      element = elementOrTemplateId;\n\n      return this.get(this._getTemplateId(element), this._getTemplateVersion(element));\n    }\n  }\n\n  /**\n   * Get default template for given element.\n   *\n   * @param {Element} element\n   *\n   * @return {ElementTemplate}\n   */\n  getDefault(element) {\n    return find(this.getAll(element), function(template) {\n      return template.isDefault;\n    }) || null;\n  }\n\n  /**\n   * Get all templates (with given ID or applicable to element).\n   *\n   * @param {string|Element} [elementOrTemplateId]\n   * @return {Array<ElementTemplate>}\n   */\n  getAll(elementOrTemplateId) {\n    return findTemplates(elementOrTemplateId, this._templatesById, { deprecated: true });\n  }\n\n\n  /**\n   * Get all templates (with given ID or applicable to element) with the latest\n   * version.\n   *\n   * @param {String|Element} [elementOrTemplateId]\n   * @param {{ deprecated?: boolean }} [options]\n   *\n   * @return {Array<ElementTemplate>}\n   */\n  getLatest(elementOrTemplateId, options = {}) {\n    return findTemplates(elementOrTemplateId, this._templatesById, {\n      ...options,\n      latest: true\n    });\n  }\n\n  /**\n   * Get templates compatible with a given engine configuration override.\n   *\n   * @param {string|Element} [elementOrTemplateId]\n   * @param {Object} enginesOverrides\n   * @param {Object} [options]\n   * @param {boolean} [options.deprecated=false]\n   * @param {boolean} [options.latest=true]\n   *\n   * @returns {Array<ElementTemplate>}\n   */\n  getCompatible(elementOrTemplateId, enginesOverrides = {}, options = {}) {\n    const overridenEngines = this._coerceEngines({ ...this._engines, ...enginesOverrides });\n    const templatesById = buildTemplatesById(this._templates, overridenEngines);\n\n    return findTemplates(elementOrTemplateId, templatesById, {\n      latest: true,\n      ...options\n    });\n  }\n\n  /**\n   * Set templates.\n   *\n   * @param {Array<ElementTemplate>} templates\n   */\n  set(templates) {\n    this._templates = templates;\n    this._templatesById = buildTemplatesById(this._templates, this._engines);\n\n    this._fire('changed');\n  }\n\n  getEngines() {\n    return this._engines;\n  }\n\n  setEngines(engines) {\n    this._engines = this._coerceEngines(engines);\n    this._fire('engines.changed');\n  }\n\n  /**\n   * Ensures that only valid engines are kept around\n   *\n   * @param { Record<string, string> } engines\n   *\n   * @return { Record<string, string> } filtered, valid engines\n   */\n  _coerceEngines(engines) {\n\n    // we provide <elementTemplates> engine with the current\n    // package version; templates may use that engine to declare\n    // compatibility with this library\n    engines = {\n      elementTemplates: packageVersion,\n      ...engines\n    };\n\n    return reduce(engines, (validEngines, version, engine) => {\n\n      const coercedVersion = coerce(version);\n\n      if (!isSemverValid(coercedVersion)) {\n        console.error(\n          new Error(`Engine <${ engine }> specifies unparseable version <${version}>`)\n        );\n\n        return validEngines;\n      }\n\n      return {\n        ...validEngines,\n        [ engine ]: coercedVersion.raw\n      };\n    }, {});\n  }\n\n  /**\n   * Check if template is compatible with currently set engine version.\n   *\n   * @param {ElementTemplate} template\n   *\n   * @return {boolean} - true if compatible or no engine is set for elementTemplates or template.\n   */\n  isCompatible(template) {\n    return _isCompatible(template, this._engines);\n  }\n\n  /**\n   * Get engines that are incompatible with the template.\n   *\n   * @param {any} template\n   *\n   * @return { Record<string, { required: string, found: string } } - incompatible engines along with their template and local versions\n   */\n  getIncompatibleEngines(template) {\n    return _getIncompatibleEngines(template, this._engines);\n  }\n\n  /**\n   * Get template versions for a given element or template ID.\n   *\n   * @param {object|string|null} id\n   * @param { { latest?: boolean, deprecated?: boolean } [options]\n   *\n   * @return {Array<ElementTemplate>}\n   */\n  _getTemplateVerions(id, options = {}) {\n    return findTemplates(id, this._templatesById, options);\n  }\n\n  _getTemplateId(element) {\n    return getTemplateId(element);\n  }\n\n  _getTemplateVersion(element) {\n    return getTemplateVersion(element);\n  }\n\n  /**\n   * Apply element template to a given element.\n   *\n   * @param {Element} element\n   * @param {ElementTemplate} newTemplate\n   *\n   * @return {Element} the updated element\n   */\n  applyTemplate(element, newTemplate) {\n    const oldTemplate = this.get(element);\n\n    const context = {\n      element,\n      newTemplate,\n      oldTemplate\n    };\n\n    const event = oldTemplate?.id === newTemplate?.id ? 'update' : 'apply';\n\n    this._commandStack.execute('propertiesPanel.camunda.changeTemplate', context);\n\n    this._fire(event, {\n      element,\n      newTemplate,\n      oldTemplate\n    });\n\n    return context.element;\n  }\n\n  _fire(action, payload) {\n    return this._eventBus.fire(`elementTemplates.${action}`, payload);\n  }\n\n  /**\n   * Remove template from a given element.\n   *\n   * @param {Element} element\n   *\n   * @return {Element} the updated element\n   */\n  removeTemplate(element) {\n    const oldTemplate = this.get(element);\n\n    const context = {\n      element,\n      oldTemplate\n    };\n\n    this._commandStack.execute('propertiesPanel.removeTemplate', context);\n\n    this._fire('remove', {\n      element,\n      oldTemplate\n    });\n\n    return context.newElement;\n  }\n\n  /**\n   * Unlink template from a given element.\n   *\n   * @param {Element} element\n   *\n   * @return {Element} the updated element\n   */\n  unlinkTemplate(element) {\n    const oldTemplate = this.get(element);\n\n    const context = {\n      element,\n      oldTemplate\n    };\n\n    this._commandStack.execute('propertiesPanel.unlinkTemplate', context);\n\n    this._fire('unlink', {\n      element,\n      oldTemplate\n    });\n\n    return context.element;\n  }\n}\n\nElementTemplates.$inject = [\n  'commandStack',\n  'eventBus',\n  'modeling',\n  'injector',\n  'config.elementTemplates'\n];","export const PROPERTY_TYPE = 'property';\n\nexport const ZEBBE_PROPERTY_TYPE = 'zeebe:property';\nexport const ZEBBE_INPUT_TYPE = 'zeebe:input';\nexport const ZEEBE_OUTPUT_TYPE = 'zeebe:output';\nexport const ZEEBE_PROPERTY_TYPE = 'zeebe:property';\nexport const ZEEBE_TASK_DEFINITION_TYPE_TYPE = 'zeebe:taskDefinition:type';\nexport const ZEEBE_TASK_DEFINITION = 'zeebe:taskDefinition';\nexport const ZEEBE_TASK_HEADER_TYPE = 'zeebe:taskHeader';\nexport const MESSAGE_PROPERTY_TYPE = 'bpmn:Message#property';\nexport const MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE = 'bpmn:Message#zeebe:subscription#property';\nexport const SIGNAL_PROPERTY_TYPE = 'bpmn:Signal#property';\nexport const TIMER_EVENT_DEFINITION_PROPERTY_TYPE = 'bpmn:TimerEventDefinition#property';\nexport const ZEEBE_CALLED_ELEMENT = 'zeebe:calledElement';\nexport const ZEEBE_LINKED_RESOURCE_PROPERTY = 'zeebe:linkedResource';\nexport const ZEEBE_USER_TASK = 'zeebe:userTask';\nexport const ZEEBE_CALLED_DECISION = 'zeebe:calledDecision';\nexport const ZEEBE_FORM_DEFINITION = 'zeebe:formDefinition';\nexport const ZEEBE_SCRIPT_TASK = 'zeebe:script';\nexport const ZEEBE_ASSIGNMENT_DEFINITION = 'zeebe:assignmentDefinition';\nexport const ZEEBE_PRIORITY_DEFINITION = 'zeebe:priorityDefinition';\nexport const ZEEBE_AD_HOC = 'zeebe:adHoc';\nexport const ZEEBE_TASK_SCHEDULE = 'zeebe:taskSchedule';\n\nexport const EXTENSION_BINDING_TYPES = [\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE,\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE,\n  ZEEBE_PROPERTY_TYPE,\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION,\n  ZEEBE_TASK_HEADER_TYPE,\n  ZEEBE_CALLED_ELEMENT,\n  ZEEBE_LINKED_RESOURCE_PROPERTY,\n  ZEEBE_CALLED_DECISION,\n  ZEEBE_FORM_DEFINITION,\n  ZEEBE_SCRIPT_TASK,\n  ZEEBE_ASSIGNMENT_DEFINITION,\n  ZEEBE_PRIORITY_DEFINITION,\n  ZEEBE_AD_HOC,\n  ZEEBE_TASK_SCHEDULE\n];\n\nexport const TASK_DEFINITION_TYPES = [\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION\n];\n\nexport const IO_BINDING_TYPES = [\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE\n];\n\nexport const MESSAGE_BINDING_TYPES = [\n  MESSAGE_PROPERTY_TYPE,\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE\n];\n\nexport const PROPERTY_BINDING_TYPES = [\n  PROPERTY_TYPE,\n  MESSAGE_PROPERTY_TYPE,\n  SIGNAL_PROPERTY_TYPE\n];","import { getBusinessObject, is, isAny } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { TIMER_EVENT_DEFINITION_PROPERTY_TYPE } from './bindingTypes';\n\n/**\n * Check whether a given timer expression type is supported for a given element.\n *\n * @param {string} type - 'timeDate', 'timeCycle', or 'timeDuration'\n * @param {Element} element\n * @return {boolean}\n */\nexport function isTimerExpressionTypeSupported(type, element) {\n  const businessObject = getBusinessObject(element);\n\n  switch (type) {\n  case 'timeDate':\n    return isAny(element, [\n      'bpmn:BoundaryEvent',\n      'bpmn:IntermediateCatchEvent',\n      'bpmn:StartEvent'\n    ]);\n\n  case 'timeCycle':\n\n    if (is(element, 'bpmn:StartEvent') && (!hasParentEventSubProcess(businessObject) || !isInterrupting(businessObject))) {\n      return true;\n    }\n\n    if (is(element, 'bpmn:BoundaryEvent') && !isInterrupting(businessObject)) {\n      return true;\n    }\n\n    return false;\n\n  case 'timeDuration':\n    if (isAny(element, [\n      'bpmn:BoundaryEvent',\n      'bpmn:IntermediateCatchEvent'\n    ])) {\n      return true;\n    }\n\n    if (is(element, 'bpmn:StartEvent') && hasParentEventSubProcess(businessObject)) {\n      return true;\n    }\n\n    return false;\n\n  default:\n    return false;\n  }\n}\n\n/**\n * Check if the template is a timer template and if so, whether it is applicable\n *\n * @param {Object} template\n * @param {Element} element\n * @return {boolean}\n */\nexport function isTimerTemplateApplicable(template, element) {\n\n  // Find timer binding in template\n  const timerBinding = template.properties?.find(property => {\n    return property.binding?.type === TIMER_EVENT_DEFINITION_PROPERTY_TYPE;\n  });\n\n  // No timer binding - template is applicable\n  if (!timerBinding) {\n    return true;\n  }\n\n  const timerType = timerBinding.binding.name;\n\n  // Check if the timer type can be applied (possibly with auto-conversion)\n  return canTimerTypeBeAppliedWithConversion(timerType, element);\n}\n\n/**\n * Check if a timer type can be applied to an element, possibly with auto-conversion.\n *\n * Only blocks truly impossible combinations:\n * - timeDuration on process-level start events (can't be converted)\n *\n * @param {string} type - 'timeDate', 'timeCycle', or 'timeDuration'\n * @param {Element} element\n * @return {boolean}\n */\nfunction canTimerTypeBeAppliedWithConversion(type, element) {\n  const businessObject = getBusinessObject(element);\n\n  switch (type) {\n  case 'timeDate':\n    return isAny(element, [\n      'bpmn:BoundaryEvent',\n      'bpmn:IntermediateCatchEvent',\n      'bpmn:StartEvent'\n    ]);\n\n  case 'timeCycle':\n\n    if (isAny(element, [ 'bpmn:StartEvent', 'bpmn:BoundaryEvent' ])) {\n      return true;\n    }\n\n    return false;\n\n  case 'timeDuration':\n    if (isAny(element, [\n      'bpmn:BoundaryEvent',\n      'bpmn:IntermediateCatchEvent'\n    ])) {\n      return true;\n    }\n\n    // timeDuration can only be applied to start events in event subprocesses\n    // Process-level start events cannot support timeDuration (no conversion possible)\n    if (is(element, 'bpmn:StartEvent') && hasParentEventSubProcess(businessObject)) {\n      return true;\n    }\n\n    return false;\n\n  default:\n    return false;\n  }\n}\n\n// helpers //////////\n\nfunction isInterrupting(businessObject) {\n  if (is(businessObject, 'bpmn:BoundaryEvent')) {\n    return businessObject.get('cancelActivity') !== false;\n  }\n\n  return businessObject.get('isInterrupting') !== false;\n}\n\nfunction hasParentEventSubProcess(businessObject) {\n  const parent = businessObject.$parent;\n\n  return parent && is(parent, 'bpmn:SubProcess') && parent.get('triggeredByEvent');\n}\n","import {\n  isObject\n} from 'min-dash';\n\nimport {\n  getTemplateId,\n  getTemplateVersion\n} from './Helper';\n\nimport { default as DefaultElementTemplates } from '../element-templates/ElementTemplates';\n\nimport { isTimerTemplateApplicable } from './util/timerUtil';\n\n/**\n * @typedef {import('bpmn-js/lib/model/Types').Element} Element\n */\n\n/**\n * Filters to determine whether a template is applicable to a given element.\n * @type {Array<(template: ElementTemplate, element: Element) => boolean>}\n */\nconst TEMPLATE_FILTERS = [\n  isTimerTemplateApplicable\n];\n\n/**\n * Registry for element templates.\n */\nexport default class ElementTemplates extends DefaultElementTemplates {\n  constructor(templateElementFactory, commandStack, eventBus, modeling, injector, config) {\n    super(commandStack, eventBus, modeling, injector, config);\n\n    this._templateElementFactory = templateElementFactory;\n  }\n\n  _getTemplateId(element) {\n    return getTemplateId(element);\n  }\n\n  _getTemplateVersion(element) {\n    return getTemplateVersion(element);\n  }\n\n  /**\n   * Get all templates (with given ID or applicable to element).\n   *\n   * @param {string|djs.model.Base} [elementOrTemplateId]\n   * @return {Array<ElementTemplate>}\n   */\n  getAll(elementOrTemplateId) {\n    const templates = super.getAll(elementOrTemplateId);\n\n    if (isObject(elementOrTemplateId)) {\n      return this._filterApplicableTemplates(templates, elementOrTemplateId);\n    }\n\n    return templates;\n  }\n\n  /**\n   * Get all templates (with given ID or applicable to element) with the latest version.\n   *\n   * @param {String|djs.model.Base} [elementOrTemplateId]\n   * @param {{ deprecated?: boolean }} [options]\n   *\n   * @return {Array<ElementTemplate>}\n   */\n  getLatest(elementOrTemplateId, options = {}) {\n    const templates = super.getLatest(elementOrTemplateId, options);\n\n    if (isObject(elementOrTemplateId)) {\n      return this._filterApplicableTemplates(templates, elementOrTemplateId);\n    }\n\n    return templates;\n  }\n\n  /**\n   * Get compatible templates for element with optional engine overrides.\n   *\n   * @param {String|djs.model.Base} [elementOrTemplateId]\n   * @param {Object} [enginesOverrides]\n   * @param {Object} [options]\n   *\n   * @return {Array<ElementTemplate>}\n   */\n  getCompatible(elementOrTemplateId, enginesOverrides = {}, options = {}) {\n    const templates = super.getCompatible(elementOrTemplateId, enginesOverrides, options);\n\n    if (isObject(elementOrTemplateId)) {\n      return this._filterApplicableTemplates(templates, elementOrTemplateId);\n    }\n\n    return templates;\n  }\n\n  _filterApplicableTemplates(templates, element) {\n    return TEMPLATE_FILTERS.reduce(\n      (filteredTemplates, filterFn) =>\n        filteredTemplates.filter(template => filterFn(template, element)),\n      templates\n    );\n  }\n\n  /**\n   * Create an element based on an element template. This is, for example,\n   * called from the create-append anything menu.\n   *\n   * @param {ElementTemplate} template\n   * @returns {djs.model.Base}\n   */\n  createElement(template) {\n    if (!template) {\n      throw new Error('template is missing');\n    }\n\n    const element = this._templateElementFactory.create(template);\n\n    return element;\n  }\n\n  /**\n   * Apply element template to a given element.\n   *\n   * @param {Element} element\n   * @param {ElementTemplate} newTemplate\n   *\n   * @return {Element} the updated element\n   */\n  applyTemplate(element, newTemplate) {\n    const oldTemplate = this.get(element);\n\n    const context = {\n      element,\n      newTemplate,\n      oldTemplate\n    };\n\n    const event = oldTemplate?.id === newTemplate?.id ? 'update' : 'apply';\n\n    this._commandStack.execute('propertiesPanel.zeebe.changeTemplate', context);\n\n    this._fire(event, {\n      element,\n      newTemplate,\n      oldTemplate\n    });\n\n    return context.element;\n  }\n\n  /**\n   * Remove template from a given element.\n   *\n   * @param {Element} element\n   *\n   * @return {Element} the updated element\n   */\n  removeTemplate(element) {\n    const oldTemplate = this.get(element);\n\n    const context = {\n      element,\n      oldTemplate\n    };\n\n    this._commandStack.execute('propertiesPanel.removeTemplate', context);\n\n    this._fire('remove', {\n      element,\n      oldTemplate\n    });\n\n    return context.element;\n  }\n}\n\nElementTemplates.$inject = [\n  'templateElementFactory',\n  'commandStack',\n  'eventBus',\n  'modeling',\n  'injector',\n  'config.elementTemplates',\n];\n","import {\n  filter,\n  forEach,\n  isArray,\n  isString\n} from 'min-dash';\n\nimport semverCompare from 'semver-compare';\n\nimport {\n  validRange as isSemverRangeValid\n} from 'semver';\n\nimport {\n  validate as validateAgainstSchema,\n  getSchemaVersion as getTemplateSchemaVersion\n} from '@bpmn-io/element-templates-validator';\n\nconst SUPPORTED_SCHEMA_VERSION = getTemplateSchemaVersion();\nconst MORPHABLE_TYPES = [ 'bpmn:Activity', 'bpmn:Event', 'bpmn:Gateway' ];\n\n\n/**\n * A element template validator.\n */\nexport class Validator {\n  constructor(moddle) {\n    this._templatesById = {};\n\n    this._validTemplates = [];\n    this._errors = [];\n    this._moddle = moddle;\n  }\n\n  /**\n   * Adds the templates.\n   *\n   * @param {Array<TemplateDescriptor>} templates\n   *\n   * @return {Validator}\n   */\n  addAll(templates) {\n    if (!isArray(templates)) {\n      this._logError('templates must be []');\n    } else {\n      templates.forEach(this.add, this);\n    }\n\n    return this;\n  }\n\n  /**\n   * Add the given element template, if it is valid.\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Validator}\n   */\n  add(template) {\n    const err = this._validateTemplate(template);\n\n    let id, version;\n\n    if (!err) {\n      id = template.id;\n      version = template.version || '_';\n\n      if (!this._templatesById[ id ]) {\n        this._templatesById[ id ] = {};\n      }\n\n      this._templatesById[ id ][ version ] = template;\n\n      this._validTemplates.push(template);\n    }\n\n    return this;\n  }\n\n  /**\n   * Validate given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  _validateTemplate(template) {\n    const id = template.id,\n          version = template.version || '_',\n          schemaVersion = template.$schema && getSchemaVersion(template.$schema);\n\n    // (1) compatibility\n    if (schemaVersion && (semverCompare(SUPPORTED_SCHEMA_VERSION, schemaVersion) < 0)) {\n      return this._logError(\n        `unsupported element template schema version <${ schemaVersion }>. Your installation only supports up to version <${ SUPPORTED_SCHEMA_VERSION }>. Please update your installation`,\n        template\n      );\n    }\n\n    // (2) versioning\n    if (this._templatesById[ id ] && this._templatesById[ id ][ version ]) {\n      if (version === '_') {\n        return this._logError(`template id <${ id }> already used`, template);\n      } else {\n        return this._logError(`template id <${ id }> and version <${ version }> already used`, template);\n      }\n    }\n\n    // (3) elementType validation\n    const elementTypeError = this._validateElementType(template);\n\n    if (elementTypeError) {\n      return elementTypeError;\n    }\n\n    // (4) JSON schema compliance\n    const schemaValidationResult = validateAgainstSchema(template);\n\n    const {\n      errors: schemaErrors,\n      valid\n    } = schemaValidationResult;\n\n    if (!valid) {\n      filteredSchemaErrors(schemaErrors).forEach((error) => {\n        this._logError(error.message, template);\n      });\n\n      return new Error('invalid template');\n    }\n\n    // (5) engines validation\n    const enginesError = this._validateEngines(template);\n\n    if (enginesError) {\n      return enginesError;\n    }\n\n    return null;\n  }\n\n  _validateEngines(template) {\n\n    let err;\n\n    forEach(template.engines, (rangeStr, engine) => {\n\n      if (!isSemverRangeValid(rangeStr)) {\n        err = this._logError(new Error(\n          `Engine <${engine}> specifies invalid semver range <${rangeStr}>`\n        ), template);\n      }\n    });\n\n    return err;\n  }\n\n  /**\n   * Validate elementType for given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  _validateElementType(template) {\n    if (template.elementType && template.appliesTo) {\n\n      const elementType = template.elementType.value,\n            appliesTo = template.appliesTo;\n\n      // (3.1) template can be applied to elementType\n      // prevents cases where the elementType is not part of appliesTo\n      if (!appliesTo.find(type => this._isType(elementType, type))) {\n        return this._logError(`template does not apply to requested element type <${ elementType }>`, template);\n      }\n\n      // (3.2) template only applies to same type of element\n      // prevent elementTemplates to morph into incompatible types, e.g. Task -> SequenceFlow\n      for (const sourceType of appliesTo) {\n        if (!this._canMorph(sourceType, elementType)) {\n          return this._logError(`can not morph <${sourceType}> into <${elementType}>`, template);\n        }\n      }\n    }\n  }\n\n\n  /**\n   * Check if given type is a subtype of given base type.\n   *\n   * @param {String} type\n   * @param {String} baseType\n   * @returns {Boolean}\n   */\n  _isType(type, baseType) {\n    const moddleType = this._moddle.getType(type);\n\n    return moddleType && (baseType in this._moddle.getElementDescriptor(moddleType).allTypesByName);\n  }\n\n\n  /**\n   * Checks if a given type can be morphed into another type.\n   *\n   * @param {String} sourceType\n   * @param {String} targetType\n   * @returns {Boolean}\n   */\n  _canMorph(sourceType, targetType) {\n\n    if (sourceType === targetType) {\n      return true;\n    }\n\n    const baseType = MORPHABLE_TYPES.find(type => this._isType(sourceType, type));\n\n    if (!baseType) {\n      return false;\n    }\n\n    return this._isType(targetType, baseType);\n  }\n\n  /**\n   * Log an error for the given template\n   *\n   * @param {(String|Error)} err\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} logged validation errors\n   */\n  _logError(err, template) {\n    if (isString(err)) {\n\n      if (template) {\n        const {\n          id,\n          name\n        } = template;\n\n        err = `template(id: <${ id }>, name: <${ name }>): ${ err }`;\n      }\n\n      err = new Error(err);\n    }\n\n    this._errors.push(err);\n\n    return err;\n  }\n\n  getErrors() {\n    return this._errors;\n  }\n\n  getValidTemplates() {\n    return this._validTemplates;\n  }\n}\n\n\n// helpers //////////\n\n/**\n * Extract schema version from schema URI\n *\n * @param {String} schemaUri - for example https://unpkg.com/@camunda/element-templates-json-schema@99.99.99/resources/schema.json\n *\n * @return {String} for example '99.99.99'\n */\nexport function getSchemaVersion(schemaUri) {\n  const re = /\\d+\\.\\d+\\.\\d+/g;\n\n  const match = schemaUri.match(re);\n\n  return match === null ? undefined : match[ 0 ];\n}\n\n/**\n * Extract only relevant errors of the validation result.\n *\n * The JSON Schema we use under the hood produces more errors than we need for a\n * detected schema violation (for example, unmatched sub-schemas, if-then-rules,\n * `oneOf`-definitions ...).\n *\n * We call these errors \"relevant\" that have a custom error message defined by us OR\n * are basic data type errors.\n *\n * @param {Array} schemaErrors\n *\n * @return {Array}\n */\nexport function filteredSchemaErrors(schemaErrors) {\n  return filter(schemaErrors, (err) => {\n    const {\n      instancePath,\n      keyword\n    } = err;\n\n    // (1) regular errors are customized from the schema\n    if (keyword === 'errorMessage') {\n      return true;\n    }\n\n    // (2) data type errors\n    // ignore type errors nested in scopes\n    if (keyword === 'type' && instancePath && !instancePath.startsWith('/scopes/')) {\n      return true;\n    }\n\n    return false;\n  });\n}","import {\n  Validator as BaseValidator,\n  filteredSchemaErrors,\n  getSchemaVersion\n} from '../element-templates/Validator';\n\nimport semverCompare from 'semver-compare';\n\nimport {\n  validRange as isSemverRangeValid\n} from 'semver';\n\nimport {\n  validateZeebe as validateAgainstSchema,\n  getZeebeSchemaPackage as getTemplateSchemaPackage,\n  getZeebeSchemaVersion as getTemplateSchemaVersion\n} from '@bpmn-io/element-templates-validator';\nimport { forEach } from 'min-dash';\n\nconst SUPPORTED_SCHEMA_VERSION = getTemplateSchemaVersion();\nconst SUPPORTED_SCHEMA_PACKAGE = getTemplateSchemaPackage();\n\n/**\n * A Camunda Cloud element template validator.\n */\nexport class Validator extends BaseValidator {\n  constructor(moddle) {\n    super(moddle);\n  }\n\n  /**\n   * Validate given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  _validateTemplate(template) {\n    const id = template.id,\n          version = template.version || '_',\n          schema = template.$schema,\n          schemaVersion = schema && getSchemaVersion(schema);\n\n    // (1) $schema attribute defined\n    if (!schema) {\n      return this._logError(\n        'missing $schema attribute.',\n        template\n      );\n    }\n\n    if (!this.isSchemaValid(schema)) {\n      return this._logError(\n        `unsupported $schema attribute <${ schema }>.`,\n        template\n      );\n    }\n\n    // (2) compatibility\n    if (schemaVersion && (semverCompare(SUPPORTED_SCHEMA_VERSION, schemaVersion) < 0)) {\n      return this._logError(\n        `unsupported element template schema version <${ schemaVersion }>. Your installation only supports up to version <${ SUPPORTED_SCHEMA_VERSION }>. Please update your installation`,\n        template\n      );\n    }\n\n    // (3) versioning\n    if (this._templatesById[ id ] && this._templatesById[ id ][ version ]) {\n      if (version === '_') {\n        return this._logError(`template id <${ id }> already used`, template);\n      } else {\n        return this._logError(`template id <${ id }> and version <${ version }> already used`, template);\n      }\n    }\n\n    // (4) elementType validation\n    const elementTypeError = this._validateElementType(template);\n\n    if (elementTypeError) {\n      return elementTypeError;\n    }\n\n    // (5) JSON schema compliance\n    const schemaValidationResult = validateAgainstSchema(template);\n\n    const {\n      errors: schemaErrors,\n      valid\n    } = schemaValidationResult;\n\n    if (!valid) {\n      filteredSchemaErrors(schemaErrors).forEach((error) => {\n        this._logError(error.message, template);\n      });\n\n      return new Error('invalid template');\n    }\n\n    // (6) engines validation\n    const enginesError = this._validateEngines(template);\n\n    if (enginesError) {\n      return enginesError;\n    }\n\n    return null;\n  }\n\n  isSchemaValid(schema) {\n    return schema && schema.includes(SUPPORTED_SCHEMA_PACKAGE);\n  }\n\n  _validateEngines(template) {\n\n    let err;\n\n    forEach(template.engines, (rangeStr, engine) => {\n\n      if (!isSemverRangeValid(rangeStr)) {\n        err = this._logError(new Error(\n          `Engine <${engine}> specifies invalid semver range <${rangeStr}>`\n        ), template);\n      }\n    });\n\n    return err;\n  }\n}\n","import {\n  isFunction,\n  isUndefined,\n  isArray,\n} from 'min-dash';\n\nimport { Validator } from './Validator';\n\n/**\n * The guy responsible for template loading.\n *\n * Provide the actual templates via the `config.elementTemplates`.\n *\n * That configuration can either be an array of template\n * descriptors or a node style callback to retrieve\n * the templates asynchronously.\n *\n * @param {Array<TemplateDescriptor>|Function} config\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n * @param {Moddle} moddle\n */\nexport default class ElementTemplatesLoader {\n  constructor(config, eventBus, elementTemplates, moddle) {\n    this._loadTemplates;\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._moddle = moddle;\n\n    if (isArray(config) || isFunction(config)) {\n      this._loadTemplates = config;\n    }\n\n    if (config && config.loadTemplates) {\n      this._loadTemplates = config.loadTemplates;\n    }\n\n    eventBus.on('diagram.init', () => {\n      this.reload();\n    });\n  }\n\n  reload() {\n    const loadTemplates = this._loadTemplates;\n\n    // no templates specified\n    if (isUndefined(loadTemplates)) {\n      return;\n    }\n\n    // template loader function specified\n    if (isFunction(loadTemplates)) {\n\n      return loadTemplates((err, templates) => {\n\n        if (err) {\n          return this._templateErrors([ err ]);\n        }\n\n        this.setTemplates(templates);\n      });\n    }\n\n    // templates array specified\n    if (loadTemplates.length) {\n      return this.setTemplates(loadTemplates);\n    }\n  }\n\n  setTemplates(templates) {\n    const elementTemplates = this._elementTemplates,\n          moddle = this._moddle;\n\n    const validator = new Validator(moddle).addAll(templates);\n\n    const errors = validator.getErrors(),\n          validTemplates = validator.getValidTemplates();\n\n    elementTemplates.set(validTemplates);\n\n    if (errors.length) {\n      this._templateErrors(errors);\n    }\n  }\n\n  _templateErrors(errors) {\n    this._elementTemplates._fire('errors', {\n      errors: errors\n    });\n  }\n}\n\nElementTemplatesLoader.$inject = [\n  'config.elementTemplates',\n  'eventBus',\n  'elementTemplates',\n  'moddle'\n];","import { Validator } from './Validator';\n\nimport { default as TemplatesLoader } from '../element-templates/ElementTemplatesLoader';\n\n/**\n * @param {Object|Array<TemplateDescriptor>|Function} config\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n * @param {Moddle} moddle\n */\nexport default class ElementTemplatesLoader extends TemplatesLoader {\n  constructor(config, eventBus, elementTemplates, moddle) {\n\n    super(config, eventBus, elementTemplates, moddle);\n\n    this._elementTemplates = elementTemplates;\n  }\n\n  setTemplates(templates) {\n    const elementTemplates = this._elementTemplates,\n          moddle = this._moddle;\n\n    const validator = new Validator(moddle).addAll(templates);\n\n    const errors = validator.getErrors(),\n          validTemplates = validator.getValidTemplates();\n\n    elementTemplates.set(validTemplates);\n\n    if (errors.length) {\n      this._templateErrors(errors);\n    }\n  }\n}\n\nElementTemplatesLoader.$inject = [\n  'config.elementTemplates',\n  'eventBus',\n  'elementTemplates',\n  'moddle'\n];","import Ids from 'ids';\n\nimport {\n  is\n} from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * Create a new element and set its parent.\n *\n * @param {String} elementType of the new element\n * @param {Object} properties of the new element in key-value pairs\n * @param {moddle.object} parent of the new element\n * @param {BpmnFactory} factory which creates the new element\n *\n * @returns {djs.model.Base} element which is created\n */\nexport function createElement(elementType, properties, parent, factory) {\n  const element = factory.create(elementType, properties);\n\n  if (parent) {\n    element.$parent = parent;\n  }\n\n  return element;\n}\n\n/**\n * generate a semantic id with given prefix\n */\nexport function nextId(prefix) {\n  const ids = new Ids([ 32,32,1 ]);\n\n  return ids.nextPrefixed(prefix);\n}\n\nexport function getRoot(businessObject) {\n  let parent = businessObject;\n\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n\n  return parent;\n}\n\nexport function filterElementsByType(objectList, type) {\n  const list = objectList || [];\n\n  return list.filter(element => is(element, type));\n}\n\nexport function findRootElementsByType(businessObject, referencedType) {\n  const root = getRoot(businessObject);\n\n  return filterElementsByType(root.get('rootElements'), referencedType);\n}\n\nexport function findRootElementById(businessObject, type, id) {\n  const elements = findRootElementsByType(businessObject, type);\n\n  return elements.find(element => element.id === id);\n}\n\n/**\n * Check if element type is a subprocess (either regular or AdHoc).\n *\n * @param {string} elementType\n * @returns {boolean}\n */\nexport function isSubprocess(elementType) {\n  return elementType === 'bpmn:SubProcess' || elementType === 'bpmn:AdHocSubProcess' || elementType === 'bpmn:Transaction';\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { findExtension } from './Helper';\nimport { createElement } from '../utils/ElementUtil';\n\n\n/**\n * Create an input parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createInputParameter(binding, value, bpmnFactory) {\n  const {\n    name\n  } = binding;\n\n  return bpmnFactory.create('zeebe:Input', {\n    source: value,\n    target: name\n  });\n}\n\n/**\n * Create an output parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createOutputParameter(binding, value, bpmnFactory) {\n  const {\n    source\n  } = binding;\n\n  return bpmnFactory.create('zeebe:Output', {\n    source,\n    target: value\n  });\n}\n\n/**\n * Create a task header representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createTaskHeader(binding, value, bpmnFactory) {\n  const {\n    key\n  } = binding;\n\n  return bpmnFactory.create('zeebe:Header', {\n    key,\n    value\n  });\n}\n\n/**\n * Create a task definition representing the given value.\n *\n * @param {object} attrs\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createTaskDefinition(attrs = {}, bpmnFactory) {\n  return bpmnFactory.create('zeebe:TaskDefinition', attrs);\n}\n\n/**\n * Create zeebe:Property from the given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createZeebeProperty(binding, value = '', bpmnFactory) {\n  const { name } = binding;\n\n  return bpmnFactory.create('zeebe:Property', {\n    name,\n    value\n  });\n}\n\n/**\n * Retrieves whether an element should be updated for a given property.\n *\n * That matches once\n * a) the property value is not empty, or\n * b) the property is not optional\n *\n * @param {String} value\n * @param {Object} property\n * @returns {Boolean}\n */\nexport function shouldUpdate(value, property) {\n  const { optional } = property;\n\n  return value || !optional;\n}\n\n/**\n * Gets or, in case not existent, creates extension element for given element.\n *\n * @param {djs.model.Base} element\n * @param {String} type\n * @param {BpmnFactory} bpmnFactory\n * @returns {ModdleElement}\n */\nexport function ensureExtension(element, type, bpmnFactory) {\n  const businessObject = getBusinessObject(element);\n  let extensionElements = businessObject.get('extensionElements');\n\n  if (!extensionElements) {\n    extensionElements = createElement('bpmn:ExtensionElements', {}, businessObject, bpmnFactory);\n    businessObject.set('extensionElements', extensionElements);\n  }\n\n  let extension = findExtension(extensionElements, type);\n\n  if (!extension) {\n    extension = bpmnFactory.create(type);\n    extension.$parent = extensionElements;\n    extensionElements.get('values').push(extension);\n  }\n\n  return extension;\n}","import {\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE\n} from './bindingTypes';\n\nexport function getTaskDefinitionPropertyName(binding) {\n  return binding.type === ZEEBE_TASK_DEFINITION_TYPE_TYPE ? 'type' : binding.property;\n}\n","import {\n  getBusinessObject,\n  is\n} from 'bpmn-js/lib/util/ModelUtil';\nimport { findMessage, findSignal } from '../Helper';\n\nexport function removeRootElement(rootElement, injector) {\n  const modeling = injector.get('modeling'),\n        canvas = injector.get('canvas'),\n        bpmnjs = injector.get('bpmnjs');\n\n  const element = canvas.getRootElement(),\n        definitions = bpmnjs.getDefinitions(),\n        rootElements = definitions.get('rootElements');\n\n  const newRootElements = rootElements.filter(e => e !== rootElement);\n\n  // short-circuit to prevent unnecessary updates\n  if (newRootElements.length === rootElements.length) {\n    return;\n  }\n\n  modeling.updateModdleProperties(element, definitions, {\n    rootElements: newRootElements\n  });\n}\n\n/**\n * Remove message from element and the diagram.\n *\n * @param {import('bpmn-js/lib/model/Types').Element} element\n * @param {import('didi').Injector} injector\n */\nexport function removeMessage(element, injector) {\n  const modeling = injector.get('modeling');\n\n  const bo = getReferringElement(element);\n\n  // Event does not have an event definition\n  if (!bo) {\n    return;\n  }\n\n  const message = findMessage(bo);\n\n  if (!message) {\n    return;\n  }\n\n  modeling.updateModdleProperties(element, bo, {\n    messageRef: undefined\n  });\n  removeRootElement(message, injector);\n}\n\n/**\n * Remove signal from element and the diagram.\n *\n * @param {import('bpmn-js/lib/model/Types').Element} element\n * @param {import('didi').Injector} injector\n */\nexport function removeSignal(element, injector) {\n  const modeling = injector.get('modeling');\n\n  const bo = getReferringElement(element);\n\n  // Event does not have an event definition\n  if (!bo) {\n    return;\n  }\n\n  const signal = findSignal(bo);\n\n  if (!signal) {\n    return;\n  }\n\n  modeling.updateModdleProperties(element, bo, {\n    signalRef: undefined\n  });\n  removeRootElement(signal, injector);\n}\n\n\nexport function getReferringElement(element) {\n  const bo = getBusinessObject(element);\n\n  if (is(bo, 'bpmn:Event')) {\n    return bo.get('eventDefinitions')[0];\n  }\n\n  return bo;\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\nimport { createElement } from '../../utils/ElementUtil';\n\nconst EXPRESSION_TYPES = [\n  'bpmn:Expression',\n  'bpmn:FormalExpression'\n];\n\nexport function isExpression(element, propertyName) {\n  const bo = getBusinessObject(element);\n\n  const descriptor = bo.$descriptor.propertiesByName[propertyName];\n\n  return descriptor && EXPRESSION_TYPES.includes(descriptor.type);\n}\n\nexport function createExpression(value, parent, bpmnFactory) {\n  const expression = createElement('bpmn:FormalExpression', { body: value }, parent, bpmnFactory);\n\n  return expression;\n}\n\nexport function getExpressionValue(element, propertyName) {\n  const bo = getBusinessObject(element);\n  const expression = bo.get(propertyName);\n\n  return expression?.get('body') || undefined;\n}\n","import {\n  getBusinessObject,\n  is\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  findExtension,\n  findMessage,\n  findSignal,\n  findTimerEventDefinition,\n  getDefaultFixedValue,\n  getDefaultValue,\n  getTemplateVersion,\n  getTemplateId,\n  getTemplateIcon\n} from '../Helper';\n\nimport {\n  createInputParameter,\n  createOutputParameter,\n  createTaskHeader,\n  createZeebeProperty,\n  shouldUpdate\n} from '../CreateHelper';\n\nimport {\n  find,\n  without\n} from 'min-dash';\n\nimport {\n  MESSAGE_BINDING_TYPES,\n  MESSAGE_PROPERTY_TYPE,\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE,\n  SIGNAL_PROPERTY_TYPE,\n  TIMER_EVENT_DEFINITION_PROPERTY_TYPE,\n  TASK_DEFINITION_TYPES,\n  ZEEBE_CALLED_DECISION,\n  ZEEBE_CALLED_ELEMENT,\n  ZEEBE_LINKED_RESOURCE_PROPERTY,\n  ZEEBE_SCRIPT_TASK,\n  ZEEBE_USER_TASK,\n  ZEEBE_FORM_DEFINITION,\n  ZEEBE_ASSIGNMENT_DEFINITION,\n  ZEEBE_PRIORITY_DEFINITION,\n  ZEEBE_AD_HOC,\n  ZEEBE_TASK_SCHEDULE\n} from '../util/bindingTypes';\n\nimport {\n  getTaskDefinitionPropertyName\n} from '../util/taskDefinition';\n\nimport {\n  createElement,\n  getRoot\n} from '../../utils/ElementUtil';\nimport { removeMessage, removeSignal } from '../util/rootElementUtil';\nimport { isExpression, createExpression } from '../util/bpmnExpressionUtil';\n\n/**\n * @typedef {import('bpmn-js/lib/model/Types').Element} Element\n */\n\n/**\n * Applies an element template to an element. Sets `zeebe:modelerTemplate` and\n * `zeebe:modelerTemplateVersion`.\n */\nexport default class ChangeElementTemplateHandler {\n  constructor(bpmnFactory, bpmnReplace, commandStack, modeling, moddleCopy, injector) {\n    this._bpmnFactory = bpmnFactory;\n    this._bpmnReplace = bpmnReplace;\n\n    this._modeling = modeling;\n    this._moddleCopy = moddleCopy;\n    this._commandStack = commandStack;\n\n    this._injector = injector;\n  }\n\n  /**\n   * Change element template. If new template is specified, apply it. If old\n   * template is specified, too, update from old to new. If only old template is\n   * specified, remove it. Optionally, remove old template properties.\n   *\n   * @param {Object} context\n   * @param {Element} context.element\n   * @param {Object} [context.oldTemplate]\n   * @param {Object} [context.newTemplate]\n   * @param {boolean} [context.removeProperties=false]\n   */\n  preExecute(context) {\n    const {\n      newTemplate,\n      oldTemplate,\n      removeProperties = false\n    } = context;\n\n    let element = context.element;\n\n    // update zeebe:modelerTemplate attribute\n    this._updateZeebeModelerTemplate(element, newTemplate);\n\n    // update zeebe:modelerTemplateIcon\n    this._updateZeebeModelerTemplateIcon(element, newTemplate);\n\n    // update element type\n    element = context.element = this._updateElementType(element, oldTemplate, newTemplate);\n\n    if (!newTemplate && !removeProperties) {\n      return;\n    }\n\n    // update properties\n    this._updateProperties(element, oldTemplate, newTemplate);\n\n    // update zeebe:TaskDefinition\n    this._updateZeebeTaskDefinition(element, oldTemplate, newTemplate);\n\n    // update zeebe:Input and zeebe:Output properties\n    this._updateZeebeInputOutputParameterProperties(element, oldTemplate, newTemplate);\n\n    // update zeebe:Header properties\n    this._updateZeebeTaskHeaderProperties(element, oldTemplate, newTemplate);\n\n    // update zeebe:Property properties\n    this._updateZeebePropertyProperties(element, oldTemplate, newTemplate);\n\n    this._updateMessage(element, oldTemplate, newTemplate);\n\n    this._updateSignal(element, oldTemplate, newTemplate);\n\n    this._updateTimerEventDefinition(element, oldTemplate, newTemplate);\n\n    this._updateZeebeModelerTemplateOnReferencedElement(element, oldTemplate, newTemplate);\n\n    this._updateCalledElement(element, oldTemplate, newTemplate);\n\n    this._updateLinkedResources(element, oldTemplate, newTemplate);\n\n    this._updateZeebeUserTask(element, newTemplate);\n\n    this._updateCalledDecision(element, oldTemplate, newTemplate);\n\n    this._updateZeebeFormDefinition(element, oldTemplate, newTemplate);\n\n    this._updateScriptTask(element, oldTemplate, newTemplate);\n\n    this._updateZeebeAssignmentDefinition(element, oldTemplate, newTemplate);\n\n    this._updateZeebePriorityDefinition(element, oldTemplate, newTemplate);\n\n    this._updateAdHoc(element, oldTemplate, newTemplate);\n\n    this._updateZeebeTaskSchedule(element, oldTemplate, newTemplate);\n  }\n\n  _getOrCreateExtensionElements(element, businessObject = getBusinessObject(element)) {\n    const bpmnFactory = this._bpmnFactory,\n          modeling = this._modeling;\n\n    let extensionElements = businessObject.get('extensionElements');\n\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      extensionElements.$parent = businessObject;\n\n      modeling.updateModdleProperties(element, businessObject, {\n        extensionElements: extensionElements\n      });\n    }\n\n    return extensionElements;\n  }\n\n  /**\n   * Update zeebe:modelerTemplate property.\n   *\n   * @param {Element} element\n   * @param {Object} [newTemplate]\n   */\n  _updateZeebeModelerTemplate(element, newTemplate) {\n    const modeling = this._modeling;\n\n    if (!newTemplate) {\n      modeling.updateProperties(element, {\n        'zeebe:modelerTemplate': undefined,\n        'zeebe:modelerTemplateVersion': undefined\n      });\n\n      return;\n    }\n\n    const newId = newTemplate.id;\n    const newVersion = newTemplate.version;\n\n    if (getTemplateId(element) !== newId || getTemplateVersion(element) !== newVersion) {\n      modeling.updateProperties(element, {\n        'zeebe:modelerTemplate': newId,\n        'zeebe:modelerTemplateVersion': newVersion\n      });\n    }\n  }\n\n  /**\n   * Update zeebe:modelerTemplateIcon property.\n   *\n   * @param {Element} element\n   * @param {Object} [newTemplate]\n   */\n  _updateZeebeModelerTemplateIcon(element, newTemplate) {\n    const modeling = this._modeling;\n\n    if (!newTemplate) {\n      modeling.updateProperties(element, {\n        'zeebe:modelerTemplateIcon': undefined\n      });\n\n      return;\n    }\n\n    const newIcon = newTemplate.icon;\n    const newIconContents = newIcon && newIcon.contents;\n\n    if (getTemplateIcon(element) !== newIconContents) {\n      modeling.updateProperties(element, {\n        'zeebe:modelerTemplateIcon': newIconContents\n      });\n    }\n  }\n\n  /**\n   * Update BPMN properties.\n   *\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   *\n   * @returns {Element}\n   */\n  _updateProperties(element, oldTemplate, newTemplate) {\n    const commandStack = this._commandStack;\n    const businessObject = getBusinessObject(element);\n\n    let oldProperties = [],\n        newProperties = [];\n\n    if (oldTemplate) {\n      oldProperties = oldTemplate.properties.filter((oldProperty) => {\n        const oldBinding = oldProperty.binding,\n              oldBindingType = oldBinding.type;\n\n        return oldBindingType === 'property';\n      });\n    }\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === 'property';\n      });\n    }\n\n    // Remove old properties\n    const propertiesToRemove = oldProperties.filter((oldProperty) => {\n      return !newProperties.find((newProperty) => newProperty.binding.name === oldProperty.binding.name);\n    });\n\n    if (propertiesToRemove.length) {\n      const properties = propertiesToRemove.reduce((properties, property) => {\n        properties[property.binding.name] = undefined;\n\n        return properties;\n      }, {});\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties\n      });\n    }\n\n    if (!newProperties.length) {\n      return;\n    }\n\n    // Add new or update old properties\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = getDefaultValue(newProperty),\n            changedElement = businessObject;\n\n      const properties = {};\n\n      if (shouldKeepValue(changedElement, oldProperty, newProperty)) {\n        return;\n      }\n\n      let assignedValue = newPropertyValue;\n\n      if (isExpression(businessObject, newBindingName)) {\n        assignedValue = createExpression(newPropertyValue, businessObject, this._bpmnFactory);\n      }\n\n      properties[ newBindingName ] = assignedValue;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties\n      });\n    });\n  }\n\n  /**\n   * Update `zeebe:TaskDefinition` properties of specified business object. This\n   * can only exist in `bpmn:ExtensionElements`.\n   *\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   */\n  _updateZeebeTaskDefinition(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: TASK_DEFINITION_TYPES,\n        extensionType: 'zeebe:TaskDefinition',\n        getPropertyName: getTaskDefinitionPropertyName\n      }\n    );\n  }\n\n  /**\n   * Update `zeebe:Input` and `zeebe:Output` properties of specified business\n   * object. Both can only exist in `zeebe:ioMapping` which can exist in `bpmn:ExtensionElements`.\n   *\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   */\n  _updateZeebeInputOutputParameterProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    let newProperties = [];\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === 'zeebe:input' || newBindingType === 'zeebe:output';\n      });\n    }\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n\n    let ioMapping = findExtension(businessObject, 'zeebe:IoMapping');\n\n    // (1) remove old mappings if no new specified\n    if (!newProperties.length) {\n      if (!ioMapping) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), ioMapping)\n        }\n      });\n    }\n\n    if (!ioMapping) {\n      ioMapping = bpmnFactory.create('zeebe:IoMapping');\n\n      ioMapping.$parent = businessObject;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: [ ...businessObject.get('values'), ioMapping ]\n        }\n      });\n    }\n\n    const oldInputs = ioMapping.get('zeebe:inputParameters')\n      ? ioMapping.get('zeebe:inputParameters').slice()\n      : [];\n\n    const oldOutputs = ioMapping.get('zeebe:outputParameters')\n      ? ioMapping.get('zeebe:outputParameters').slice()\n      : [];\n\n    let propertyName;\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            inputOrOutput = findBusinessObject(businessObject, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      let newInputOrOutput,\n          properties;\n\n      // (2) update old inputs and outputs\n      if (inputOrOutput) {\n\n        // (2a) exclude old inputs and outputs from cleanup, unless\n        // a) optional and has empty value, and\n        // b) not changed\n        if (\n          shouldUpdate(newPropertyValue, newProperty) ||\n          shouldKeepValue(inputOrOutput, oldProperty, newProperty)\n        ) {\n          if (is(inputOrOutput, 'zeebe:Input')) {\n            remove(oldInputs, inputOrOutput);\n          } else {\n            remove(oldOutputs, inputOrOutput);\n          }\n        }\n\n        // (2a) do updates (unless changed)\n        if (!shouldKeepValue(inputOrOutput, oldProperty, newProperty)) {\n\n          if (is(inputOrOutput, 'zeebe:Input')) {\n            properties = {\n              source: newPropertyValue\n            };\n          } else {\n            properties = {\n              target: newPropertyValue\n            };\n          }\n\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: inputOrOutput,\n            properties\n          });\n        }\n      }\n\n      // (3) add new inputs and outputs (unless optional)\n      else if (shouldUpdate(newPropertyValue, newProperty)) {\n\n        if (newBindingType === 'zeebe:input') {\n          propertyName = 'inputParameters';\n\n          newInputOrOutput = createInputParameter(newBinding, newPropertyValue, bpmnFactory);\n        } else {\n          propertyName = 'outputParameters';\n\n          newInputOrOutput = createOutputParameter(newBinding, newPropertyValue, bpmnFactory);\n        }\n\n        newInputOrOutput.$parent = ioMapping;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: ioMapping,\n          properties: {\n            [ propertyName ]: [ ...ioMapping.get(propertyName), newInputOrOutput ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old inputs and outputs\n    if (oldInputs.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: ioMapping,\n        properties: {\n          inputParameters: without(ioMapping.get('inputParameters'), inputParameter => oldInputs.includes(inputParameter))\n        }\n      });\n    }\n\n    if (oldOutputs.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: ioMapping,\n        properties: {\n          outputParameters: without(ioMapping.get('outputParameters'), outputParameter => oldOutputs.includes(outputParameter))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `zeebe:Header` properties of specified business\n   * object. Those can only exist in `zeebe:taskHeaders` which can exist in `bpmn:ExtensionElements`.\n   *\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   */\n  _updateZeebeTaskHeaderProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    let newProperties = [];\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === 'zeebe:taskHeader';\n      });\n    }\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n\n    let taskHeaders = findExtension(businessObject, 'zeebe:TaskHeaders');\n\n    // (1) remove old headers if no new specified\n    if (!newProperties.length) {\n      if (!taskHeaders) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), taskHeaders)\n        }\n      });\n    }\n\n    if (!taskHeaders) {\n      taskHeaders = bpmnFactory.create('zeebe:TaskHeaders');\n\n      taskHeaders.$parent = businessObject;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: [ ...businessObject.get('values'), taskHeaders ]\n        }\n      });\n    }\n\n    const oldHeaders = taskHeaders.get('zeebe:values')\n      ? taskHeaders.get('zeebe:values').slice()\n      : [];\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldHeader = findBusinessObject(businessObject, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            newBinding = newProperty.binding;\n\n      // (2) update old headers\n      if (oldHeader) {\n\n        if (!shouldKeepValue(oldHeader, oldProperty, newProperty)) {\n          const properties = {\n            value: newPropertyValue\n          };\n\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldHeader,\n            properties\n          });\n        }\n\n        remove(oldHeaders, oldHeader);\n      }\n\n      // (3) add new (non-empty) headers\n      else if (newPropertyValue) {\n        const newHeader = createTaskHeader(newBinding, newPropertyValue, bpmnFactory);\n\n        newHeader.$parent = taskHeaders;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: taskHeaders,\n          properties: {\n            values: [ ...taskHeaders.get('values'), newHeader ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old headers\n    if (oldHeaders.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: taskHeaders,\n        properties: {\n          values: without(taskHeaders.get('values'), header => oldHeaders.includes(header))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update zeebe:Property properties of zeebe:Properties extension element.\n   *\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   */\n  _updateZeebePropertyProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    let newProperties = [];\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === 'zeebe:property';\n      });\n    }\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n\n    let zeebeProperties = findExtension(businessObject, 'zeebe:Properties');\n\n    // (1) remove old zeebe:Properties if no new zeebe:Property properties\n    if (!newProperties.length) {\n      if (!zeebeProperties) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), zeebeProperties)\n        }\n      });\n    }\n\n    if (!zeebeProperties) {\n      zeebeProperties = bpmnFactory.create('zeebe:Properties');\n\n      zeebeProperties.$parent = businessObject;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: [ ...businessObject.get('values'), zeebeProperties ]\n        }\n      });\n    }\n\n    const oldZeebeProperties = zeebeProperties.get('properties')\n      ? zeebeProperties.get('properties').slice()\n      : [];\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldZeebeProperty = findBusinessObject(businessObject, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            newBinding = newProperty.binding;\n\n      // (2) update old zeebe:Property\n      if (oldZeebeProperty) {\n        if (shouldUpdate(newPropertyValue, newProperty)\n          || shouldKeepValue(oldZeebeProperty, oldProperty, newProperty)) {\n          remove(oldZeebeProperties, oldZeebeProperty);\n        }\n\n        if (!shouldKeepValue(oldZeebeProperty, oldProperty, newProperty)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldZeebeProperty,\n            properties: {\n              value: newPropertyValue\n            }\n          });\n        }\n      }\n\n      // (3) add new zeebe:Property\n      else if (shouldUpdate(newPropertyValue, newProperty)) {\n        const newProperty = createZeebeProperty(newBinding, newPropertyValue, bpmnFactory);\n\n        newProperty.$parent = zeebeProperties;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: zeebeProperties,\n          properties: {\n            properties: [ ...zeebeProperties.get('properties'), newProperty ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old zeebe:Property\n    if (oldZeebeProperties.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: zeebeProperties,\n        properties: {\n          properties: without(zeebeProperties.get('properties'), zeebeProperty => oldZeebeProperties.includes(zeebeProperty))\n        }\n      });\n    }\n  }\n\n  _updateMessage(element, oldTemplate, newTemplate) {\n\n    // update bpmn:Message properties\n    this._updateMessageProperties(element, oldTemplate, newTemplate);\n\n    // update bpmn:Message zeebe:subscription properties\n    this._updateMessageZeebeSubscriptionProperties(element, oldTemplate, newTemplate);\n\n    if (!newTemplate || !hasMessageProperties(newTemplate)) {\n      removeMessage(element, this._injector);\n    }\n  }\n\n  _updateSignal(element, oldTemplate, newTemplate) {\n\n    // update bpmn:Signal properties\n    this._updateSignalProperties(element, oldTemplate, newTemplate);\n\n    if (!newTemplate || !hasSignalProperties(newTemplate)) {\n      removeSignal(element, this._injector);\n    }\n  }\n\n  /**\n   * Update bpmn:Message properties.\n   *\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   */\n  _updateMessageProperties(element, oldTemplate, newTemplate) {\n    let oldProperties = [],\n        newProperties = [];\n\n    if (oldTemplate) {\n      oldProperties = oldTemplate.properties.filter((oldProperty) => {\n        const oldBinding = oldProperty.binding,\n              oldBindingType = oldBinding.type;\n\n        return oldBindingType === MESSAGE_PROPERTY_TYPE;\n      });\n    }\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === MESSAGE_PROPERTY_TYPE;\n      });\n    }\n\n    const removedProperties = oldProperties.filter((oldProperty) => {\n      return !newProperties.find((newProperty) => newProperty.binding.name === oldProperty.binding.name);\n    });\n\n    let message = this._getMessage(element);\n\n    message && removedProperties.forEach((removedProperty) => {\n\n      this._modeling.updateModdleProperties(element, message, {\n        [removedProperty.binding.name]: undefined\n      });\n    });\n\n    if (!newProperties.length) {\n      return;\n    }\n\n    message = this._ensureMessage(element, newTemplate);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = getDefaultValue(newProperty),\n            changedElement = message;\n\n      let properties = {};\n\n      if (shouldKeepValue(changedElement, oldProperty, newProperty)) {\n        return;\n      }\n\n      properties[ newBindingName ] = newPropertyValue;\n\n      this._modeling.updateModdleProperties(element, changedElement, properties);\n    });\n  }\n\n  /**\n   * Update bpmn:Signal properties.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateSignalProperties(element, oldTemplate, newTemplate) {\n    let oldProperties = [],\n        newProperties = [];\n\n    if (oldTemplate) {\n      oldProperties = oldTemplate.properties.filter((oldProperty) => {\n        const oldBinding = oldProperty.binding,\n              oldBindingType = oldBinding.type;\n\n        return oldBindingType === SIGNAL_PROPERTY_TYPE;\n      });\n    }\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === SIGNAL_PROPERTY_TYPE;\n      });\n    }\n\n    const removedProperties = oldProperties.filter((oldProperty) => {\n      return !newProperties.find((newProperty) => newProperty.binding.name === oldProperty.binding.name);\n    });\n\n    let signal = this._getSignal(element);\n\n    signal && removedProperties.forEach((removedProperty) => {\n\n      this._modeling.updateModdleProperties(element, signal, {\n        [removedProperty.binding.name]: undefined\n      });\n    });\n\n    if (!newProperties.length) {\n      return;\n    }\n\n    // The template schema guarantees that if signal#property is active\n    signal = this._ensureSignal(element, newTemplate);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = getDefaultValue(newProperty),\n            changedElement = signal;\n\n      let properties = {};\n\n      if (shouldKeepValue(changedElement, oldProperty, newProperty)) {\n        return;\n      }\n\n      properties[ newBindingName ] = newPropertyValue;\n\n      this._modeling.updateModdleProperties(element, changedElement, properties);\n    });\n  }\n\n  /**\n   * Update bpmn:TimerEventDefinition properties.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateTimerEventDefinition(element, oldTemplate, newTemplate) {\n    const commandStack = this._commandStack;\n\n    let oldProperties = [],\n        newProperties = [];\n\n    if (oldTemplate) {\n      oldProperties = oldTemplate.properties.filter((oldProperty) => {\n        const oldBinding = oldProperty.binding,\n              oldBindingType = oldBinding.type;\n\n        return oldBindingType === TIMER_EVENT_DEFINITION_PROPERTY_TYPE;\n      });\n    }\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === TIMER_EVENT_DEFINITION_PROPERTY_TYPE;\n      });\n    }\n\n    const removedProperties = oldProperties.filter((oldProperty) => {\n      return !newProperties.find((newProperty) => newProperty.binding.name === oldProperty.binding.name);\n    });\n\n    const timerEventDefinition = findTimerEventDefinition(element);\n\n    if (!timerEventDefinition) {\n      return;\n    }\n\n    // Remove old timer properties that are no longer in the template\n    removedProperties.forEach((removedProperty) => {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: timerEventDefinition,\n        properties: {\n          [removedProperty.binding.name]: undefined\n        }\n      });\n    });\n\n    if (!newProperties.length) {\n      return;\n    }\n\n    // First, check if we need to auto-convert to non-interrupting for timeCycle\n    // This must happen BEFORE setting the timer property, otherwise the\n    // CleanUpTimerExpressionBehavior will remove it\n    const hasTimeCycle = newProperties.some(p => p.binding.name === 'timeCycle');\n    if (hasTimeCycle) {\n      this._ensureNonInterruptingForTimeCycle(element);\n    }\n\n    // Set new timer properties\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = getDefaultValue(newProperty);\n\n      // Check if we should keep the existing value\n      if (shouldKeepValue(timerEventDefinition, oldProperty, newProperty)) {\n        return;\n      }\n\n      // Create or update the FormalExpression\n      let expression = timerEventDefinition.get(newBindingName);\n\n      if (!expression) {\n        expression = createExpression(newPropertyValue, timerEventDefinition, this._bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: timerEventDefinition,\n          properties: {\n\n            // remove any existing timer values, satisfying that there is only one\n            timeDate: undefined,\n            timeDuration: undefined,\n            timeCycle: undefined,\n            [newBindingName]: expression\n          }\n        });\n      } else {\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: expression,\n          properties: {\n            body: newPropertyValue\n          }\n        });\n      }\n    });\n  }\n\n  /**\n   * Ensure element is non-interrupting when using timeCycle.\n   * - Boundary events: set cancelActivity to false\n   * - Event subprocess start events: set isInterrupting to false\n   *\n   * @param {djs.model.Base} element\n   */\n  _ensureNonInterruptingForTimeCycle(element) {\n    const commandStack = this._commandStack;\n    const businessObject = getBusinessObject(element);\n\n    // Boundary events with timeCycle must be non-interrupting\n    if (is(element, 'bpmn:BoundaryEvent')) {\n      if (businessObject.get('cancelActivity') !== false) {\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            cancelActivity: false\n          }\n        });\n      }\n      return;\n    }\n\n    // Start events in event subprocess with timeCycle must be non-interrupting\n    if (is(element, 'bpmn:StartEvent')) {\n      const parent = businessObject.$parent;\n      if (is(parent, 'bpmn:SubProcess') && parent.get('triggeredByEvent')) {\n        if (businessObject.get('isInterrupting') !== false) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: businessObject,\n            properties: {\n              isInterrupting: false\n            }\n          });\n        }\n      }\n    }\n  }\n\n  /**\n   * Update bpmn:Message#zeebe:subscription properties.\n   *\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   */\n  _updateMessageZeebeSubscriptionProperties(element, oldTemplate, newTemplate) {\n    let oldProperties = [],\n        newProperties = [];\n\n    if (oldTemplate) {\n      oldProperties = oldTemplate.properties.filter((oldProperty) => {\n        const oldBinding = oldProperty.binding,\n              oldBindingType = oldBinding.type;\n\n        return oldBindingType === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE;\n      });\n    }\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE;\n      });\n    }\n\n    const removedProperties = oldProperties.filter((oldProperty) => {\n      return !newProperties.find((newProperty) => newProperty.binding.name === oldProperty.binding.name);\n    });\n\n    if (!newProperties.length && !removedProperties.length) {\n      return;\n    }\n\n    let message = this._getMessage(element);\n\n    if (!newProperties.length && !message) {\n      return;\n    }\n\n    message = this._ensureMessage(element, newTemplate);\n\n    const messageExtensionElements = this._getOrCreateExtensionElements(element, message);\n    const zeebeSubscription = this._getSubscription(element, message);\n\n    const propertiesToSet = newProperties.reduce((properties, newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = getDefaultValue(newProperty),\n            changedElement = zeebeSubscription;\n\n      if (shouldKeepValue(changedElement, oldProperty, newProperty)) {\n        return properties;\n      }\n\n      properties[ newBindingName ] = newPropertyValue;\n      return properties;\n    }, {});\n\n    // Update zeebe Subscription\n    if (zeebeSubscription) {\n      this._modeling.updateModdleProperties(element, zeebeSubscription,\n        propertiesToSet\n      );\n    } else {\n\n      // create new Subscription\n      const newSubscription = createElement('zeebe:Subscription', propertiesToSet, message, this._bpmnFactory);\n      this._modeling.updateModdleProperties(element, messageExtensionElements, {\n        values: [ ...messageExtensionElements.get('values'), newSubscription ]\n      });\n    }\n\n    // Remove old properties\n    if (!oldTemplate || !zeebeSubscription) {\n      return;\n    }\n\n    const propertiesToRemove = removedProperties.reduce((properties, removedProperty) => {\n      properties[ removedProperty.binding.name ] = undefined;\n      return properties;\n    }, {});\n\n    this._modeling.updateModdleProperties(element, zeebeSubscription,\n      propertiesToRemove\n    );\n  }\n\n  _updateZeebeModelerTemplateOnReferencedElement(element, oldTemplate, newTemplate) {\n    const businessObject = getBusinessObject(element);\n\n    const referencedElement = findMessage(businessObject) || findSignal(businessObject);\n\n    if (referencedElement && newTemplate && getTemplateId(referencedElement) !== newTemplate.id) {\n      this._modeling.updateModdleProperties(element, referencedElement, {\n        'zeebe:modelerTemplate': newTemplate.id\n      });\n    }\n  }\n\n  _getSubscription(element, bo) {\n    const extensionElements = this._getOrCreateExtensionElements(element, bo);\n\n    const extension = findExtension(extensionElements, 'zeebe:Subscription');\n\n    if (extension) {\n      return extension;\n    }\n  }\n\n  _createMessage(element, template) {\n    let bo = getBusinessObject(element);\n\n    if (is(bo, 'bpmn:Event')) {\n      bo = bo.get('eventDefinitions')[0];\n    }\n\n    const message = this._bpmnFactory.create('bpmn:Message', { 'zeebe:modelerTemplate': template.id });\n\n    message.$parent = getRoot(bo);\n\n    this._modeling.updateModdleProperties(element, bo, { messageRef: message });\n\n    return message;\n  }\n\n  _createSignal(element, template) {\n    let bo = getBusinessObject(element);\n\n    if (is(bo, 'bpmn:Event')) {\n      bo = bo.get('eventDefinitions')[0];\n    }\n\n    const signal = this._bpmnFactory.create('bpmn:Signal', { 'zeebe:modelerTemplate': template.id });\n\n    signal.$parent = getRoot(bo);\n\n    this._modeling.updateModdleProperties(element, bo, { signalRef: signal });\n\n    return signal;\n  }\n\n  _getMessage(element) {\n    let bo = getBusinessObject(element);\n\n    if (is(bo, 'bpmn:Event')) {\n      bo = bo.get('eventDefinitions')[0];\n    }\n\n    return bo && bo.get('messageRef');\n  }\n\n  _getSignal(element) {\n    let bo = getBusinessObject(element);\n\n    if (!is(bo, 'bpmn:Event')) {\n      return;\n    }\n\n    const eventDefinition = bo.get('eventDefinitions')[0];\n\n    return eventDefinition && eventDefinition.get('signalRef');\n  }\n\n  _ensureMessage(element, newTemplate) {\n    const message = this._getMessage(element);\n\n    if (!newTemplate) {\n      return message;\n    }\n\n    // message is already templated, so we use it\n    if (message && message.get('zeebe:modelerTemplate')) {\n      return message;\n    }\n\n    const newMessage = this._createMessage(element, newTemplate);\n\n    // no message is set on the element, so no properties to copy\n    if (!message) {\n      return newMessage;\n    }\n\n    return this._moddleCopy.copyElement(message, newMessage, [ 'name', 'extensionElements' ]);\n  }\n\n  _ensureSignal(element, newTemplate) {\n    const signal = this._getSignal(element);\n\n    if (!newTemplate) {\n      return signal;\n    }\n\n    // signal is already templated, so we use it\n    if (signal && signal.get('zeebe:modelerTemplate')) {\n      return signal;\n    }\n\n    const newSignal = this._createSignal(element, newTemplate);\n\n    // no signal is set on the element, so no properties to copy\n    if (!signal) {\n      return newSignal;\n    }\n\n    return this._moddleCopy.copyElement(signal, newSignal, [ 'name' ]);\n  }\n\n\n  /**\n   * Update `zeebe:CalledElement` properties of specified business object. This\n   * can only exist in `bpmn:ExtensionElements`.\n   *\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   */\n  _updateCalledElement(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: [ ZEEBE_CALLED_ELEMENT ],\n        extensionType: 'zeebe:CalledElement',\n        getPropertyName: (binding) => binding.property\n      }\n    );\n  }\n\n  /**\n   * Update `zeebe:CalledDecision` properties of specified business object. This\n   * can only exist in `bpmn:ExtensionElements`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateCalledDecision(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: [ ZEEBE_CALLED_DECISION ],\n        extensionType: 'zeebe:CalledDecision',\n        getPropertyName: (binding) => binding.property\n      }\n    );\n  }\n\n  /**\n   * Update `zeebe:Script` properties of specified business object. This\n   * can only exist in `bpmn:ExtensionElements`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateScriptTask(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: [ ZEEBE_SCRIPT_TASK ],\n        extensionType: 'zeebe:Script',\n        getPropertyName: (binding) => binding.property\n      }\n    );\n  }\n\n  _updateZeebeAssignmentDefinition(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: [ ZEEBE_ASSIGNMENT_DEFINITION ],\n        extensionType: 'zeebe:AssignmentDefinition',\n        getPropertyName: (binding) => binding.property\n      }\n    );\n  }\n\n  _updateZeebePriorityDefinition(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: [ ZEEBE_PRIORITY_DEFINITION ],\n        extensionType: 'zeebe:PriorityDefinition',\n        getPropertyName: (binding) => binding.property\n      }\n    );\n  }\n\n  _updateAdHoc(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: [ ZEEBE_AD_HOC ],\n        extensionType: 'zeebe:AdHoc',\n        getPropertyName: (binding) => binding.property\n      }\n    );\n  }\n\n\n  _updateZeebeTaskSchedule(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: [ ZEEBE_TASK_SCHEDULE ],\n        extensionType: 'zeebe:TaskSchedule',\n        getPropertyName: (binding) => binding.property\n      }\n    );\n  }\n\n  /**\n   * Replaces the element with the specified elementType.\n   * Takes into account the eventDefinition for events.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   */\n  _updateElementType(element, oldTemplate, newTemplate) {\n    if (!newTemplate) {\n      return element;\n    }\n\n    // determine new task type\n    const newType = newTemplate.elementType;\n\n    if (!newType) {\n      return element;\n    }\n\n    // Do not replace if the element type did not change\n    if (!shouldUpdateElementType(element, oldTemplate, newType)) {\n      return element;\n    }\n\n    const replacement = { type: newType.value };\n\n    if (newType.eventDefinition) {\n      replacement.eventDefinitionType = newType.eventDefinition;\n    }\n\n    const replacedElement = this._bpmnReplace.replaceElement(element, replacement);\n\n    return replacedElement;\n  }\n\n\n  _updateLinkedResources(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    let oldProperties = [],\n        newProperties = [];\n\n    if (oldTemplate) {\n      oldProperties = oldTemplate.properties.filter((oldProperty) => {\n        const oldBinding = oldProperty.binding,\n              oldBindingType = oldBinding.type;\n\n        return oldBindingType === ZEEBE_LINKED_RESOURCE_PROPERTY;\n      });\n    }\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return newBindingType === ZEEBE_LINKED_RESOURCE_PROPERTY;\n      });\n    }\n\n    const extensionElements = this._getOrCreateExtensionElements(element);\n\n    let linkedResources = findExtension(extensionElements, 'zeebe:LinkedResources');\n\n    // (1) remove properties if no new specified\n    if (!newProperties.length) {\n      if (!linkedResources) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: without(extensionElements.get('values'), linkedResources)\n        }\n      });\n      return;\n    }\n\n    if (!linkedResources) {\n      linkedResources = bpmnFactory.create('zeebe:LinkedResources');\n\n      linkedResources.$parent = extensionElements;\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: [ ...extensionElements.get('values'), linkedResources ]\n        }\n      });\n    }\n\n    const unusedLinkedResources = linkedResources.get('values').slice();\n    const propertiesToRemove = oldProperties.slice();\n\n    newProperties.forEach((newLinkedResource) => {\n      const oldProperty = findOldProperty(oldTemplate, newLinkedResource),\n            oldLinkedResource = findBusinessObject(extensionElements, newLinkedResource),\n            newPropertyValue = getDefaultValue(newLinkedResource),\n            newBinding = newLinkedResource.binding;\n\n      if (oldProperty) {\n        remove(propertiesToRemove, oldProperty);\n      }\n\n      // (2) update old LinkedResources\n      if (oldLinkedResource) {\n        if (\n          shouldUpdate(newPropertyValue, newLinkedResource)\n          || shouldKeepValue(oldLinkedResource, oldProperty, newLinkedResource)\n        ) {\n          remove(unusedLinkedResources, oldLinkedResource);\n        }\n\n        if (!shouldKeepValue(oldLinkedResource, oldProperty, newLinkedResource)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldLinkedResource,\n            properties: {\n              [newBinding.property]: newPropertyValue\n            }\n          });\n        }\n      }\n\n      // (3) add new linkedResources\n      else if (shouldUpdate(newPropertyValue, newLinkedResource)) {\n        const newProperties = {\n          linkName: newBinding.linkName,\n          [newBinding.property]: newPropertyValue\n        };\n\n        const newLinkedResource = createElement('zeebe:LinkedResource', newProperties, extensionElements, bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: linkedResources,\n          properties: {\n            values: [ ...linkedResources.get('values'), newLinkedResource ]\n          }\n        });\n      }\n    });\n\n\n    // (4) remove unused linkedResources\n    if (unusedLinkedResources.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: linkedResources,\n        properties: {\n          values: without(linkedResources.get('values'), linkedResource => unusedLinkedResources.includes(linkedResource))\n        }\n      });\n    }\n\n    // (5) remove unused resource properties\n    propertiesToRemove.forEach((unusedResourceProperty) => {\n      const oldLinkedResource = findBusinessObject(extensionElements, unusedResourceProperty);\n\n      const oldBinding = unusedResourceProperty.binding;\n\n      // No property was reused and element was removed in previous step\n      if (!oldLinkedResource) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: oldLinkedResource,\n        properties: {\n          [oldBinding.property]: undefined\n        }\n      });\n    });\n  }\n\n  _updateZeebeUserTask = function(element, newTemplate) {\n\n    const commandStack = this._commandStack;\n    const bpmnFactory = this._bpmnFactory;\n\n    // check if template has zeebe:userTask binding property\n    const hasBinding = newTemplate?.properties.some((property) =>\n      property.binding.type === ZEEBE_USER_TASK);\n\n    // check if element has zeebe:UserTask extension element\n    const extensionElements = getBusinessObject(element).get('extensionElements');\n    const userTaskExtension = findExtension(element, 'zeebe:UserTask');\n\n    if (newTemplate && newTemplate.elementType?.value !== 'bpmn:UserTask') {\n      return;\n    }\n\n    // remove zeebe:UserTask if no binding\n    if (userTaskExtension) {\n\n      !hasBinding && commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: without(extensionElements.get('values'), userTaskExtension)\n        }\n      });\n\n      return;\n    }\n\n    if (!hasBinding) {\n      return;\n    }\n\n    // create new zeebe:UserTask extension element\n    const zeebeUserTask = bpmnFactory.create('zeebe:UserTask');\n    zeebeUserTask.$parent = extensionElements;\n\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: extensionElements,\n      properties: {\n        values: [ ...extensionElements.get('values'), zeebeUserTask ]\n      }\n    });\n  };\n\n  /**\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateZeebeFormDefinition = function(element, oldTemplate, newTemplate) {\n    this._updateSingleExtensionElement(\n      element,\n      oldTemplate,\n      newTemplate,\n      {\n        bindingTypes: [ ZEEBE_FORM_DEFINITION ],\n        extensionType: 'zeebe:FormDefinition',\n        getPropertyName: (binding) => binding.property\n      }\n    );\n  };\n\n  /**\n   * Generic handler for updating extension elements that are single instances with properties.\n   *\n   * @example\n   * For this template\n   * ```json\n   * {\n   *   properties: [\n   *    { binding: { type: 'zeebe:taskDefinition', property: 'type' }, value: 'myTaskType' },\n   *    {binding: { type: 'zeebe:taskDefinition', property: 'retries' }, value: 3}\n   *   ]\n   * }\n   *```\n   * `getPropertyName` should return `binding.property`.\n   *\n   * `bindingTypes` should be an array of binding types to consider, e.g. `['zeebe:taskDefinition']`.\n   *\n   * `extensionType` should be the type of the extension element to update, e.g. `'zeebe:TaskDefinition'`.\n   *\n   * The resulting XML will look like this:\n   *\n   * ```xml\n   * <bpmn:extensionElements>\n   *   <zeebe:taskDefinition type=\"myTaskType\" retries=\"3\" />\n   * </bpmn:extensionElements>\n   *```\n   * @param {Element} element\n   * @param {Object} [oldTemplate]\n   * @param {Object} [newTemplate]\n   * @param {Object} options\n   * @param {Array<string>} options.bindingTypes - binding types to consider\n   * @param {string} options.extensionType - type of the extension element to update\n   * @param {(binding: Object) => string} options.getPropertyName - function to get the property name for the binding\n   */\n  _updateSingleExtensionElement(element, oldTemplate, newTemplate, options) {\n    const { bindingTypes, extensionType, getPropertyName } = options;\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    let newProperties = [];\n\n    if (newTemplate) {\n      newProperties = newTemplate.properties.filter((newProperty) => {\n        const newBinding = newProperty.binding,\n              newBindingType = newBinding.type;\n\n        return bindingTypes.includes(newBindingType);\n      });\n    }\n\n    const businessObject = this._getOrCreateExtensionElements(element);\n    let extensionElement = findExtension(businessObject, extensionType);\n\n    // (1) Remove extension if no new properties\n\n    if (!newProperties.length) {\n      if (!extensionElement) {\n        return;\n      }\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: without(businessObject.get('values'), extensionElement)\n        }\n      });\n\n      return;\n    }\n\n    // If there are new properties:\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newPropertyValue = getDefaultValue(newProperty),\n            newBinding = newProperty.binding,\n            propertyName = getPropertyName(newBinding);\n\n      // (2) Update old extension with new property values\n      if (extensionElement) {\n\n        if (!shouldKeepValue(extensionElement, oldProperty, newProperty)) {\n          const properties = {\n            [propertyName]: newPropertyValue\n          };\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: extensionElement,\n            properties\n          });\n        }\n      }\n\n      // (3) Add new extension with properties if it does not exist\n      else {\n        const properties = {\n          [propertyName]: newPropertyValue\n        };\n\n        extensionElement = bpmnFactory.create(extensionType, properties);\n\n        extensionElement.$parent = businessObject;\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            values: [ ...businessObject.get('values'), extensionElement ]\n          }\n        });\n      }\n    });\n\n    // (4) Remove properties no longer templated\n    const oldProperties = oldTemplate && oldTemplate.properties.filter((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type,\n            oldPropertyName = getPropertyName(oldBinding);\n\n      return bindingTypes.includes(oldBindingType) &&\n        !newProperties.find((newProperty) => oldPropertyName === getPropertyName(newProperty.binding));\n    }) || [];\n\n    oldProperties.forEach((oldProperty) => {\n      const properties = {\n        [ getPropertyName(oldProperty.binding) ]: undefined\n      };\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElement,\n        properties\n      });\n    });\n  }\n}\n\nChangeElementTemplateHandler.$inject = [\n  'bpmnFactory',\n  'bpmnReplace',\n  'commandStack',\n  'modeling',\n  'moddleCopy',\n  'injector'\n];\n\n\n// helpers //////////\n\n/**\n * Find business object matching specified property.\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} property\n *\n * @returns {ModdleElement}\n */\nfunction findBusinessObject(element, property) {\n  const businessObject = getBusinessObject(element);\n\n  const binding = property.binding,\n        bindingType = binding.type;\n\n  if (TASK_DEFINITION_TYPES.includes(bindingType)) {\n    return findExtension(businessObject, 'zeebe:TaskDefinition');\n  }\n\n  if (bindingType === 'zeebe:input' || bindingType === 'zeebe:output') {\n\n    const extensionElements = findExtension(businessObject, 'zeebe:IoMapping');\n\n    if (!extensionElements) {\n      return;\n    }\n\n    if (bindingType === 'zeebe:input') {\n      return find(extensionElements.get('zeebe:inputParameters'), function(input) {\n        return input.get('zeebe:target') === binding.name;\n      });\n    } else {\n      return find(extensionElements.get('zeebe:outputParameters'), function(output) {\n        return output.get('zeebe:source') === binding.source;\n      });\n    }\n\n  }\n\n  if (bindingType === 'zeebe:taskHeader') {\n    const extensionElements = findExtension(businessObject, 'zeebe:TaskHeaders');\n\n    if (!extensionElements) {\n      return;\n    }\n\n    return find(extensionElements.get('zeebe:values'), function(value) {\n      return value.get('zeebe:key') === binding.key;\n    });\n  }\n\n  if (bindingType === 'zeebe:property') {\n    const zeebeProperties = findExtension(businessObject, 'zeebe:Properties');\n\n    if (!zeebeProperties) {\n      return;\n    }\n\n    return zeebeProperties.get('properties').find((value) => {\n      return value.get('name') === binding.name;\n    });\n  }\n\n  if (bindingType === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    const linkedResources = findExtension(businessObject, 'zeebe:LinkedResources');\n\n    if (!linkedResources) {\n      return;\n    }\n\n    return linkedResources.get('values').find((value) => {\n      return value.get('linkName') === binding.linkName;\n    });\n  }\n}\n\n/**\n * Find old property matching specified new property.\n *\n * @param {Object} oldTemplate\n * @param {Object} newProperty\n *\n * @returns {Object}\n */\nexport function findOldProperty(oldTemplate, newProperty) {\n  if (!oldTemplate) {\n    return;\n  }\n\n  const oldProperties = oldTemplate.properties,\n        newBinding = newProperty.binding,\n        newBindingName = newBinding.name,\n        newBindingType = newBinding.type;\n\n  if (newBindingType === 'property') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'property' && oldBindingName === newBindingName;\n    });\n  }\n\n  if (TASK_DEFINITION_TYPES.includes(newBindingType)) {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldPropertyName = getTaskDefinitionPropertyName(oldBinding),\n            newPropertyName = getTaskDefinitionPropertyName(newBinding);\n\n      return oldPropertyName === newPropertyName;\n    });\n  }\n\n  if (newBindingType === 'zeebe:input') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'zeebe:input') {\n        return;\n      }\n\n      return oldBindingName === newBindingName;\n    });\n  }\n\n  if (newBindingType === 'zeebe:output') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'zeebe:output') {\n        return;\n      }\n\n      return oldBinding.source === newBinding.source;\n    });\n  }\n\n  if (newBindingType === 'zeebe:taskHeader') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'zeebe:taskHeader') {\n        return;\n      }\n\n      return oldBinding.key === newBinding.key;\n    });\n  }\n\n  if (newBindingType === 'zeebe:property') {\n    return oldProperties.find((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'zeebe:property') {\n        return;\n      }\n\n      return oldBinding.name === newBinding.name;\n    });\n  }\n\n  if (newBindingType === MESSAGE_PROPERTY_TYPE) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== MESSAGE_PROPERTY_TYPE) {\n        return;\n      }\n\n      return oldBinding.name === newBinding.name;\n    });\n  }\n\n  if (newBindingType === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n        return;\n      }\n\n      return oldBinding.name === newBinding.name;\n    });\n  }\n\n  if (newBindingType === SIGNAL_PROPERTY_TYPE) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== SIGNAL_PROPERTY_TYPE) {\n        return;\n      }\n\n      return oldBinding.name === newBinding.name;\n    });\n  }\n\n  if (newBindingType === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_LINKED_RESOURCE_PROPERTY) {\n        return;\n      }\n\n      return oldBinding.linkName === newBinding.linkName && oldBinding.property === newBinding.property;\n    });\n  }\n\n  if (newBindingType === ZEEBE_CALLED_DECISION) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_CALLED_DECISION) {\n        return;\n      }\n\n      return oldBindingType === newBindingType && oldBinding.property === newBinding.property;\n    });\n  }\n\n  if (newBindingType === ZEEBE_SCRIPT_TASK) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_SCRIPT_TASK) {\n        return;\n      }\n\n      return oldBindingType === newBindingType && oldBinding.property === newBinding.property;\n    });\n  }\n\n  if (newBindingType === ZEEBE_FORM_DEFINITION) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_FORM_DEFINITION) {\n        return;\n      }\n\n      return oldBindingType === newBindingType && oldBinding.property === newBinding.property;\n    });\n  }\n\n  if (newBindingType === ZEEBE_ASSIGNMENT_DEFINITION) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_ASSIGNMENT_DEFINITION) {\n        return;\n      }\n\n      return oldBindingType === newBindingType && oldBinding.property === newBinding.property;\n    });\n  }\n\n  if (newBindingType === ZEEBE_PRIORITY_DEFINITION) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_PRIORITY_DEFINITION) {\n        return;\n      }\n\n      return oldBindingType === newBindingType && oldBinding.property === newBinding.property;\n    });\n  }\n\n  if (newBindingType === ZEEBE_AD_HOC) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_AD_HOC) {\n        return;\n      }\n\n      return oldBindingType === newBindingType && oldBinding.property === newBinding.property;\n    });\n  }\n\n  if (newBindingType === ZEEBE_TASK_SCHEDULE) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== ZEEBE_TASK_SCHEDULE) {\n        return;\n      }\n\n      return oldBindingType === newBindingType && oldBinding.property === newBinding.property;\n    });\n  }\n\n  if (newBindingType === TIMER_EVENT_DEFINITION_PROPERTY_TYPE) {\n    return oldProperties.find(oldProperty => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== TIMER_EVENT_DEFINITION_PROPERTY_TYPE) {\n        return;\n      }\n\n      return oldBinding.name === newBinding.name;\n    });\n  }\n}\n\n/**\n * Check whether the existing property should be kept. This is the case if\n *  - an old template was set and the value differs from the default\n *  - no template was set but the property was set manually\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} oldProperty\n * @param {Object} newProperty\n *\n * @returns {boolean}\n */\nfunction shouldKeepValue(element, oldProperty, newProperty) {\n\n  // \"Hidden\" values are treated as a constant\n  if (newProperty.type === 'Hidden') {\n    return false;\n  }\n\n  // Dropdowns should keep existing configuration\n  // cf. https://github.com/bpmn-io/bpmn-js-properties-panel/issues/767\n  if (newProperty.type === 'Dropdown') {\n\n    const currentValue = getPropertyValue(element, newProperty);\n\n    // only keep value if old value is a valid option\n    return newProperty.choices && newProperty.choices.some(\n      (choice) => choice.value === currentValue\n    );\n  }\n\n  // keep existing old property if\n  // user changed it from the original\n  if (oldProperty) {\n    return propertyChanged(element, oldProperty);\n  }\n\n  // keep existing property value\n  return !!(getPropertyValue(element, newProperty));\n}\n\n/**\n * Check whether property was changed after being set by template.\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} oldProperty\n *\n * @returns {boolean}\n */\nfunction propertyChanged(element, oldProperty) {\n  const oldPropertyValue = getDefaultFixedValue(oldProperty);\n\n  return getPropertyValue(element, oldProperty) !== oldPropertyValue;\n}\n\nfunction getPropertyValue(element, property) {\n  const businessObject = getBusinessObject(element);\n\n  if (!businessObject) {\n    return;\n  }\n\n  const binding = property.binding,\n        bindingName = binding.name,\n        bindingType = binding.type,\n        bindingProperty = binding.property;\n\n\n  if (bindingType === 'property') {\n    return businessObject.get(bindingName);\n  }\n\n  if (TASK_DEFINITION_TYPES.includes(bindingType)) {\n    return businessObject.get(getTaskDefinitionPropertyName(binding));\n  }\n\n  if (bindingType === 'zeebe:input') {\n    return businessObject.get('zeebe:source');\n  }\n\n  if (bindingType === 'zeebe:output') {\n    return businessObject.get('zeebe:target');\n  }\n\n  if (bindingType === 'zeebe:taskHeader') {\n    return businessObject.get('zeebe:value');\n  }\n\n  if (bindingType === 'zeebe:property') {\n    return businessObject.get('zeebe:value');\n  }\n\n  if (bindingType === MESSAGE_PROPERTY_TYPE) {\n    return businessObject.get(bindingName);\n  }\n\n  if (bindingType === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    return businessObject.get(bindingName);\n  }\n\n  if (bindingType === SIGNAL_PROPERTY_TYPE) {\n    return businessObject.get(bindingName);\n  }\n\n  if (bindingType === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === ZEEBE_CALLED_DECISION) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === ZEEBE_CALLED_ELEMENT) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === ZEEBE_FORM_DEFINITION) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === ZEEBE_SCRIPT_TASK) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === ZEEBE_ASSIGNMENT_DEFINITION) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === ZEEBE_PRIORITY_DEFINITION) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === ZEEBE_AD_HOC) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === ZEEBE_TASK_SCHEDULE) {\n    return businessObject.get(bindingProperty);\n  }\n\n  if (bindingType === TIMER_EVENT_DEFINITION_PROPERTY_TYPE) {\n\n    // the actual value is nested in an Expression\n    return businessObject.get(bindingName)?.get('body');\n  }\n}\n\nfunction remove(array, item) {\n  const index = array.indexOf(item);\n\n  if (index < 0) {\n    return array;\n  }\n\n  array.splice(index, 1);\n\n  return array;\n}\n\n\nfunction hasMessageProperties(template) {\n  return template.properties.some(p => MESSAGE_BINDING_TYPES.includes(p.binding.type));\n}\n\nfunction hasSignalProperties(template) {\n  return template.properties.some(p => p.binding.type === SIGNAL_PROPERTY_TYPE);\n}\n\nfunction shouldUpdateElementType(element, oldTemplate, newType) {\n\n  // Never reuse existing eventDefinition when applying a new template\n  if (!oldTemplate && newType.eventDefinition) {\n    return true;\n  }\n\n  const oldType = oldTemplate && oldTemplate.elementType || {\n    value: element.type,\n    eventDefinition: getEventDefinitionType(element)\n  };\n\n  // Do not update if the element type did not change\n  if (oldType && oldType.value === newType.value && oldType.eventDefinition === newType.eventDefinition) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction getEventDefinitionType(element) {\n  const businessObject = getBusinessObject(element);\n  if (!businessObject.eventDefinitions) {\n    return;\n  }\n\n  const eventDefinition = businessObject.eventDefinitions[ 0 ];\n\n  if (!eventDefinition) {\n    return;\n  }\n\n  return eventDefinition.$type;\n}","export default class RemoveElementTemplateHandler {\n  constructor(commandStack) {\n    this._commandStack = commandStack;\n  }\n\n  preExecute(context) {\n    const {\n      element,\n      oldTemplate\n    } = context;\n\n    this._commandStack.execute('propertiesPanel.zeebe.changeTemplate', {\n      element,\n      oldTemplate,\n      newTemplate: null,\n      removeProperties: true\n    });\n  }\n}\n\n\nRemoveElementTemplateHandler.$inject = [ 'commandStack' ];\n","export default class UnlinkElementTemplateHandler {\n  constructor(commandStack) {\n    this._commandStack = commandStack;\n  }\n\n  preExecute(context) {\n    const {\n      element,\n      oldTemplate\n    } = context;\n\n    this._commandStack.execute('propertiesPanel.zeebe.changeTemplate', {\n      element,\n      oldTemplate,\n      newTemplate: null,\n      removeProperties: false\n    });\n  }\n}\n\n\nUnlinkElementTemplateHandler.$inject = [ 'commandStack' ];\n","import {\n  forEach\n} from 'min-dash';\n\n/**\n * A handler that combines and executes multiple commands.\n *\n * All updates are bundled on the command stack and executed in one step.\n * This also makes it possible to revert the changes in one step.\n *\n * Example use case: remove the camunda:formKey attribute and in addition\n * add all form fields needed for the camunda:formData property.\n */\nexport default class MultiCommandHandler {\n  constructor(commandStack) {\n    this._commandStack = commandStack;\n  }\n\n  preExecute(context) {\n    const commandStack = this._commandStack;\n\n    forEach(context, function(command) {\n      commandStack.execute(command.cmd, command.context);\n    });\n  }\n}\n\nMultiCommandHandler.$inject = [ 'commandStack' ];","import ChangeElementTemplateHandler from './ChangeElementTemplateHandler';\nimport RemoveElementTemplateHandler from './RemoveElementTemplateHandler';\nimport UnlinkElementTemplateHandler from './UnlinkElementTemplateHandler';\nimport MultiCommandHandler from '../../element-templates/cmd/MultiCommandHandler';\n\nexport default class ElementTemplatesCommands {\n  constructor(commandStack, elementTemplates, eventBus) {\n    commandStack.registerHandler(\n      'element-templates.multi-command-executor',\n      MultiCommandHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.zeebe.changeTemplate',\n      ChangeElementTemplateHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.removeTemplate',\n      RemoveElementTemplateHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.unlinkTemplate',\n      UnlinkElementTemplateHandler\n    );\n\n    // apply default element templates on shape creation\n    eventBus.on([ 'commandStack.shape.create.postExecuted' ], function(event) {\n      const {\n        context: {\n          hints = {},\n          shape\n        }\n      } = event;\n\n      if (hints.createElementsBehavior !== false) {\n        applyDefaultTemplate(shape, elementTemplates, commandStack);\n      }\n    });\n\n    // apply default element templates on connection creation\n    eventBus.on([ 'commandStack.connection.create.postExecuted' ], function(event) {\n      const {\n        context: {\n          hints = {},\n          connection\n        }\n      } = event;\n\n      if (hints.createElementsBehavior !== false) {\n        applyDefaultTemplate(connection, elementTemplates, commandStack);\n      }\n    });\n  }\n}\n\nElementTemplatesCommands.$inject = [ 'commandStack', 'elementTemplates', 'eventBus' ];\n\nfunction applyDefaultTemplate(element, elementTemplates, commandStack) {\n\n  if (!elementTemplates.get(element) && elementTemplates.getDefault(element)) {\n\n    const command = 'propertiesPanel.zeebe.changeTemplate';\n    const commandContext = {\n      element: element,\n      newTemplate: elementTemplates.getDefault(element)\n    };\n\n    commandStack.execute(command, commandContext);\n  }\n}","import ElementTemplateCommands from './ElementTemplateCommands';\n\nexport default {\n  __init__: [ 'elementTemplateCommands' ],\n  elementTemplateCommands: [ 'type', ElementTemplateCommands ]\n};","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\nimport { getDefaultValue } from '../Helper';\nimport { isExpression, createExpression } from '../util/bpmnExpressionUtil';\n\n\nexport default class PropertyBindingProvider {\n  static create(element, options) {\n    const {\n      bpmnFactory,\n      property\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      name\n    } = binding;\n\n    let value = getDefaultValue(property);\n\n    const businessObject = getBusinessObject(element);\n\n    if (isExpression(businessObject, name)) {\n      const expression = createExpression(value, businessObject, bpmnFactory);\n\n      value = expression;\n    }\n\n    businessObject[name] = value;\n  }\n}","import {\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\nimport {\n  getTaskDefinitionPropertyName\n} from '../util/taskDefinition';\n\n\nexport default class TaskDefinitionTypeBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const value = getDefaultValue(property);\n    const propertyName = getTaskDefinitionPropertyName(property.binding);\n\n    const taskDefinition = ensureExtension(element, 'zeebe:TaskDefinition', bpmnFactory);\n    taskDefinition.set(propertyName, value);\n  }\n}\n","import {\n  createInputParameter,\n  ensureExtension,\n  shouldUpdate\n} from '../CreateHelper';\n\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class InputBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const ioMapping = ensureExtension(element, 'zeebe:IoMapping', bpmnFactory);\n\n    if (!shouldUpdate(value, property)) {\n      return;\n    }\n\n    const input = createInputParameter(binding, value, bpmnFactory);\n    input.$parent = ioMapping;\n    ioMapping.get('inputParameters').push(input);\n  }\n}","import {\n  createOutputParameter,\n  ensureExtension,\n  shouldUpdate\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class OutputBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const ioMapping = ensureExtension(element, 'zeebe:IoMapping', bpmnFactory);\n\n    if (!shouldUpdate(value, property)) {\n      return;\n    }\n\n    const output = createOutputParameter(binding, value, bpmnFactory);\n    output.$parent = ioMapping;\n    ioMapping.get('outputParameters').push(output);\n  }\n}","import {\n  createTaskHeader,\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class TaskHeaderBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const taskHeaders = ensureExtension(element, 'zeebe:TaskHeaders', bpmnFactory);\n\n    const header = createTaskHeader(binding, value, bpmnFactory);\n    header.$parent = taskHeaders;\n    taskHeaders.get('values').push(header);\n  }\n}","import {\n  createZeebeProperty,\n  ensureExtension,\n  shouldUpdate\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\n/**\n * A provider that sets up the `zeebe:property` binding\n * on a newly created moddle element.\n */\nexport default class ZeebePropertiesProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding,\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const zeebeProperties = ensureExtension(element, 'zeebe:Properties', bpmnFactory);\n\n    if (!shouldUpdate(value, property)) {\n      return;\n    }\n\n    const zeebeProperty = createZeebeProperty(binding, value, bpmnFactory);\n    zeebeProperty.$parent = zeebeProperties;\n    zeebeProperties.get('properties').push(zeebeProperty);\n  }\n}","import { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\nimport { getDefaultValue, getTemplateId } from '../Helper';\n\nexport class MessagePropertyBindingProvider {\n  static create(element, options) {\n    const {\n      bpmnFactory,\n      property\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      name\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    let businessObject = getBusinessObject(element);\n\n    if (is(businessObject, 'bpmn:Event')) {\n      businessObject = businessObject.get('eventDefinitions')[0];\n    }\n\n    let message = businessObject.get('messageRef');\n\n    if (!message) {\n      message = bpmnFactory.create('bpmn:Message', { 'zeebe:modelerTemplate': getTemplateId(element) });\n      businessObject.set('messageRef', message);\n    }\n\n    message.set(name, value);\n  }\n}\n","import { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  ensureExtension,\n  shouldUpdate\n} from '../CreateHelper';\nimport { getDefaultValue, getTemplateId } from '../Helper';\n\nexport class MessageZeebeSubscriptionBindingProvider {\n  static create(element, options) {\n    const {\n      bpmnFactory,\n      property\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      name\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    let businessObject = getBusinessObject(element);\n    if (is(businessObject, 'bpmn:Event')) {\n      businessObject = businessObject.get('eventDefinitions')[0];\n    }\n\n    let message = businessObject.get('messageRef');\n    if (!message) {\n      message = bpmnFactory.create('bpmn:Message', { 'zeebe:modelerTemplate': getTemplateId(element) });\n      businessObject.set('messageRef', message);\n    }\n\n    const subscription = ensureExtension(message, 'zeebe:Subscription', bpmnFactory);\n\n    if (!shouldUpdate(value, property)) {\n      return;\n    }\n\n    subscription.set(name, value);\n  }\n}\n","import { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\nimport { getDefaultValue, getTemplateId } from '../Helper';\n\nexport class SignalPropertyBindingProvider {\n  static create(element, options) {\n    const {\n      bpmnFactory,\n      property\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      name\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    let businessObject = getBusinessObject(element);\n\n    if (is(businessObject, 'bpmn:Event')) {\n      businessObject = businessObject.get('eventDefinitions')[0];\n    }\n\n    let signal = businessObject.get('signalRef');\n\n    if (!signal) {\n      signal = bpmnFactory.create('bpmn:Signal', { 'zeebe:modelerTemplate': getTemplateId(element) });\n      businessObject.set('signalRef', signal);\n    }\n\n    signal.set(name, value);\n  }\n}\n","import { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\nimport { getDefaultValue, findTimerEventDefinition } from '../Helper';\nimport { createElement } from '../../utils/ElementUtil';\n\nexport class TimerPropertyBindingProvider {\n  static create(element, options) {\n    const {\n      bpmnFactory,\n      property\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      name\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const businessObject = getBusinessObject(element);\n\n    let timerEventDefinition = findTimerEventDefinition(businessObject);\n\n    if (!timerEventDefinition) {\n      timerEventDefinition = createElement('bpmn:TimerEventDefinition', {}, businessObject, bpmnFactory);\n      businessObject.set('eventDefinitions', [ timerEventDefinition ]);\n    }\n\n    const expression = createElement('bpmn:FormalExpression', { body: value }, timerEventDefinition, bpmnFactory);\n\n    timerEventDefinition.set(name, expression);\n\n    if (name === 'timeCycle' && is(businessObject, 'bpmn:BoundaryEvent')) {\n      businessObject.set('cancelActivity', false);\n    }\n\n  }\n}\n","import {\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport class CalledElementBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      property: propertyName\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const calledElement = ensureExtension(element, 'zeebe:CalledElement', bpmnFactory);\n\n    // TODO(@barmac): remove if we decide to support propagation in templates\n    ensureNoPropagation(calledElement);\n\n    calledElement.set(propertyName, value);\n  }\n}\n\nfunction ensureNoPropagation(calledElement) {\n  calledElement.set('propagateAllChildVariables', false);\n  calledElement.set('propagateAllParentVariables', false);\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\nimport { createElement } from '../../utils/ElementUtil';\n\nimport {\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class LinkedResourcePropertyBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding: {\n        property: bindingProperty,\n        linkName\n      }\n    } = property;\n\n    const value = getDefaultValue(property);\n\n    const bo = getBusinessObject(element);\n    const linkedResources = ensureExtension(element, 'zeebe:LinkedResources', bpmnFactory);\n\n    let linkedResource = linkedResources.get('values').find(linkedResource => linkedResource.get('linkName') === linkName);\n\n    if (!linkedResource) {\n      linkedResource = createElement('zeebe:LinkedResource', { linkName }, bo, bpmnFactory);\n      linkedResources.get('values').push(linkedResource);\n    }\n\n    linkedResource.set(bindingProperty, value);\n  }\n}\n","import {\n  ensureExtension,\n} from '../CreateHelper';\n\nexport default class ZeebeUserTaskBindingProvider {\n  static create(element, options) {\n    const {\n      bpmnFactory\n    } = options;\n\n    ensureExtension(element, 'zeebe:UserTask', bpmnFactory);\n  }\n}","import {\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport class CalledDecisionBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      property: propertyName\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const calledDecision = ensureExtension(element, 'zeebe:CalledDecision', bpmnFactory);\n\n    calledDecision.set(propertyName, value);\n  }\n}","import {\n  ensureExtension\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport class ScriptTaskBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      property: propertyName\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const scriptTask = ensureExtension(element, 'zeebe:Script', bpmnFactory);\n\n    scriptTask.set(propertyName, value);\n  }\n}\n","import {\n  ensureExtension,\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class ZeebeFormDefinitionBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      property: propertyName\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const formDefinition = ensureExtension(element, 'zeebe:FormDefinition', bpmnFactory);\n\n    formDefinition.set(propertyName, value);\n  }\n}","import {\n  ensureExtension,\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class AssignmentDefinitionBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      property: propertyName\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const assignmentDefinition = ensureExtension(element, 'zeebe:AssignmentDefinition', bpmnFactory);\n\n    assignmentDefinition.set(propertyName, value);\n  }\n}","import {\n  ensureExtension,\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class PriorityDefinitionBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      property: propertyName\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const priorityDefinition = ensureExtension(element, 'zeebe:PriorityDefinition', bpmnFactory);\n\n    priorityDefinition.set(propertyName, value);\n  }\n}\n","import { ensureExtension } from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n/**\n * Provider for the `zeebe:adHoc` binding. Ensures a single zeebe:AdHoc extension\n * element exists and sets the configured property on it.\n */\nexport default class AdHocBindingProvider {\n  static create(element, options) {\n    const { property, bpmnFactory } = options;\n\n    const { binding } = property;\n    const { property: propertyName } = binding;\n\n    const value = getDefaultValue(property);\n\n    const adHoc = ensureExtension(element, 'zeebe:AdHoc', bpmnFactory);\n\n    adHoc.set(propertyName, value);\n  }\n}\n\n","import {\n  ensureExtension,\n} from '../CreateHelper';\nimport { getDefaultValue } from '../Helper';\n\n\nexport default class TaskScheduleBindingProvider {\n  static create(element, options) {\n    const {\n      property,\n      bpmnFactory\n    } = options;\n\n    const {\n      binding\n    } = property;\n\n    const {\n      property: propertyName\n    } = binding;\n\n    const value = getDefaultValue(property);\n\n    const taskSchedule = ensureExtension(element, 'zeebe:TaskSchedule', bpmnFactory);\n\n    taskSchedule.set(propertyName, value);\n  }\n}\n","import {\n  getBusinessObject,\n  is\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  isString,\n  isUndefined\n} from 'min-dash';\n\nimport {\n  EXTENSION_BINDING_TYPES,\n  IO_BINDING_TYPES,\n  MESSAGE_BINDING_TYPES,\n  MESSAGE_PROPERTY_TYPE,\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE,\n  PROPERTY_BINDING_TYPES,\n  SIGNAL_PROPERTY_TYPE,\n  TIMER_EVENT_DEFINITION_PROPERTY_TYPE,\n  TASK_DEFINITION_TYPES,\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION,\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE,\n  ZEEBE_PROPERTY_TYPE,\n  ZEEBE_TASK_HEADER_TYPE,\n  ZEEBE_CALLED_ELEMENT,\n  ZEEBE_LINKED_RESOURCE_PROPERTY,\n  ZEEBE_USER_TASK,\n  ZEEBE_CALLED_DECISION,\n  ZEEBE_FORM_DEFINITION,\n  ZEEBE_SCRIPT_TASK,\n  ZEEBE_ASSIGNMENT_DEFINITION,\n  ZEEBE_PRIORITY_DEFINITION,\n  ZEEBE_AD_HOC,\n  ZEEBE_TASK_SCHEDULE\n} from './bindingTypes';\n\nimport {\n  getTaskDefinitionPropertyName\n} from './taskDefinition';\n\nimport {\n  findExtension,\n  findTaskHeader,\n  findInputParameter,\n  findMessage,\n  findOutputParameter,\n  findSignal,\n  findTimerEventDefinition,\n  findZeebeProperty,\n  getTemplateId\n} from '../Helper';\n\nimport {\n  createInputParameter,\n  createOutputParameter,\n  createTaskDefinition,\n  createTaskHeader,\n  createZeebeProperty,\n  shouldUpdate\n} from '../CreateHelper';\n\nimport { createElement } from '../../utils/ElementUtil';\nimport { getExpressionValue, isExpression, createExpression } from './bpmnExpressionUtil';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\nconst EXPRESSION_TYPES = [\n  'bpmn:Expression',\n  'bpmn:FormalExpression'\n];\n\nexport function getPropertyValue(element, property) {\n  const rawValue = getRawPropertyValue(element, property);\n\n  const { type } = property;\n\n  if (type === 'Boolean') {\n    return getBooleanPropertyValue(rawValue);\n  }\n\n  return rawValue;\n}\n\nfunction getRawPropertyValue(element, property) {\n  let businessObject = getBusinessObject(element);\n\n  const defaultValue = '';\n\n  const {\n    binding\n  } = property;\n\n  const {\n    name,\n    property: bindingProperty,\n    type,\n    linkName\n  } = binding;\n\n  // property\n  if (type === 'property') {\n    const value = isExpression(element, name) ? getExpressionValue(element, name) : businessObject.get(name);\n\n    if (!isUndefined(value)) {\n      return value;\n    }\n\n    return defaultValue;\n  }\n\n  // zeebe:taskDefinition\n  if (TASK_DEFINITION_TYPES.includes(type)) {\n\n    const taskDefinition = findExtension(businessObject, 'zeebe:TaskDefinition');\n\n    if (taskDefinition) {\n      if (type === ZEEBE_TASK_DEFINITION_TYPE_TYPE) {\n        return taskDefinition.get('type');\n      } else if (type === ZEEBE_TASK_DEFINITION) {\n        return taskDefinition.get(bindingProperty);\n      }\n    }\n\n    return defaultValue;\n  }\n\n  if (IO_BINDING_TYPES.includes(type)) {\n    const ioMapping = findExtension(businessObject, 'zeebe:IoMapping');\n\n    if (!ioMapping) {\n      return defaultValue;\n    }\n\n    // zeebe:Input\n    if (type === ZEBBE_INPUT_TYPE) {\n      const inputParameter = findInputParameter(ioMapping, binding);\n\n      if (inputParameter) {\n        return inputParameter.get('source');\n      }\n\n      return defaultValue;\n    }\n\n    // zeebe:Output\n    if (type === ZEEBE_OUTPUT_TYPE) {\n      const outputParameter = findOutputParameter(ioMapping, binding);\n\n      if (outputParameter) {\n        return outputParameter.get('target');\n      }\n\n      return defaultValue;\n    }\n  }\n\n  // zeebe:taskHeaders\n  if (type === ZEEBE_TASK_HEADER_TYPE) {\n    const taskHeaders = findExtension(businessObject, 'zeebe:TaskHeaders');\n\n    if (!taskHeaders) {\n      return defaultValue;\n    }\n\n    const header = findTaskHeader(taskHeaders, binding);\n\n    if (header) {\n      return header.get('value');\n    }\n\n    return defaultValue;\n  }\n\n  // zeebe:Property\n  if (type === ZEEBE_PROPERTY_TYPE) {\n    const zeebeProperties = findExtension(businessObject, 'zeebe:Properties');\n\n    if (zeebeProperties) {\n      const zeebeProperty = findZeebeProperty(zeebeProperties, binding);\n\n      if (zeebeProperty) {\n        return zeebeProperty.get('value');\n      }\n    }\n\n    return defaultValue;\n  }\n\n  // bpmn:Message#property\n  if (type === MESSAGE_PROPERTY_TYPE) {\n    const message = findMessage(businessObject);\n\n    const value = message ? message.get(name) : undefined;\n\n    if (!isUndefined(value)) {\n      return value;\n    }\n\n    return defaultValue;\n  }\n\n  // bpmn:Message#zeebe:subscription#property\n  if (type === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    const message = findMessage(businessObject);\n\n    if (message) {\n      const subscription = findExtension(message, 'zeebe:Subscription');\n\n      const value = subscription ? subscription.get(name) : undefined;\n\n      if (!isUndefined(value)) {\n        return subscription.get(name);\n      }\n    }\n\n    return defaultValue;\n  }\n\n  // bpmn:Signal#property\n  if (type === SIGNAL_PROPERTY_TYPE) {\n    const signal = findSignal(businessObject);\n\n    const value = signal ? signal.get(name) : undefined;\n\n    if (!isUndefined(value)) {\n      return value;\n    }\n\n    return defaultValue;\n  }\n\n  // bpmn:TimerEventDefinition#property\n  if (type === TIMER_EVENT_DEFINITION_PROPERTY_TYPE) {\n    const timerEventDefinition = findTimerEventDefinition(businessObject);\n\n    if (!timerEventDefinition) {\n      return defaultValue;\n    }\n\n    const expression = timerEventDefinition.get(name);\n\n    if (expression) {\n      return expression.get('body');\n    }\n\n    return defaultValue;\n  }\n\n  // zeebe:calledElement\n  if (type === ZEEBE_CALLED_ELEMENT) {\n    const calledElement = findExtension(businessObject, 'zeebe:CalledElement');\n\n    return calledElement ? calledElement.get(bindingProperty) : defaultValue;\n  }\n\n  if (type === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    const linkedResources = findExtension(businessObject, 'zeebe:LinkedResources');\n\n    if (!linkedResources) {\n      return defaultValue;\n    }\n\n    const linkedResource = linkedResources.get('values').find((value) => value.get('linkName') === linkName);\n\n    return linkedResource ? linkedResource.get(bindingProperty) : defaultValue;\n  }\n\n  // zeebe:userTask\n  if (type === ZEEBE_USER_TASK) {\n    const userTask = findExtension(businessObject, 'zeebe:userTask');\n\n    return userTask ? userTask.get(bindingProperty) : defaultValue;\n  }\n\n  // zeebe:calledDecision\n  if (type === ZEEBE_CALLED_DECISION) {\n\n    const calledDecision = findExtension(businessObject, 'zeebe:CalledDecision');\n\n    return calledDecision ? calledDecision.get(bindingProperty) : defaultValue;\n  }\n\n  // zeebe:formDefinition\n  if (type === ZEEBE_FORM_DEFINITION) {\n    const formDefinition = findExtension(businessObject, 'zeebe:FormDefinition');\n\n    return formDefinition ? formDefinition.get(bindingProperty) : defaultValue;\n  }\n\n  // zeebe:script\n  if (type === ZEEBE_SCRIPT_TASK) {\n\n    const scriptTask = findExtension(businessObject, 'zeebe:Script');\n\n    return scriptTask ? scriptTask.get(bindingProperty) : defaultValue;\n  }\n\n  if (type === ZEEBE_ASSIGNMENT_DEFINITION) {\n    const assignmentDefinition = findExtension(businessObject, 'zeebe:AssignmentDefinition');\n\n    return assignmentDefinition ? assignmentDefinition.get(bindingProperty) : defaultValue;\n  }\n\n  if (type === ZEEBE_TASK_SCHEDULE) {\n    const taskSchedule = findExtension(businessObject, 'zeebe:TaskSchedule');\n\n    return taskSchedule ? taskSchedule.get(bindingProperty) : defaultValue;\n  }\n\n  if (type === ZEEBE_PRIORITY_DEFINITION) {\n    const priorityDefinition = findExtension(businessObject, 'zeebe:PriorityDefinition');\n\n    return priorityDefinition ? priorityDefinition.get(bindingProperty) : defaultValue;\n  }\n\n  if (type === ZEEBE_AD_HOC) {\n    const adHoc = findExtension(businessObject, 'zeebe:AdHoc');\n    return adHoc ? adHoc.get(bindingProperty) : defaultValue;\n  }\n\n  // should never throw as templates are validated beforehand\n  throw unknownBindingError(element, property);\n}\n\n/**\n * Cast a string value to a boolean if possible. Otherwise return the value.\n * Cannot always cast due to FEEL expressions.\n *\n * @param {string|boolean} value\n */\nfunction getBooleanPropertyValue(value) {\n  switch (value) {\n  case 'true':\n    return true;\n  case 'false':\n    return false;\n  }\n\n  return value;\n}\n\nconst NO_OP = null;\n\nexport function setPropertyValue(bpmnFactory, commandStack, element, property, value) {\n  let businessObject = getBusinessObject(element);\n\n  const {\n    binding,\n  } = property;\n\n  const {\n    name,\n    type,\n    property: bindingProperty,\n    linkName\n  } = binding;\n\n  let extensionElements;\n\n  let propertyValue;\n\n  const commands = [];\n\n  const context = {\n    element,\n    property\n  };\n\n  // ensure message exists\n  if (MESSAGE_BINDING_TYPES.includes(type)) {\n    if (is(businessObject, 'bpmn:Event')) {\n      businessObject = businessObject.get('eventDefinitions')[0];\n    }\n\n    let message = findMessage(businessObject);\n\n    if (!message) {\n      message = bpmnFactory.create('bpmn:Message', { 'zeebe:modelerTemplate': getTemplateId(element) });\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: businessObject,\n          properties: { messageRef: message }\n        }\n      });\n    }\n\n    businessObject = message;\n  }\n\n  // ensure signal exists\n  if (type === SIGNAL_PROPERTY_TYPE) {\n    if (is(businessObject, 'bpmn:Event')) {\n      businessObject = businessObject.get('eventDefinitions')[0];\n    }\n\n    let signal = findSignal(businessObject);\n\n    if (!signal) {\n      signal = bpmnFactory.create('bpmn:Signal', { 'zeebe:modelerTemplate': getTemplateId(element) });\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: businessObject,\n          properties: { signalRef: signal }\n        }\n      });\n    }\n\n    businessObject = signal;\n  }\n\n  // handle timer event definition property\n  if (type === TIMER_EVENT_DEFINITION_PROPERTY_TYPE) {\n    const timerEventDefinition = findTimerEventDefinition(businessObject);\n\n    if (!timerEventDefinition) {\n      throw new Error('cannot set timer property on element without TimerEventDefinition');\n    }\n\n    let expression = timerEventDefinition.get(name);\n\n    if (!expression) {\n      expression = bpmnFactory.create('bpmn:FormalExpression', { body: value || '' });\n      expression.$parent = timerEventDefinition;\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: timerEventDefinition,\n          properties: { [name]: expression }\n        }\n      });\n    } else {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: expression,\n          properties: { body: value || '' }\n        }\n      });\n    }\n  }\n\n  // ensure extension elements\n  if (EXTENSION_BINDING_TYPES.includes(type)) {\n    extensionElements = businessObject.get('extensionElements');\n\n    if (!extensionElements) {\n      extensionElements = createElement('bpmn:ExtensionElements', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: businessObject,\n          properties: { extensionElements }\n        }\n      });\n    } else {\n      commands.push(NO_OP);\n    }\n  }\n\n  // property\n  if (PROPERTY_BINDING_TYPES.includes(type)) {\n\n    const propertyType = businessObject.$descriptor.propertiesByName[ name ]?.type;\n    let propertyName = name;\n\n    if (!propertyType || propertyType === 'String') {\n\n      // make sure we create and don't remove the property\n      propertyValue = value || '';\n    } else if (propertyType === 'Boolean') {\n      propertyValue = !!value;\n    } else if (propertyType === 'Integer') {\n      propertyValue = parseInt(value, 10);\n\n      if (isNaN(propertyValue)) {\n\n        // do not set NaN value\n        propertyValue = undefined;\n      }\n    } else if (EXPRESSION_TYPES.includes(propertyType)) {\n      const existingExpression = businessObject.get(name);\n\n      if (existingExpression && is(existingExpression, 'bpmn:FormalExpression')) {\n\n        // re-use existing expression\n        businessObject = existingExpression;\n        propertyName = 'body';\n        propertyValue = value || '';\n      } else {\n        propertyValue = createExpression(value, businessObject, bpmnFactory);\n      }\n    } else {\n\n      // unsupported non-primitive types cannot be set\n      throw new Error(`cannot set property of type <${ propertyType }>`);\n    }\n\n    if (!isUndefined(propertyValue)) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: businessObject,\n          properties: { [ propertyName ]: propertyValue }\n        }\n      });\n    } else {\n      commands.push(NO_OP);\n    }\n  }\n\n  // zeebe:taskDefinition\n  if (TASK_DEFINITION_TYPES.includes(type)) {\n    const oldTaskDefinition = findExtension(extensionElements, 'zeebe:TaskDefinition'),\n          propertyName = getTaskDefinitionPropertyName(binding),\n          properties = {\n            [ propertyName ]: value || ''\n          };\n\n    if (oldTaskDefinition) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          properties,\n          moddleElement: oldTaskDefinition\n        }\n      });\n    } else {\n      const newTaskDefinition = createTaskDefinition(properties, bpmnFactory);\n      newTaskDefinition.$parent = businessObject;\n\n      const values = extensionElements.get('values');\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...values, newTaskDefinition ] }\n        }\n      });\n    }\n  }\n\n  if (IO_BINDING_TYPES.includes(type)) {\n    let ioMapping = findExtension(extensionElements, 'zeebe:IoMapping');\n\n    if (!ioMapping) {\n      ioMapping = createElement('zeebe:IoMapping', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), ioMapping ] }\n        }\n      });\n    }\n\n    // zeebe:Input\n    if (type === ZEBBE_INPUT_TYPE) {\n      const oldZeebeInputParameter = findInputParameter(ioMapping, binding);\n      const values = ioMapping.get('inputParameters').filter((value) => value !== oldZeebeInputParameter);\n\n      // do not persist empty parameters when configured as <optional>\n      if (shouldUpdate(value, property)) {\n        const newZeebeInputParameter = createInputParameter(binding, value, bpmnFactory);\n        values.push(newZeebeInputParameter);\n      }\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { inputParameters: [ ...values ] }\n        }\n      });\n    }\n\n    // zeebe:Output\n    if (type === ZEEBE_OUTPUT_TYPE) {\n      const oldZeebeOutputParameter = findOutputParameter(ioMapping, binding);\n      const values = ioMapping.get('outputParameters').filter((value) => value !== oldZeebeOutputParameter);\n\n      // do not persist empty parameters when configured as <optional>\n      if (shouldUpdate(value, property)) {\n        const newZeebeOutputParameter = createOutputParameter(binding, value, bpmnFactory);\n        values.push(newZeebeOutputParameter);\n      }\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { 'outputParameters': [ ...values ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:taskHeaders\n  if (type === ZEEBE_TASK_HEADER_TYPE) {\n    let taskHeaders = findExtension(extensionElements, 'zeebe:TaskHeaders');\n\n    if (!taskHeaders) {\n      taskHeaders = createElement('zeebe:TaskHeaders', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), taskHeaders ] }\n        }\n      });\n    }\n\n    const oldTaskHeader = findTaskHeader(taskHeaders, binding);\n\n    const values = taskHeaders.get('values').filter((value) => value !== oldTaskHeader);\n\n    // do not persist task headers with empty value\n    if (!value) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: taskHeaders,\n          properties: { values }\n        }\n      });\n    } else {\n      const newTaskHeader = createTaskHeader(binding, value, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: taskHeaders,\n          properties: { values: [ ...values, newTaskHeader ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:Property\n  if (type === ZEEBE_PROPERTY_TYPE) {\n    let zeebeProperties = findExtension(extensionElements, 'zeebe:Properties');\n\n    if (!zeebeProperties) {\n      zeebeProperties = createElement('zeebe:Properties', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          moddleElement: extensionElements,\n          properties: {\n            values: [ ...extensionElements.get('values'), zeebeProperties ]\n          }\n        }\n      });\n    }\n\n    const oldZeebeProperty = findZeebeProperty(zeebeProperties, binding);\n\n    const properties = zeebeProperties.get('properties').filter((property) => property !== oldZeebeProperty);\n\n    if (shouldUpdate(value, property)) {\n      const newZeebeProperty = createZeebeProperty(binding, value, bpmnFactory);\n\n      properties.push(newZeebeProperty);\n    }\n\n    commands.push({\n      cmd: 'element.updateModdleProperties',\n      context: {\n        element,\n        moddleElement: zeebeProperties,\n        properties: {\n          properties\n        }\n      }\n    });\n  }\n\n  // bpmn:Message#zeebe:subscription#property\n  if (type === MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE) {\n    let subscription = findExtension(extensionElements, 'zeebe:Subscription');\n    const properties = {\n      [ name ]: value || ''\n    };\n\n    if (subscription) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: subscription\n        }\n      });\n    } else {\n      subscription = createElement('zeebe:Subscription', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), subscription ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:calledElement\n  if (type === ZEEBE_CALLED_ELEMENT) {\n    let calledElement = findExtension(element, 'zeebe:CalledElement');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (calledElement) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: calledElement\n        }\n      });\n    } else {\n      calledElement = createElement('zeebe:CalledElement', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), calledElement ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:linkedResource\n  if (type === ZEEBE_LINKED_RESOURCE_PROPERTY) {\n    let linkedResources = findExtension(businessObject, 'zeebe:LinkedResources');\n\n    if (!linkedResources) {\n      linkedResources = createElement('zeebe:LinkedResources', null, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), linkedResources ] }\n        }\n      });\n    }\n\n    let linkedResource = linkedResources.get('values').find((value) => value.get('linkName') === linkName);\n\n    if (!linkedResource) {\n      linkedResource = createElement('zeebe:LinkedResource', { linkName }, businessObject, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: linkedResources,\n          properties: { values: [ ...linkedResources.get('values'), linkedResource ] }\n        }\n      });\n    }\n\n    commands.push({\n      cmd: 'element.updateModdleProperties',\n      context: {\n        ...context,\n        moddleElement: linkedResource,\n        properties: { [ bindingProperty ]: value }\n      }\n    });\n  }\n\n  // zeebe:calledDecision\n  if (type === ZEEBE_CALLED_DECISION) {\n    let calledDecision = findExtension(element, 'zeebe:CalledDecision');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (calledDecision) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: calledDecision\n        }\n      });\n    } else {\n      calledDecision = createElement('zeebe:CalledDecision', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), calledDecision ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:script\n  if (type === ZEEBE_SCRIPT_TASK) {\n    let scriptTask = findExtension(element, 'zeebe:Script');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (scriptTask) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: scriptTask\n        }\n      });\n    } else {\n      scriptTask = createElement('zeebe:Script', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), scriptTask ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:formDefinition\n  if (type === ZEEBE_FORM_DEFINITION) {\n    let formDefinition = findExtension(element, 'zeebe:FormDefinition');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (formDefinition) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: formDefinition\n        }\n      });\n    } else {\n      formDefinition = createElement('zeebe:FormDefinition', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), formDefinition ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:assignmentDefinition\n  if (type === ZEEBE_ASSIGNMENT_DEFINITION) {\n    let assignmentDefinition = findExtension(element, 'zeebe:AssignmentDefinition');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (assignmentDefinition) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: assignmentDefinition\n        }\n      });\n    } else {\n      assignmentDefinition = createElement('zeebe:AssignmentDefinition', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), assignmentDefinition ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:taskSchedule\n  if (type === ZEEBE_TASK_SCHEDULE) {\n    let taskSchedule = findExtension(element, 'zeebe:TaskSchedule');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (taskSchedule) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: taskSchedule\n        }\n      });\n    } else {\n      taskSchedule = createElement('zeebe:TaskSchedule', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), taskSchedule ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:priorityDefinition\n  if (type === ZEEBE_PRIORITY_DEFINITION) {\n    let priorityDefinition = findExtension(element, 'zeebe:PriorityDefinition');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (priorityDefinition) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: priorityDefinition\n        }\n      });\n    } else {\n      priorityDefinition = createElement('zeebe:PriorityDefinition', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), priorityDefinition ] }\n        }\n      });\n    }\n  }\n\n  // zeebe:adHoc\n  if (type === ZEEBE_AD_HOC) {\n    let adHoc = findExtension(element, 'zeebe:AdHoc');\n    const propertyName = binding.property;\n\n    const properties = {\n      [ propertyName ]: value || ''\n    };\n\n    if (adHoc) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          properties,\n          moddleElement: adHoc\n        }\n      });\n    } else {\n      adHoc = createElement('zeebe:AdHoc', properties, extensionElements, bpmnFactory);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: extensionElements,\n          properties: { values: [ ...extensionElements.get('values'), adHoc ] }\n        }\n      });\n    }\n  }\n\n\n\n  if (commands.length) {\n    const commandsToExecute = commands.filter((command) => command !== NO_OP);\n\n    commandsToExecute.length && commandStack.execute(\n      'element-templates.multi-command-executor',\n      commandsToExecute\n    );\n\n    return;\n  }\n\n  // should never throw as templates are validated beforehand\n  throw unknownBindingError(element, property);\n}\n\n\n// TODO(@barmac): fix translate usage (https://github.com/bpmn-io/bpmn-js-element-templates/pull/53#issuecomment-1906203270)\nexport function validateProperty(value, property, translate = defaultTranslate) {\n  const {\n    constraints = {},\n    label\n  } = property;\n\n  const {\n    maxLength,\n    minLength,\n    notEmpty\n  } = constraints;\n\n  if (notEmpty && isEmpty(value)) {\n    return `${label} ${translate('must not be empty.')}`;\n  }\n\n  if (property.feel && isFeel(value)) {\n    return;\n  }\n\n  if (maxLength && (value || '').length > maxLength) {\n    return `${label} ${translate('must have max length {maxLength}.', { maxLength })}`;\n  }\n\n  if (minLength && (value || '').length < minLength) {\n    return `${label} ${translate('must have min length {minLength}.', { minLength })}`;\n  }\n\n  let { pattern } = constraints;\n\n  if (pattern) {\n    let message;\n\n    if (!isString(pattern)) {\n      message = pattern.message;\n      pattern = pattern.value;\n    }\n\n    if (!matchesPattern(value, pattern)) {\n      if (message) {\n        return `${label} ${translate(message)}`;\n      }\n\n      return `${label} ${translate('must match pattern {pattern}.', { pattern })}`;\n    }\n  }\n}\n\n// helpers\nfunction unknownBindingError(element, property) {\n  const businessObject = getBusinessObject(element);\n\n  const id = businessObject.get('id');\n\n  const { binding } = property;\n\n  const { type } = binding;\n\n  return new Error(`unknown binding <${ type }> for element <${ id }>, this should never happen`);\n}\n\nfunction isEmpty(value) {\n  if (typeof value === 'string') {\n    return !value.trim().length;\n  }\n\n  return value === undefined;\n}\n\nfunction matchesPattern(string, pattern) {\n  return new RegExp(pattern).test(string);\n}\n\n\nfunction defaultTranslate(template, replacements) {\n\n  replacements = replacements || {};\n\n  return template.replace(/{([^}]+)}/g, function(_, key) {\n    return replacements[key] || '{' + key + '}';\n  });\n}\n\nfunction isFeel(value) {\n  return isString(value) && value.trim().startsWith('=');\n}","import { isEventSubProcess } from 'bpmn-js/lib/util/DiUtil';\nimport { getPropertyValue } from './util/propertyUtil';\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\nimport { shouldCastToFeel } from './util/FeelUtil';\n\n/**\n * Based on conditions, remove properties from the template.\n */\nexport function applyConditions(element, elementTemplate) {\n  const { properties } = elementTemplate;\n\n  const filteredProperties = properties.filter(property => {\n    return isPropertyAllowed(element, property) && isConditionMet(element, properties, property);\n  });\n\n  return {\n    ...elementTemplate,\n    properties: filteredProperties\n  };\n}\n\nexport function isConditionMet(element, properties, property) {\n  const { condition } = property;\n\n  // If no condition is defined, return true.\n  if (!condition) {\n    return true;\n  }\n\n  // multiple (\"and\") conditions\n  if (condition.allMatch) {\n    const conditions = condition.allMatch;\n\n    return conditions.every(\n      condition => isSimpleConditionMet(element, properties, condition)\n    );\n  }\n\n  // single condition\n  return isSimpleConditionMet(element, properties, condition);\n}\n\nfunction isSimpleConditionMet(element, properties, condition) {\n  const { property, equals, oneOf, isActive } = condition;\n\n  if (typeof isActive !== 'undefined') {\n    const relatedCondition = properties.find(p => p.id === property);\n\n    if (!relatedCondition) {\n      return !isActive;\n    }\n\n    return isActive ? isConditionMet(element, properties, relatedCondition) : !isConditionMet(element, properties, relatedCondition);\n  }\n\n  const propertyObject = getProperty(properties, property);\n\n  if (propertyObject) {\n\n    // if the property is a FEEL [optional, static, required] property,\n    // we need to get the value removing the '='\n\n    const propertyValue = shouldCastToFeel(propertyObject) || propertyObject.feel === 'required' ?\n      getPropertyValue(element, propertyObject).slice(1) :\n      getPropertyValue(element, propertyObject);\n\n    if (hasProperty(condition, 'equals')) {\n      return compareProperty(propertyObject, propertyValue, equals);\n    }\n\n    if (oneOf) {\n      return oneOf.includes(propertyValue);\n    }\n  }\n\n  return false;\n}\n\nexport function getProperty(properties, propertyId) {\n  const property = properties.find(p => p.id === propertyId);\n\n  if (!property) {\n    return;\n  }\n\n  return property;\n}\n\nfunction isPropertyAllowed(element, property) {\n  const { binding } = property;\n  const { type } = binding;\n\n  if (\n    type === 'bpmn:Message#zeebe:subscription#property' &&\n    binding.name === 'correlationKey' &&\n    is(element, 'bpmn:StartEvent') &&\n    !isEventSubProcess(element.parent)\n  ) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction compareProperty(propertyObj, propertyValue, value) {\n\n  // Number\n  if (propertyObj.type === 'Number') {\n    return Number(propertyValue) === value;\n  }\n\n  // Boolean\n  else if (propertyObj.type === 'Boolean') {\n    return Boolean(propertyValue) === value;\n  }\n\n  return propertyValue === value;\n}\n\n// helpers //////////////////////\n\nfunction hasProperty(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}","import {\n  getBusinessObject\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport { find } from 'min-dash';\n\nimport PropertyBindingProvider from './PropertyBindingProvider';\nimport TaskDefinitionBindingProvider from './TaskDefinitionBindingProvider';\nimport InputBindingProvider from './InputBindingProvider';\nimport OutputBindingProvider from './OutputBindingProvider';\nimport TaskHeaderBindingProvider from './TaskHeaderBindingProvider';\nimport ZeebePropertiesProvider from './ZeebePropertiesProvider';\nimport { MessagePropertyBindingProvider } from './MessagePropertyBindingProvider';\nimport { MessageZeebeSubscriptionBindingProvider } from './MessageZeebeSubscriptionBindingProvider';\nimport { SignalPropertyBindingProvider } from './SignalPropertyBindingProvider';\nimport { TimerPropertyBindingProvider } from './TimerPropertyBindingProvider';\nimport { CalledElementBindingProvider } from './CalledElementBindingProvider';\nimport LinkedResourcePropertyBindingProvider from './LinkedResourceProvider';\nimport ZeebeUserTaskBindingProvider from './ZeebeUserTaskBindingProvider';\nimport { CalledDecisionBindingProvider } from './CalledDecisionBindingProvider';\nimport { ScriptTaskBindingProvider } from './ScriptTaskBindingProvider';\nimport ZeebeFormDefinitionBindingProvider from './FormDefinitionBindingProvider';\nimport ZeebeAssignmentDefinitionBindingProvider from './AssignmentDefinitionBindingProvider';\nimport ZeebePriorityDefinitionBindingProvider from './PriorityDefinitionBindingProvider';\nimport AdHocBindingProvider from './AdHocBindingProvider';\nimport TaskScheduleBindingProvider from './TaskScheduleBindingProvider';\n\nimport {\n  MESSAGE_PROPERTY_TYPE,\n  MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE,\n  PROPERTY_TYPE,\n  SIGNAL_PROPERTY_TYPE,\n  TIMER_EVENT_DEFINITION_PROPERTY_TYPE,\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION,\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE,\n  ZEEBE_TASK_HEADER_TYPE,\n  ZEBBE_PROPERTY_TYPE,\n  ZEEBE_CALLED_ELEMENT,\n  ZEEBE_LINKED_RESOURCE_PROPERTY,\n  ZEEBE_USER_TASK,\n  ZEEBE_CALLED_DECISION,\n  ZEEBE_FORM_DEFINITION,\n  ZEEBE_SCRIPT_TASK,\n  ZEEBE_ASSIGNMENT_DEFINITION,\n  ZEEBE_PRIORITY_DEFINITION,\n  ZEEBE_AD_HOC,\n  ZEEBE_TASK_SCHEDULE\n} from '../util/bindingTypes';\n\nimport { isConditionMet } from '../Condition';\nimport { isSubprocess } from '../../utils/ElementUtil';\n\nexport default class TemplateElementFactory {\n\n  constructor(bpmnFactory, elementFactory) {\n    this._bpmnFactory = bpmnFactory;\n    this._elementFactory = elementFactory;\n\n    this._providers = {\n      [PROPERTY_TYPE]: PropertyBindingProvider,\n      [ZEEBE_TASK_DEFINITION_TYPE_TYPE]: TaskDefinitionBindingProvider,\n      [ZEEBE_TASK_DEFINITION]: TaskDefinitionBindingProvider,\n      [ZEBBE_PROPERTY_TYPE]: ZeebePropertiesProvider,\n      [ZEBBE_INPUT_TYPE]: InputBindingProvider,\n      [ZEEBE_OUTPUT_TYPE]: OutputBindingProvider,\n      [ZEEBE_TASK_HEADER_TYPE]: TaskHeaderBindingProvider,\n      [MESSAGE_PROPERTY_TYPE]: MessagePropertyBindingProvider,\n      [MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE]: MessageZeebeSubscriptionBindingProvider,\n      [SIGNAL_PROPERTY_TYPE]: SignalPropertyBindingProvider,\n      [TIMER_EVENT_DEFINITION_PROPERTY_TYPE]: TimerPropertyBindingProvider,\n      [ZEEBE_CALLED_ELEMENT]: CalledElementBindingProvider,\n      [ZEEBE_LINKED_RESOURCE_PROPERTY]: LinkedResourcePropertyBindingProvider,\n      [ZEEBE_USER_TASK]: ZeebeUserTaskBindingProvider,\n      [ZEEBE_CALLED_DECISION]: CalledDecisionBindingProvider,\n      [ZEEBE_FORM_DEFINITION]: ZeebeFormDefinitionBindingProvider,\n      [ZEEBE_SCRIPT_TASK]: ScriptTaskBindingProvider,\n      [ZEEBE_ASSIGNMENT_DEFINITION]: ZeebeAssignmentDefinitionBindingProvider,\n      [ZEEBE_PRIORITY_DEFINITION]: ZeebePriorityDefinitionBindingProvider,\n      [ZEEBE_AD_HOC]: AdHocBindingProvider,\n      [ZEEBE_TASK_SCHEDULE]: TaskScheduleBindingProvider\n    };\n  }\n\n  /**\n   * Create an element based on an element template.\n   *\n   * @param {ElementTemplate} template\n   * @returns {djs.model.Base}\n   */\n  create(template) {\n\n    const {\n      properties\n    } = template;\n\n    // (1) base shape\n    const element = this._createShape(template);\n\n    // (2) apply template\n    this._setModelerTemplate(element, template);\n\n    // (3) apply icon\n    if (hasIcon(template)) {\n      this._setModelerTemplateIcon(element, template);\n    }\n\n    // (4) apply properties\n    this._applyProperties(element, properties);\n\n    return element;\n  }\n\n  _createShape(template) {\n    const {\n      appliesTo,\n      elementType = {}\n    } = template;\n    const elementFactory = this._elementFactory;\n\n    const attrs = {\n      type: elementType.value || appliesTo[0]\n    };\n\n    if (isSubprocess(attrs.type)) {\n      attrs.isExpanded = true;\n    }\n\n    // apply eventDefinition\n    if (elementType.eventDefinition) {\n      attrs.eventDefinitionType = elementType.eventDefinition;\n    }\n\n    const element = elementFactory.createShape(attrs);\n\n    return element;\n  }\n\n  _ensureExtensionElements(element) {\n    const bpmnFactory = this._bpmnFactory;\n    const businessObject = getBusinessObject(element);\n\n    let extensionElements = businessObject.get('extensionElements');\n\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      extensionElements.$parent = businessObject;\n      businessObject.set('extensionElements', extensionElements);\n    }\n\n    return extensionElements;\n  }\n\n  _setModelerTemplate(element, template) {\n    const {\n      id,\n      version\n    } = template;\n\n    const businessObject = getBusinessObject(element);\n\n    businessObject.set('zeebe:modelerTemplate', id);\n    businessObject.set('zeebe:modelerTemplateVersion', version);\n  }\n\n  _setModelerTemplateIcon(element, template) {\n    const {\n      icon\n    } = template;\n\n    const {\n      contents\n    } = icon;\n\n    const businessObject = getBusinessObject(element);\n\n    businessObject.set('zeebe:modelerTemplateIcon', contents);\n  }\n\n  /**\n   * Apply properties to a given element.\n   *\n   * @param {djs.model.Base} element\n   * @param {Array<Object>} properties\n   */\n  _applyProperties(element, properties) {\n    const processedProperties = [];\n\n    properties.forEach(\n      property => this._applyProperty(element, property, properties, processedProperties)\n    );\n  }\n\n  /**\n   * Apply a property and its parent properties to an element based on conditions.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} property\n   * @param {Array<Object>} properties\n   * @param {Array<Object>} processedProperties\n   */\n  _applyProperty(element, property, properties, processedProperties) {\n\n    // skip if already processed\n    if (processedProperties.includes(property)) {\n      return;\n    }\n\n    // apply dependant property first if not already applied\n    const dependentProperties = findDependentProperties(property, properties);\n\n    dependentProperties.forEach(\n      property => this._applyProperty(element, property, properties, processedProperties)\n    );\n\n    // check condition and apply property if condition is met\n    if (isConditionMet(element, properties, property)) {\n      this._bindProperty(property, element);\n    }\n\n    processedProperties.push(property);\n  }\n\n  /**\n   * Bind property to element.\n   * @param {Object} property\n   * @param {djs.Model.Base} element\n   */\n  _bindProperty(property, element) {\n    const {\n      binding\n    } = property;\n\n    const {\n      type: bindingType\n    } = binding;\n\n    const bindingProvider = this._providers[bindingType];\n\n    bindingProvider.create(element, {\n      property,\n      bpmnFactory: this._bpmnFactory\n    });\n  }\n}\n\nTemplateElementFactory.$inject = [ 'bpmnFactory', 'elementFactory' ];\n\n\n// helper ////////////////\n\nfunction hasIcon(template) {\n  const {\n    icon\n  } = template;\n\n  return !!(icon && icon.contents);\n}\n\nfunction findDependentProperties(property, properties) {\n\n  const {\n    condition\n  } = property;\n\n  if (!condition) {\n    return [];\n  }\n\n  const dependentProperty = findPropertyById(properties, condition.property);\n\n  if (dependentProperty) {\n    return [ dependentProperty ];\n  }\n\n  return [];\n}\n\nfunction findPropertyById(properties, id) {\n  return find(properties, function(property) {\n    return property.id === id;\n  });\n}\n","import TemplateElementFactory from './TemplateElementFactory';\n\nexport default {\n  __init__: [\n    'templateElementFactory'\n  ],\n  templateElementFactory: [ 'type', TemplateElementFactory ]\n};\n","import {\n  applyConditions\n} from '../Condition';\n\nimport { isObject } from 'min-dash';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { ZEEBE_TASK_DEFINITION, ZEEBE_TASK_DEFINITION_TYPE_TYPE } from '../util/bindingTypes';\n\n\n/**\n * Checks the conditions of an element template and sets/resets the\n * corresponding properties on the element.\n */\nexport default class ConditionalBehavior extends CommandInterceptor {\n\n  /**\n   * @param {import('diagram-js/lib/core/EventBus').default} eventBus\n   * @param {import('../ElementTemplates').default} elementTemplates\n   * @param {import('diagram-js/lib/command/CommandStack').default} commandStack\n   * @param {import('bpmn-js/lib/features/modeling/BpmnFactory').default} bpmnFactory\n   * @param {import('didi').Injector} injector\n   */\n  constructor(eventBus, elementTemplates, commandStack, bpmnFactory, injector) {\n    super(eventBus);\n\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._commandStack = commandStack;\n    this._bpmnFactory = bpmnFactory;\n    this._injector = injector;\n\n    // (1) save pre-conditional state before updating a property\n    this.preExecute([\n      'element.updateProperties',\n      'element.updateModdleProperties',\n      'element.move'\n    ], this._saveConditionalState, true, this);\n\n    // (2) check if we need to apply post-conditional updates\n    //\n    //   if [additional bindings activate] then\n    //     (re-)trigger setting the template\n    //   else\n    //     else we're done\n    //\n    this.postExecute([\n      'element.updateProperties',\n      'element.updateModdleProperties',\n      'propertiesPanel.zeebe.changeTemplate',\n      'element.move'\n    ], this._applyConditions, true, this);\n\n    // (3) set conditions before changing the template\n    this.preExecute([\n      'propertiesPanel.zeebe.changeTemplate'\n    ], this._ensureConditional, true, this);\n  }\n\n  _saveConditionalState(context) {\n    const {\n      element\n    } = context;\n\n    const template = this._elementTemplates.get(element);\n\n    if (!template) {\n      return;\n    }\n\n    context.oldTemplateWithConditions = applyConditions(element, template);\n  }\n\n  _applyConditions(context, event) {\n    const {\n      element,\n      newTemplate,\n      oldTemplateWithConditions\n    } = context;\n\n    // do not apply conditions if we only update meta information\n    if (isMetaUpdate(event, context)) {\n      return;\n    }\n\n    const template = this._elementTemplates.get(element);\n\n    // new Template is persisted before applying default values,\n    // new conditions might apply after the defaults are present.\n    const oldTemplate = oldTemplateWithConditions || newTemplate;\n\n    if (!template || !oldTemplate) {\n      return;\n    }\n\n    const newTemplateWithConditions = applyConditions(element, template);\n\n    // verify that new bindings were activated\n    if (!hasDifferentPropertyBindings(newTemplateWithConditions, oldTemplate)) {\n      return;\n    }\n\n    // do another pass to apply further conditional bindings\n    // newTemplate will always be the original template; it is filtered\n    // at a later step (3)\n    const changeContext = {\n      element,\n      newTemplate: template,\n      oldTemplate\n    };\n\n    this._commandStack.execute('propertiesPanel.zeebe.changeTemplate', changeContext);\n  }\n\n  _ensureConditional(context) {\n    const {\n      element,\n      newTemplate\n    } = context;\n\n    if (!newTemplate) {\n      return;\n    }\n\n    // ensure conditions are applied before changing the template.\n    // `newTemplate` will always be the original template.\n    context.newTemplate = applyConditions(element, newTemplate);\n  }\n\n}\n\n\nConditionalBehavior.$inject = [\n  'eventBus',\n  'elementTemplates',\n  'commandStack',\n  'bpmnFactory',\n  'injector'\n];\n\n\n// helpers\n\nfunction hasDifferentPropertyBindings(sourceTemplate, targetTemplate) {\n  return hasNewProperties(sourceTemplate, targetTemplate) || hasRemovedProperties(sourceTemplate, targetTemplate);\n}\n\nfunction hasNewProperties(sourceTemplate, targetTemplate) {\n  let properties = targetTemplate.properties;\n\n  return properties.some(targetProp =>!(\n    sourceTemplate.properties.find(sourceProp => compareProps(sourceProp, targetProp))\n  ));\n}\n\nfunction hasRemovedProperties(oldTemplate, newTemplate) {\n  const oldProperties = getMissingProperties(newTemplate, oldTemplate);\n\n  // ensure XML properties are mantained for properties with\n  // different conditions but same bindings\n  return oldProperties.some(property =>\n    !findPropertyWithBinding(newTemplate, property)\n  );\n}\n\nfunction getMissingProperties(sourceTemplate, targetTemplate) {\n\n  let properties = targetTemplate.properties;\n\n  return properties.filter(targetProp =>!(\n    sourceTemplate.properties.find(sourceProp => compareProps(sourceProp, targetProp))\n  ));\n}\n\nfunction compareProps(sourceProp, targetProp) {\n  return (\n    areBindingsEqual(sourceProp.binding, targetProp.binding) &&\n    equals(sourceProp.condition, targetProp.condition)\n  );\n}\n\nfunction findPropertyWithBinding(template, prop1) {\n  return template.properties.some(\n    prop2 => areBindingsEqual(prop1.binding, prop2.binding)\n  );\n}\n\nfunction normalizeReplacer(key, value) {\n\n  if (isObject(value)) {\n    const keys = Object.keys(value).sort();\n\n    return keys.reduce((obj, key) => {\n      obj[key] = value[key];\n\n      return obj;\n    }, {});\n  }\n\n  return value;\n}\n\nfunction areBindingsEqual(binding1, binding2) {\n  binding1 = normalizeBinding(binding1);\n  binding2 = normalizeBinding(binding2);\n\n  return equals(binding1, binding2);\n}\n\n/**\n * Convert deprecated binding type to new type.\n */\nfunction normalizeBinding(binding) {\n  if (binding.type === ZEEBE_TASK_DEFINITION_TYPE_TYPE) {\n    return {\n      ...binding,\n      type: ZEEBE_TASK_DEFINITION,\n      property: 'type'\n    };\n  }\n\n  return binding;\n}\n\nfunction equals(a, b) {\n  return JSON.stringify(a, normalizeReplacer) === JSON.stringify(b, normalizeReplacer);\n}\n\n/**\n * Checks if the event only updates \"meta\" properties:\n *\n *   * `zeebe:modelerTemplate`\n *   * `zeebe:modelerTemplateVersion`\n *\n * @param {string} event\n * @param {any} context\n *\n * @return {boolean}\n */\nfunction isMetaUpdate(event, context) {\n  return event === 'element.updateProperties' && (\n    Object.keys(context.properties).every(\n      key => [ 'zeebe:modelerTemplate', 'zeebe:modelerTemplateVersion' ].includes(key)\n    ));\n}","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * This Behavior checks if the new element's type is in\n * the list of elements the template applies to and unlinks\n * it if not.\n */\nexport default class ReplaceBehavior extends CommandInterceptor {\n  constructor(elementTemplates, injector) {\n    super(injector.get('eventBus'));\n\n    this.postExecuted('shape.replace', function(e) {\n      var context = e.context,\n          oldShape = context.oldShape,\n          oldBo = getBusinessObject(oldShape),\n          newShape = context.newShape,\n          newBo = getBusinessObject(newShape);\n\n      if (!oldBo.modelerTemplate) {\n        return;\n      }\n\n      const template = newBo.modelerTemplate;\n      const version = newBo.modelerTemplateVersion;\n\n      const elementTemplate = elementTemplates.get(template, version);\n\n      if (!elementTemplate) {\n        elementTemplates.unlinkTemplate(newShape);\n        return;\n      }\n\n      const { appliesTo, elementType } = elementTemplate;\n\n      if (elementType) {\n        if (!is(newShape, elementType.value) || shouldUnlinkEvent(newShape, elementType)) {\n          elementTemplates.unlinkTemplate(newShape);\n        }\n\n        return;\n      }\n\n      const allowed = appliesTo.reduce((allowed, type) => {\n        return allowed || is(newBo, type);\n      }, false);\n\n      if (!allowed) {\n        elementTemplates.unlinkTemplate(newShape);\n      }\n    });\n  }\n}\n\nReplaceBehavior.$inject = [\n  'elementTemplates',\n  'injector'\n];\n\nfunction shouldUnlinkEvent(newShape, elementType) {\n  if (!is(newShape, 'bpmn:Event')) {\n    return false;\n  }\n\n  const { eventDefinition } = elementType,\n        bo = getBusinessObject(newShape),\n        eventDefinitions = bo.get('eventDefinitions');\n\n  if (!eventDefinition) {\n    return eventDefinitions.length !== 0;\n  }\n\n  return !is(eventDefinitions[0], eventDefinition);\n}\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { TIMER_EVENT_DEFINITION_PROPERTY_TYPE } from '../util/bindingTypes';\nimport { isTimerExpressionTypeSupported } from '../util/timerUtil';\nimport { findTimerEventDefinition } from '../Helper';\n\n/**\n * This Behavior monitors changes to timer events and unlinks templates\n * when constraints are violated:\n * - timeCycle requires non-interrupting for boundary events (cancelActivity: false)\n * - timeCycle requires non-interrupting for event subprocess starts (isInterrupting: false)\n * - timeDuration is not valid for process-level start events\n */\nexport default class TimerTemplateBehavior extends CommandInterceptor {\n  constructor(eventBus, elementTemplates) {\n    super(eventBus);\n\n    this._elementTemplates = elementTemplates;\n\n    // Handle property changes - only react to cancelActivity/isInterrupting changes\n    this.postExecuted([\n      'element.updateProperties',\n      'element.updateModdleProperties'\n    ], this._handlePropertiesChange, true, this);\n\n    // Handle shape move - element may have moved to a different context\n    this.postExecuted('shape.move', context => {\n      const element = context.shape;\n      this._unlinkIfInvalidTimerTemplate(element);\n    }, true);\n\n    // Handle copy-paste: unlink templates that become invalid in the new context\n    this.postExecuted('elements.create', context => {\n      if (context.elements) {\n        context.elements.forEach(el => this._unlinkIfInvalidTimerTemplate(el));\n      }\n    }, true);\n  }\n\n  _handlePropertiesChange(context) {\n    const { element, properties } = context;\n\n    const isRelevantPropertyChange = (\n      properties && ('cancelActivity' in properties || 'isInterrupting' in properties)\n    );\n\n    if (!isRelevantPropertyChange) {\n      return;\n    }\n\n    this._unlinkIfInvalidTimerTemplate(element);\n  }\n\n  _unlinkIfInvalidTimerTemplate(element) {\n    if (!is(element, 'bpmn:Event')) {\n      return;\n    }\n\n    const timerEventDefinition = findTimerEventDefinition(element);\n\n    if (!timerEventDefinition) {\n      return;\n    }\n\n    const elementTemplates = this._elementTemplates;\n    const template = elementTemplates.get(element);\n\n    if (!template) {\n      return;\n    }\n\n    const timerBinding = template.properties.find(property => {\n      return property.binding?.type === TIMER_EVENT_DEFINITION_PROPERTY_TYPE;\n    });\n\n    if (!timerBinding) {\n      return;\n    }\n\n    const timerType = timerBinding.binding.name;\n\n    if (!isTimerExpressionTypeSupported(timerType, element)) {\n      elementTemplates.unlinkTemplate(element);\n    }\n  }\n}\n\nTimerTemplateBehavior.$inject = [\n  'eventBus',\n  'elementTemplates'\n];\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { isObject } from 'min-dash';\nimport { applyConditions } from '../Condition';\nimport { findExtension } from '../Helper';\nimport { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * Restores the original order of the template properties\n * on the moddle element.\n */\nexport default class UpdateTemplatePropertiesOrder extends CommandInterceptor {\n  constructor(eventBus, elementTemplates, commandStack, bpmnFactory) {\n    super(eventBus);\n\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._commandStack = commandStack;\n    this._bpmnFactory = bpmnFactory;\n\n    this.postExecute([\n      'element.updateProperties', 'element.updateModdleProperties'\n    ], this._updatePropertiesOrder, true, this);\n  }\n\n  _updatePropertiesOrder(context) {\n    const {\n      element\n    } = context;\n\n    const template = this._elementTemplates.get(element);\n    const businessObject = getBusinessObject(element);\n    const commands = [];\n\n    if (!template) {\n      return;\n    }\n\n    const templateProperties = applyConditions(element, template).properties;\n\n    // zeebe:Property\n    const zeebeProperties = findExtension(businessObject, 'zeebe:Properties');\n\n    if (zeebeProperties) {\n      this._updateZeebePropertiesOrder(zeebeProperties, templateProperties, commands, context);\n    }\n\n    // zeebe:IoMapping\n    const ioMapping = findExtension(businessObject, 'zeebe:IoMapping');\n\n    if (ioMapping) {\n\n      // zeebe:Input\n      this._updateInputOrder(ioMapping, templateProperties, commands, context);\n\n      // zeebe:Output\n      this._updateOutputOrder(ioMapping, templateProperties, commands, context);\n    }\n\n    // zeebe:TaskHeaders\n    const taskHeaders = findExtension(businessObject, 'zeebe:TaskHeaders');\n\n    if (taskHeaders) {\n      this._updateTaskHeadersOrder(taskHeaders, templateProperties, commands, context);\n    }\n\n\n    if (commands.length) {\n      const commandsToExecute = commands.filter((command) => command !== null);\n\n      commandsToExecute.length && this._commandStack.execute(\n        'element-templates.multi-command-executor',\n        commandsToExecute\n      );\n\n      return;\n    }\n  }\n\n  _updateZeebePropertiesOrder(zeebeProperties, templateProperties, commands, context) {\n    const findIndex = (properties, propertyToFind) =>\n      properties.findIndex(prop =>\n        prop.binding.type == 'zeebe:property' && prop.binding.name === propertyToFind.get('name')\n      );\n\n    const properties = zeebeProperties.get('properties');\n\n    if (properties.length < 1)\n      return;\n\n    let newPropertiesOrder = [ ...properties ];\n\n    sortProperties(newPropertiesOrder, findIndex, templateProperties);\n\n    if (!arrayEquals(newPropertiesOrder, properties)) {\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: zeebeProperties,\n          properties: {\n            properties: newPropertiesOrder\n          }\n        }\n      });\n    }\n  }\n\n  _updateInputOrder(ioMapping, templateProperties, commands, context) {\n\n    const findIndex = (properties, propertyToFind) =>\n      properties.findIndex(prop =>\n        prop.binding.type == 'zeebe:input' && prop.binding.name === propertyToFind.get('target')\n      );\n\n    const inputParameters = ioMapping.get('inputParameters');\n\n    if (inputParameters.length < 1)\n      return;\n\n    let newInputOrder = [ ...inputParameters ];\n\n    sortProperties(newInputOrder, findIndex, templateProperties);\n\n    if (!arrayEquals(newInputOrder,inputParameters)) {\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { inputParameters: newInputOrder }\n        }\n      });\n    }\n  }\n\n  _updateOutputOrder(ioMapping, templateProperties, commands, context) {\n\n    const findIndex = (properties, propertyToFind) =>\n      properties.findIndex(prop =>\n        prop.binding.type == 'zeebe:output' && prop.binding.source === propertyToFind.get('source')\n      );\n\n    const outputParameters = ioMapping.get('outputParameters');\n\n    if (outputParameters.length < 1)\n      return;\n\n    let newOutputOrder = [ ...outputParameters ];\n\n    sortProperties(newOutputOrder, findIndex, templateProperties);\n\n    if (!arrayEquals(newOutputOrder, outputParameters)) {\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: ioMapping,\n          properties: { outputParameters: newOutputOrder }\n        }\n      });\n    }\n  }\n\n  _updateTaskHeadersOrder(taskHeaders, templateProperties, commands, context) {\n\n    const findIndex = (properties, propertyToFind) =>\n      properties.findIndex(prop =>\n        prop.binding.type == 'zeebe:taskHeader' && prop.binding.key === propertyToFind.get('key')\n      );\n\n    const headers = taskHeaders.get('zeebe:values');\n\n    if (headers.length < 1)\n      return;\n\n    let newHeadersOrder = [ ...headers ];\n\n    sortProperties(newHeadersOrder, findIndex, templateProperties);\n\n    if (!arrayEquals(newHeadersOrder, headers)) {\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          ...context,\n          moddleElement: taskHeaders,\n          properties: { values: newHeadersOrder }\n        }\n      });\n    }\n  }\n\n}\n\nUpdateTemplatePropertiesOrder.$inject = [\n  'eventBus',\n  'elementTemplates',\n  'commandStack',\n  'bpmnFactory'\n];\n\n\n// helpers\n\nfunction normalizeReplacer(key, value) {\n\n  if (isObject(value)) {\n    const keys = Object.keys(value).sort();\n\n    return keys.reduce((obj, key) => {\n      obj[key] = value[key];\n\n      return obj;\n    }, {});\n  }\n\n  return value;\n}\n\nfunction objectEquals(a, b) {\n  return JSON.stringify(a, normalizeReplacer) === JSON.stringify(b, normalizeReplacer);\n}\n\nfunction arrayEquals(a, b) {\n  return a.every((element, idx) => objectEquals(element, b[idx]));\n}\n\nfunction sortProperties(array, findIndex, templateProperties) {\n  return array.sort((a, b) => {\n    const aIndex = findIndex(templateProperties, a);\n    const bIndex = findIndex(templateProperties, b);\n\n    return aIndex - bIndex;\n  });\n}","import { getBusinessObject, is, isAny } from 'bpmn-js/lib/util/ModelUtil';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\nimport { isString } from 'min-dash';\n\nimport { findMessage, findSignal, getTemplateId, TEMPLATE_ID_ATTR } from '../Helper';\nimport {\n  getReferringElement,\n  removeRootElement\n} from '../util/rootElementUtil';\n\n/**\n * Handles referenced elements.\n */\nexport class ReferencedElementBehavior extends CommandInterceptor {\n  constructor(eventBus, elementTemplates, modeling, injector, moddleCopy, bpmnFactory) {\n    super(eventBus);\n\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._modeling = modeling;\n    this._injector = injector;\n\n    this.postExecuted([\n      'element.updateProperties', 'element.updateModdleProperties'\n    ], this._handlePropertiesUpdate, true, this);\n\n    this.postExecuted('shape.replace', this._handleReplacement, true, this);\n\n    this.postExecuted('shape.delete', this._handleRemoval, true, this);\n\n\n    // copy templated root element when pasting\n    eventBus.on('copyPaste.pasteElement', function(context) {\n      const {\n        referencedRootElement\n      } = context.descriptor;\n\n      if (!referencedRootElement) {\n        return;\n      }\n\n      if (!getTemplateId(referencedRootElement)) {\n        return;\n      }\n\n      context.descriptor.referencedRootElement = moddleCopy.copyElement(\n        referencedRootElement,\n        bpmnFactory.create(referencedRootElement.$type)\n      );\n    });\n  }\n\n  /**\n   * Unlink referenced element when template is unlinked.\n   */\n  _handlePropertiesUpdate(context) {\n    const { element, properties } = context;\n\n    if (!canHaveReferencedElement(element)) {\n      return;\n    }\n\n    if (!(TEMPLATE_ID_ATTR in properties) || isString(properties[TEMPLATE_ID_ATTR])) {\n      return;\n    }\n\n    const bo = getBusinessObject(element);\n    const referencedElement = findMessage(bo) || findSignal(bo);\n\n    if (referencedElement && getTemplateId(referencedElement)) {\n      this._modeling.updateModdleProperties(element, referencedElement, {\n        [TEMPLATE_ID_ATTR]: null\n      });\n    }\n  }\n\n  /**\n   * Remove referenced element when template is removed.\n   * Keep referenced element when template is replaced.\n   */\n  _handleReplacement(context) {\n    const { oldShape, newShape } = context;\n    const oldTemplate = getTemplateId(oldShape),\n          newTemplate = getTemplateId(newShape);\n\n    if (!canHaveReferencedElement(oldShape) || !oldTemplate) {\n      return;\n    }\n\n    const bo = getBusinessObject(oldShape);\n    const message = findMessage(bo);\n    const signal = findSignal(bo);\n\n    if (message && getTemplateId(message)) {\n      if (!newTemplate || !canHaveMessage(newShape)) {\n        removeRootElement(message, this._injector);\n      } else {\n        this._addMessage(newShape, message);\n      }\n    }\n\n    if (signal && getTemplateId(signal)) {\n      if (!newTemplate || !canHaveSignal(newShape)) {\n        removeRootElement(signal, this._injector);\n      } else {\n        this._addSignal(newShape, signal);\n      }\n    }\n  }\n\n  _handleRemoval(context) {\n    const { shape } = context;\n\n    if (isLabel(shape)) {\n      return;\n    }\n\n    if (!canHaveReferencedElement(shape)) {\n      return;\n    }\n\n    if (!getTemplateId(shape)) {\n      return;\n    }\n\n    const bo = getBusinessObject(shape);\n    const referencedElement = findMessage(bo) || findSignal(bo);\n\n    if (referencedElement && getTemplateId(referencedElement)) {\n      removeRootElement(referencedElement, this._injector);\n    }\n  }\n\n  _addMessage(element, message) {\n    const bo = getReferringElement(element);\n\n    this._modeling.updateModdleProperties(element, bo, {\n      'messageRef': message\n    });\n  }\n\n  _addSignal(element, signal) {\n    const bo = getReferringElement(element);\n\n    this._modeling.updateModdleProperties(element, bo, {\n      'signalRef': signal\n    });\n  }\n}\n\nReferencedElementBehavior.$inject = [\n  'eventBus',\n  'elementTemplates',\n  'modeling',\n  'injector',\n  'moddleCopy',\n  'bpmnFactory'\n];\n\nfunction canHaveReferencedElement(element) {\n\n  // Blank-Events can't have referenced elements\n  if (is(element, 'bpmn:Event')) {\n    const bo = getBusinessObject(element);\n    return bo.get('eventDefinitions') && bo.get('eventDefinitions')[0];\n  }\n\n  return isAny(element, [\n    'bpmn:ReceiveTask',\n    'bpmn:SendTask'\n  ]);\n}\n\nfunction canHaveMessage(element) {\n  if (is(element, 'bpmn:ReceiveTask') || is(element, 'bpmn:SendTask')) {\n    return true;\n  }\n\n  if (is(element, 'bpmn:Event')) {\n    const bo = getBusinessObject(element);\n    const eventDefinitions = bo.get('eventDefinitions');\n\n    if (!eventDefinitions || !eventDefinitions.length) {\n      return false;\n    }\n\n    return is(eventDefinitions[0], 'bpmn:MessageEventDefinition');\n  }\n\n  return false;\n}\n\nfunction canHaveSignal(element) {\n  if (is(element, 'bpmn:Event')) {\n    const bo = getBusinessObject(element);\n    const eventDefinitions = bo.get('eventDefinitions');\n\n    if (!eventDefinitions || !eventDefinitions.length) {\n      return false;\n    }\n\n    return is(eventDefinitions[0], 'bpmn:SignalEventDefinition');\n  }\n\n  return false;\n}\n\nfunction isLabel(element) {\n  return element.type === 'label';\n}\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getDefaultValue } from '../Helper';\nimport { getPropertyValue, setPropertyValue } from '../util/propertyUtil';\n\n/**\n * Handles generated value properties.\n */\nexport class GeneratedValueBehavior extends CommandInterceptor {\n  constructor(eventBus, elementTemplates, modeling, commandStack, bpmnFactory) {\n    super(eventBus);\n\n    this._eventBus = eventBus;\n    this._elementTemplates = elementTemplates;\n    this._modeling = modeling;\n\n    this.preExecute('shape.create', context => {\n      const element = context.shape;\n      const template = elementTemplates.get(element);\n\n      if (!template) {\n        return;\n      }\n\n      const generatedProps = template.properties.filter(p => p.generatedValue);\n\n      generatedProps.forEach(p => {\n        if (!getPropertyValue(element, p)) {\n          return;\n        }\n\n        const value = getDefaultValue(p);\n\n        setPropertyValue(bpmnFactory, commandStack, element, p, value);\n      });\n    }, true);\n  }\n}\n\nGeneratedValueBehavior.$inject = [\n  'eventBus',\n  'elementTemplates',\n  'modeling',\n  'commandStack',\n  'bpmnFactory'\n];\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { findExtension } from '../Helper';\n\n/**\n * Enforces no variable propagation for templated call activities.\n */\nexport class CalledElementBehavior extends CommandInterceptor {\n\n  /**\n   * @param {*} eventBus\n   * @param {*} modeling\n   * @param {import('../ElementTemplates').default} elementTemplates\n   */\n  constructor(eventBus, modeling, elementTemplates) {\n    super(eventBus);\n\n    this._modeling = modeling;\n    this._elementTemplates = elementTemplates;\n\n    this.postExecuted([\n      'element.updateProperties', 'element.updateModdleProperties'\n    ], this._ensureNoPropagation, true, this);\n  }\n\n  _ensureNoPropagation(context) {\n    const { element } = context;\n\n    if (!this._elementTemplates.get(element)) {\n      return;\n    }\n\n    if (!is(element, 'bpmn:CallActivity')) {\n      return;\n    }\n\n    const calledElement = findExtension(element, 'zeebe:CalledElement');\n\n    if (!calledElement) {\n      return;\n    }\n\n    for (const property of [\n      'propagateAllChildVariables',\n      'propagateAllParentVariables'\n    ]) {\n      if (calledElement.get(property) !== false) {\n        this._modeling.updateModdleProperties(element, calledElement, {\n          [property]: false\n        });\n      }\n    }\n  }\n}\n\nCalledElementBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'elementTemplates'\n];\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { assign } from 'min-dash';\n\n/**\n * Disable the default Camunda behavior for a newly created element\n * if it is a templated `<bpmn:UserTask>`.\n */\nexport default class UserTaskBehavior extends CommandInterceptor {\n  constructor(eventBus, elementTemplates) {\n    super(eventBus);\n\n    this.preExecute('shape.create', function(event) {\n      const {\n        context: {\n          shape,\n          hints = {},\n        }\n      } = event;\n\n      if (is(shape, 'bpmn:UserTask') && elementTemplates.get(shape)) {\n        assign(hints, {\n          createElementsBehavior: false\n        });\n      }\n    });\n  }\n}\n\nUserTaskBehavior.$inject = [\n  'eventBus',\n  'elementTemplates'\n];\n","import ConditionalBehavior from './ConditionalBehavior';\nimport ReplaceBehavior from './ReplaceBehavior';\nimport TimerTemplateBehavior from './TimerTemplateBehavior';\nimport UpdatePropertiesOrderBehavior from './UpdatePropertiesOrderBehavior';\nimport { ReferencedElementBehavior } from './ReferencedElementBehavior';\nimport { GeneratedValueBehavior } from './GeneratedValueBehavior';\nimport { CalledElementBehavior } from './CalledElementBehavior';\nimport UserTaskBehavior from './UserTaskBehavior';\n\nexport default {\n  __init__: [\n    'elementTemplatesReplaceBehavior',\n    'elementTemplatesConditionalBehavior',\n    'elementTemplatesGeneratedValueBehavior',\n    'elementTemplatesReferencedElementBehavior',\n    'elementTemplatesUpdatePropertiesOrderBehavior',\n    'elementTemplatesCalledElementBehavior',\n    'elementTemplatesUserTaskBehavior',\n    'elementTemplatesTimerTemplateBehavior'\n  ],\n  elementTemplatesReplaceBehavior: [ 'type', ReplaceBehavior ],\n  elementTemplatesConditionalBehavior: [ 'type', ConditionalBehavior ],\n  elementTemplatesGeneratedValueBehavior: [ 'type', GeneratedValueBehavior ],\n  elementTemplatesReferencedElementBehavior: [ 'type', ReferencedElementBehavior ],\n  elementTemplatesUpdatePropertiesOrderBehavior: [ 'type', UpdatePropertiesOrderBehavior ],\n  elementTemplatesCalledElementBehavior: [ 'type', CalledElementBehavior ],\n  elementTemplatesUserTaskBehavior: [ 'type', UserTaskBehavior ],\n  elementTemplatesTimerTemplateBehavior: [ 'type', TimerTemplateBehavior ]\n};\n","import ElementTemplates from '../ElementTemplates';\nimport ElementTemplatesLoader from '../ElementTemplatesLoader';\n\nimport commandsModule from '../cmd';\nimport createModule from '../create';\nimport behaviorModule from '../behavior';\n\nexport default {\n  __depends__: [\n    commandsModule,\n    behaviorModule,\n    createModule\n  ],\n  __init__: [\n    'elementTemplatesLoader'\n  ],\n  elementTemplates: [ 'type', ElementTemplates ],\n  elementTemplatesLoader: [ 'type', ElementTemplatesLoader ]\n};\n","import { isUndefined } from 'min-dash';\n\nexport function getVersionOrDateFromTemplate(template) {\n  const metadata = template.metadata,\n        version = template.version;\n\n  if (metadata) {\n    if (!isUndefined(metadata.created)) {\n      return toDateString(metadata.created);\n    } else if (!isUndefined(metadata.updated)) {\n      return toDateString(metadata.updated);\n    }\n  }\n\n  if (isUndefined(version)) {\n    return null;\n  }\n\n  return version;\n}\n\n\n// helper ///////////\n\n/**\n * Example: 01.01.1900 01:01\n *\n * @param {number} timestamp\n * @returns {string}\n */\nfunction toDateString(timestamp) {\n  const date = new Date(timestamp);\n\n  const year = date.getFullYear();\n\n  const month = withLeadingZeros(String(date.getMonth() + 1));\n\n  const day = withLeadingZeros(String(date.getDate()));\n\n  const hours = withLeadingZeros(String(date.getHours()));\n\n  const minutes = withLeadingZeros(String(date.getMinutes()));\n\n  return day + '.' + month + '.' + year + ' ' + hours + ':' + minutes;\n}\n\nfunction withLeadingZeros(string) {\n  return leftPad(string, 2, '0');\n}\n\nfunction leftPad(string, length, character) {\n  while (string.length < length) {\n    string = character + string;\n  }\n\n  return string;\n}\n","import {\n  ArrowIcon,\n  CreateIcon,\n  DropdownButton,\n  HeaderButton,\n  useLayoutState\n} from '@bpmn-io/properties-panel';\n\nimport classnames from 'classnames';\n\nimport {\n  useService\n} from 'bpmn-js-properties-panel';\n\nimport {\n  getVersionOrDateFromTemplate\n} from '../utils/templateUtil';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\n\n/**\n * @typedef {NoTemplate|KnownTemplate|UnknownTemplate|OutdatedTemplate} TemplateState\n */\n\n/**\n * @typedef NoTemplate\n * @property {'NO_TEMPLATE'} type\n *\n * @typedef KnownTemplate\n * @property {'KNOWN_TEMPLATE'} type\n * @property {object} template\n *\n * @typedef UnknownTemplate\n * @property {'UNKNOWN_TEMPLATE'} type\n * @property {string} templateId\n *\n * @typedef OutdatedTemplate\n * @property {'OUTDATED_TEMPLATE'} type\n * @property {object} template\n * @property {object} newerTemplate\n */\n\n/**\n * Factory to create an element templates group.\n *\n * @param {object} [props]\n * @param {function} props.getTemplateId\n * @param {function} [props.unlinkTemplate]\n * @param {function} [props.updateTemplate]\n */\nexport function createElementTemplatesGroup(props = {}) {\n\n  const {\n    getTemplateId\n  } = props;\n\n  return function ElementTemplatesGroup(props) {\n    const {\n      id,\n      label,\n      element,\n      entries = []\n    } = props;\n\n    const [ open, setOpen ] = useLayoutState(\n      [ 'groups', id, 'open' ],\n      false\n    );\n\n    const empty = !entries.length;\n\n    const toggleOpen = () => !empty && setOpen(!open);\n\n    return <div class=\"bio-properties-panel-group bio-properties-panel-templates-group\" data-group-id={ 'group-' + id }>\n      <div class={ classnames(\n        'bio-properties-panel-group-header',\n        {\n          empty,\n          open: open && !empty\n        }\n      ) } onClick={ toggleOpen }\n      >\n        <div class=\"bio-properties-panel-group-header-title\">\n          { label }\n        </div>\n\n        <div class=\"bio-properties-panel-group-header-buttons\">\n          <TemplateGroupButtons\n            element={ element }\n            getTemplateId={ getTemplateId } />\n          { !empty && <SectionToggle open={ open } /> }\n        </div>\n      </div>\n\n      <div class={ classnames(\n        'bio-properties-panel-group-entries',\n        { open: open && !empty }\n      ) }>\n        {\n          entries.map(entry => {\n            const {\n              component: Component,\n              id\n            } = entry;\n\n            return (\n              <Component\n                { ...entry }\n                key={ id }\n                element={ element } />\n            );\n          })\n        }\n      </div>\n    </div>;\n  };\n\n}\n\nfunction SectionToggle({ open }) {\n  return <HeaderButton\n    title=\"Toggle section\"\n    class=\"bio-properties-panel-arrow\"\n  >\n    <ArrowIcon class={ open ? 'bio-properties-panel-arrow-down' : 'bio-properties-panel-arrow-right' } />\n  </HeaderButton>;\n}\n\n\n/**\n *\n * @param {object} props\n * @param {object} props.element\n * @param {function} props.getTemplateId\n * @param {function} props.unlinkTemplate\n * @param {function} props.updateTemplate\n */\nfunction TemplateGroupButtons({ element, getTemplateId }) {\n  const elementTemplates = useService('elementTemplates');\n\n  const templateState = getTemplateState(elementTemplates, element, getTemplateId);\n\n  if (templateState.type === 'NO_TEMPLATE') {\n    return <SelectEntryTemplate element={ element } />;\n  } else if (templateState.type === 'KNOWN_TEMPLATE') {\n    return <AppliedTemplate element={ element } />;\n  } else if (templateState.type === 'UNKNOWN_TEMPLATE') {\n    return <UnknownTemplate element={ element } />;\n  } else if (templateState.type === 'DEPRECATED_TEMPLATE') {\n    return <DeprecatedTemplate element={ element } templateState={ templateState } />;\n  } else if (templateState.type === 'INCOMPATIBLE_TEMPLATE') {\n    return <IncompatibleTemplate element={ element } />;\n  } else if (templateState.type === 'OUTDATED_TEMPLATE') {\n    return (\n      <OutdatedTemplate\n        element={ element }\n        templateState={ templateState } />\n    );\n  }\n}\n\nfunction SelectEntryTemplate({ element }) {\n  const translate = useService('translate');\n  const eventBus = useService('eventBus');\n\n  const selectTemplate = () => eventBus.fire('elementTemplates.select', { element });\n\n  return (\n    <HeaderButton\n      title=\"Select a template\"\n      class=\"bio-properties-panel-select-template-button\"\n      onClick={ selectTemplate }\n    >\n      <CreateIcon />\n      <span>{ translate('Select') }</span>\n    </HeaderButton>\n  );\n}\n\nfunction AppliedTemplate({ element }) {\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  return (\n    <DropdownButton menuItems={ menuItems } class=\"bio-properties-panel-applied-template-button\">\n      <HeaderButton>\n        <span>{ translate('Applied') }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction RemoveTemplate() {\n  const translate = useService('translate');\n\n  return <span class=\"bio-properties-panel-remove-template\">{ translate('Remove') }</span>;\n}\n\nfunction UnknownTemplate({ element }) {\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: <NotFoundText /> },\n    { separator: true },\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  return (\n    <DropdownButton menuItems={ menuItems } class=\"bio-properties-panel-template-not-found\">\n      <HeaderButton>\n        <span>{ translate('Not found') }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction NotFoundText() {\n  const translate = useService('translate');\n\n  return (\n    <div class=\"bio-properties-panel-template-not-found-text\">\n      { translate(\n        'The template applied was not found. Therefore, its properties cannot be shown. Unlink to access the data.'\n      ) }\n    </div>\n  );\n}\n\n/**\n *\n * @param {object} props\n * @param {object} element\n * @param {UnknownTemplate} templateState\n * @param {function} unlinkTemplate\n * @param {function} updateTemplate\n */\nfunction OutdatedTemplate({ element, templateState }) {\n  const { newerTemplate, compatible } = templateState;\n\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: <UpdateAvailableText newerTemplate={ newerTemplate } compatible={ compatible } /> },\n    { separator: true },\n    { entry: translate('Update'), action: () => elementTemplates.applyTemplate(element, newerTemplate) },\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  const cls = compatible\n    ? 'bio-properties-panel-template-update-available'\n    : 'bio-properties-panel-template-incompatible';\n\n  const text = compatible\n    ? translate('Update available')\n    : translate('Incompatible');\n\n  return (\n    <DropdownButton menuItems={ menuItems } class={ cls }>\n      <HeaderButton>\n        <span>{ text }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction UpdateAvailableText({ newerTemplate, compatible }) {\n  const translate = useService('translate');\n\n  const text = compatible\n    ? translate(\n      'A new version of the template is available: {templateVersion}',\n      { templateVersion: getVersionOrDateFromTemplate(newerTemplate) }\n    )\n    : translate(\n      'A version of this template is available that supports your environment: {templateVersion}',\n      { templateVersion: getVersionOrDateFromTemplate(newerTemplate) }\n    );\n\n  return <div class=\"bio-properties-panel-template-update-available-text\">{text}</div>;\n}\n\nfunction DeprecatedTemplate({ element, templateState }) {\n  const { template } = templateState;\n\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: <DeprecationWarning template={ template } /> },\n    { separator: true },\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  return (\n    <DropdownButton menuItems={ menuItems } class=\"bio-properties-panel-deprecated-template-button\">\n      <HeaderButton>\n        <span>{ translate('Deprecated') }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction DeprecationWarning({ template }) {\n  const translate = useService('translate');\n\n  const {\n    message = translate('This template is deprecated.'),\n    documentationRef\n  } = template.deprecated;\n\n  return <div class=\"bio-properties-panel-deprecated-template-text\">\n    {message}\n    {documentationRef && <>&nbsp;<a href={ documentationRef }><DocumentationIcon /></a></>}\n  </div>;\n}\n\nfunction DocumentationIcon() {\n  return <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z\" fill=\"#818798\" />\n  </svg>;\n}\n\nfunction IncompatibleTemplate({ element }) {\n  const translate = useService('translate'),\n        elementTemplates = useService('elementTemplates');\n\n  const menuItems = [\n    { entry: <IncompatibleText /> },\n    { separator: true },\n    { entry: translate('Unlink'), action: () => elementTemplates.unlinkTemplate(element) },\n    { entry: <RemoveTemplate />, action: () => elementTemplates.removeTemplate(element) }\n  ];\n\n  return (\n    <DropdownButton menuItems={ menuItems } class=\"bio-properties-panel-template-incompatible\">\n      <HeaderButton>\n        <span>{ translate('Incompatible') }</span>\n        <ArrowIcon class=\"bio-properties-panel-arrow-down\" />\n      </HeaderButton>\n    </DropdownButton>\n  );\n}\n\nfunction IncompatibleText() {\n  const translate = useService('translate');\n\n  return (\n    <div class=\"bio-properties-panel-template-incompatible-text\">\n      { translate(\n        'No compatible version of this template was found for your environment. Unlink to access the templates data.'\n      ) }\n    </div>\n  );\n}\n\n\n// helper //////\n\n/**\n * Determine template state in the current element.\n *\n * @param {object} elementTemplates\n * @param {object} element\n * @param {function} getTemplateId\n * @returns {TemplateState}\n */\nfunction getTemplateState(elementTemplates, element, getTemplateId) {\n  const templateId = getTemplateId(element),\n        template = elementTemplates.get(element);\n\n  if (!templateId) {\n    return { type: 'NO_TEMPLATE' };\n  }\n\n  if (!template) {\n    return { type: 'UNKNOWN_TEMPLATE', templateId };\n  }\n\n  if (template.deprecated) {\n    return { type: 'DEPRECATED_TEMPLATE', template };\n  }\n\n  const compatible = elementTemplates.isCompatible(template);\n\n  const latestTemplate = elementTemplates.getLatest(templateId, { deprecated: true })[0];\n\n  if (latestTemplate && latestTemplate !== template) {\n    return { type: 'OUTDATED_TEMPLATE', template, newerTemplate: latestTemplate, compatible };\n  }\n\n  if (!compatible) {\n    return { type: 'INCOMPATIBLE_TEMPLATE', template };\n  }\n\n  return { type: 'KNOWN_TEMPLATE', template };\n}\n","import { useService } from 'bpmn-js-properties-panel';\n\nimport { getVersionOrDateFromTemplate } from '../utils/templateUtil';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\nexport function TemplateProps({\n  element,\n  elementTemplates,\n  getTemplateId,\n  getTemplateVersion\n}) {\n\n  const localTemplate = elementTemplates.get(element);\n\n  const template = localTemplate || {\n    id: getTemplateId(element),\n    version: getTemplateVersion(element)\n  };\n\n  // no template configured\n  if (!template.id) {\n    return [];\n  }\n\n  return [\n    !localTemplate && {\n      id: 'template-id',\n      component: TemplateId,\n      template\n    },\n    {\n      id: 'template-name',\n      component: TemplateName,\n      template\n    },\n    {\n      id: 'template-version',\n      component: TemplateVersion,\n      template\n    },\n    {\n      id: 'template-description',\n      component: TemplateDescription,\n      template\n    }\n  ];\n}\n\nfunction TemplateName({ id, template }) {\n  const translate = useService('translate');\n\n  const { name } = template;\n\n  return name\n    ? <TextEntry id={ id } label={ translate('Name') } content={ name } />\n    : null;\n}\n\nfunction TemplateId({ id, template }) {\n  const translate = useService('translate');\n\n  return <TextEntry id={ id } label={ translate('ID') } content={ template.id } />;\n}\n\nfunction TemplateVersion({ id, template }) {\n  const translate = useService('translate');\n\n  const version = getVersionOrDateFromTemplate(template);\n\n  return version\n    ? <TextEntry id={ id } label={ translate('Version') } content={ version } />\n    : null;\n}\n\nfunction TemplateDescription({ id, template }) {\n  const translate = useService('translate');\n\n  const { description } = template;\n\n  return description ?\n    <TextEntry id={ id } label={ translate('Description') } content={ template.description } /> :\n    null;\n}\n\nfunction TextEntry({ id, label, content }) {\n  return <div data-entry-id={ id } class=\"bio-properties-panel-entry bio-properties-panel-text-entry\">\n    <span class=\"bio-properties-panel-label\">{ label }</span>\n    <span class=\"bio-properties-panel-text-entry__content\">{ content }</span>\n  </div>;\n}\n","import{h as r,Component as t}from\"preact\";var e,o={};function n(r,t,e){if(3===r.nodeType){var o=\"textContent\"in r?r.textContent:r.nodeValue||\"\";if(!1!==n.options.trim){var a=0===t||t===e.length-1;if((!(o=o.match(/^[\\s\\n]+$/g)&&\"all\"!==n.options.trim?\" \":o.replace(/(^[\\s\\n]+|[\\s\\n]+$)/g,\"all\"===n.options.trim||a?\"\":\" \"))||\" \"===o)&&e.length>1&&a)return null}return o}if(1!==r.nodeType)return null;var p=String(r.nodeName).toLowerCase();if(\"script\"===p&&!n.options.allowScripts)return null;var l,s,u=n.h(p,function(r){var t=r&&r.length;if(!t)return null;for(var e={},o=0;o<t;o++){var a=r[o],i=a.name,p=a.value;\"on\"===i.substring(0,2)&&n.options.allowEvents&&(p=new Function(p)),e[i]=p}return e}(r.attributes),(s=(l=r.childNodes)&&Array.prototype.map.call(l,n).filter(i))&&s.length?s:null);return n.visitor&&n.visitor(u),u}var a,i=function(r){return r},p={};function l(r){var t=(r.type||\"\").toLowerCase(),e=l.map;e&&e.hasOwnProperty(t)?(r.type=e[t],r.props=Object.keys(r.props||{}).reduce(function(t,e){var o;return t[(o=e,o.replace(/-(.)/g,function(r,t){return t.toUpperCase()}))]=r.props[e],t},{})):r.type=t.replace(/[^a-z0-9-]/i,\"\")}export default(function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.setReviver=function(r){a=r},i.prototype.shouldComponentUpdate=function(r){var t=this.props;return r.wrap!==t.wrap||r.type!==t.type||r.markup!==t.markup},i.prototype.setComponents=function(r){if(this.map={},r)for(var t in r)if(r.hasOwnProperty(t)){var e=t.replace(/([A-Z]+)([A-Z][a-z0-9])|([a-z0-9]+)([A-Z])/g,\"$1$3-$2$4\").toLowerCase();this.map[e]=r[t]}},i.prototype.render=function(t){var i=t.wrap;void 0===i&&(i=!0);var s,u=t.type,c=t.markup,m=t.components,v=t.reviver,f=t.onError,d=t[\"allow-scripts\"],h=t[\"allow-events\"],y=t.trim,w=function(r,t){var e={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&-1===t.indexOf(o)&&(e[o]=r[o]);return e}(t,[\"wrap\",\"type\",\"markup\",\"components\",\"reviver\",\"onError\",\"allow-scripts\",\"allow-events\",\"trim\"]),C=v||this.reviver||this.constructor.prototype.reviver||a||r;this.setComponents(m);var g={allowScripts:d,allowEvents:h,trim:y};try{s=function(r,t,a,i,s){var u=function(r,t){var o,n,a,i,p=\"html\"===t?\"text/html\":\"application/xml\";\"html\"===t?(i=\"body\",a=\"<!DOCTYPE html>\\n<html><body>\"+r+\"</body></html>\"):(i=\"xml\",a='<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n<xml>'+r+\"</xml>\");try{o=(new DOMParser).parseFromString(a,p)}catch(r){n=r}if(o||\"html\"!==t||((o=e||(e=function(){if(document.implementation&&document.implementation.createHTMLDocument)return document.implementation.createHTMLDocument(\"\");var r=document.createElement(\"iframe\");return r.style.cssText=\"position:absolute; left:0; top:-999em; width:1px; height:1px; overflow:hidden;\",r.setAttribute(\"sandbox\",\"allow-forms\"),document.body.appendChild(r),r.contentWindow.document}())).open(),o.write(a),o.close()),o){var l=o.getElementsByTagName(i)[0],s=l.firstChild;return r&&!s&&(l.error=\"Document parse failed.\"),s&&\"parsererror\"===String(s.nodeName).toLowerCase()&&(s.removeChild(s.firstChild),s.removeChild(s.lastChild),l.error=s.textContent||s.nodeValue||n||\"Unknown error\",l.removeChild(s)),l}}(r,t);if(u&&u.error)throw new Error(u.error);var c=u&&u.body||u;l.map=i||p;var m=c&&function(r,t,e,a){return n.visitor=t,n.h=e,n.options=a||o,n(r)}(c,l,a,s);return l.map=null,m&&m.props&&m.props.children||null}(c,u,C,this.map,g)}catch(r){f?f({error:r}):\"undefined\"!=typeof console&&console.error&&console.error(\"preact-markup: \"+r)}if(!1===i)return s||null;var x=w.hasOwnProperty(\"className\")?\"className\":\"class\",b=w[x];return b?b.splice?b.splice(0,0,\"markup\"):\"string\"==typeof b?w[x]+=\" markup\":\"object\"==typeof b&&(b.markup=!0):w[x]=\"markup\",C(\"div\",w,s||null)},i}(t));\n//# sourceMappingURL=preact-markup.module.js.map\n","/**\n * Copied from existing form-js#Sanitizer\n * cf. https://github.com/bpmn-io/form-js/blob/master/packages/form-js-viewer/src/render/components/Sanitizer.js\n */\n\nconst NODE_TYPE_TEXT = 3,\n      NODE_TYPE_ELEMENT = 1;\n\nconst ALLOWED_NODES = [\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'span',\n  'em',\n  'a',\n  'p',\n  'div',\n  'ul',\n  'ol',\n  'li',\n  'hr',\n  'blockquote',\n  'img',\n  'pre',\n  'code',\n  'br',\n  'strong'\n];\n\nconst ALLOWED_ATTRIBUTES = [\n  'align',\n  'alt',\n  'class',\n  'href',\n  'id',\n  'name',\n  'rel',\n  'target',\n  'src'\n];\n\nconst ALLOWED_URI_PATTERN = /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i; // eslint-disable-line no-useless-escape\nconst ATTR_WHITESPACE_PATTERN = /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g; // eslint-disable-line no-control-regex\n\nconst FORM_ELEMENT = document.createElement('form');\n\n/**\n * Sanitize a HTML string and return the cleaned, safe version.\n *\n * @param {string} html\n * @return {string}\n */\nexport function sanitizeHTML(html) {\n\n  const doc = new DOMParser().parseFromString(\n    `<!DOCTYPE html>\\n<html><body><div>${ html }`,\n    'text/html'\n  );\n\n  doc.normalize();\n\n  const element = doc.body.firstChild;\n\n  if (element) {\n    sanitizeNode(/** @type Element */ (element));\n\n    return new XMLSerializer().serializeToString(element);\n  } else {\n\n    // handle the case that document parsing\n    // does not work at all, due to HTML gibberish\n    return '';\n  }\n}\n\n/**\n * Recursively sanitize a HTML node, potentially\n * removing it, its children or attributes.\n *\n * Inspired by https://github.com/developit/snarkdown/issues/70\n * and https://github.com/cure53/DOMPurify. Simplified\n * for our use-case.\n *\n * @param {Element} node\n */\nfunction sanitizeNode(node) {\n\n  // allow text nodes\n  if (node.nodeType === NODE_TYPE_TEXT) {\n    return;\n  }\n\n  // disallow all other nodes but Element\n  if (node.nodeType !== NODE_TYPE_ELEMENT) {\n    return node.remove();\n  }\n\n  const lcTag = node.tagName.toLowerCase();\n\n  // disallow non-whitelisted tags\n  if (!ALLOWED_NODES.includes(lcTag)) {\n    return node.remove();\n  }\n\n  const attributes = node.attributes;\n\n  // clean attributes\n  for (let i = attributes.length; i--;) {\n    const attribute = attributes[i];\n\n    const name = attribute.name;\n    const lcName = name.toLowerCase();\n\n    // normalize node value\n    const value = attribute.value.trim();\n\n    node.removeAttribute(name);\n\n    const valid = isValidAttribute(lcTag, lcName, value);\n\n    if (valid) {\n      node.setAttribute(name, value);\n    }\n\n  }\n\n  // force noopener on target=\"_blank\" links\n  if (lcTag === 'a' && node.getAttribute('target') === '_blank' && node.getAttribute('rel') !== 'noopener') {\n    node.setAttribute('rel', 'noopener');\n  }\n\n  for (let i = node.childNodes.length; i--;) {\n    sanitizeNode(/** @type Element */ (node.childNodes[i]));\n  }\n}\n\n\n/**\n * Validates attributes for validity.\n *\n * @param {string} lcTag\n * @param {string} lcName\n * @param {string} value\n * @return {boolean}\n */\nfunction isValidAttribute(lcTag, lcName, value) {\n\n  // disallow most attributes based on whitelist\n  if (!ALLOWED_ATTRIBUTES.includes(lcName)) {\n    return false;\n  }\n\n  // disallow \"DOM clobbering\" / polution of document and wrapping form elements\n  if ((lcName === 'id' || lcName === 'name') && (value in document || value in FORM_ELEMENT)) {\n    return false;\n  }\n\n  if (lcName === 'target' && value !== '_blank') {\n    return false;\n  }\n\n  // allow valid url links only\n  if (lcName === 'href' && !ALLOWED_URI_PATTERN.test(value.replace(ATTR_WHITESPACE_PATTERN, ''))) {\n    return false;\n  }\n\n  return true;\n}","import Markup from 'preact-markup';\n\nimport { sanitizeHTML } from '../../../utils/sanitize';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\nexport function PropertyTooltip(props) {\n\n  const {\n    tooltip\n  } = props;\n\n  return tooltip && (\n    <Markup\n      markup={ sanitizeHTML(tooltip) }\n      trim={ false } />\n  );\n}","import { find, groupBy } from 'min-dash';\nimport { getPropertyValue, setPropertyValue, validateProperty } from '../../../util/propertyUtil';\nimport { shouldCastToFeel, toFeelExpression } from '../../../util/FeelUtil';\n\nimport { useCallback, useState } from '@bpmn-io/properties-panel/preact/hooks';\n\nexport function usePropertyAccessors(bpmnFactory, commandStack, element, property) {\n  const directSet = useCallback(propertySetter(bpmnFactory, commandStack, element, property), [ bpmnFactory, commandStack, element, property ]);\n  const directGet = useCallback(propertyGetter(element, property), [ element, property ]);\n\n  const [ isFeelEnabled, setIsFeelEnabled ] = useState(feelEnabled(property, directGet()));\n\n  const handleFeelToggle = useCallback((value) => {\n    if (!isFeelEnabled && typeof value === 'string' && value.startsWith('=')) {\n      setIsFeelEnabled(true);\n    }\n\n    if (isFeelEnabled && (typeof value !== 'string' || !value.startsWith('='))) {\n      setIsFeelEnabled(false);\n    }\n  }, [ isFeelEnabled ]);\n\n  const set = useCallback((value, error) => {\n    handleFeelToggle(value);\n    directSet(toFeelExpression(value, property.type));\n  }, [ directSet, property, handleFeelToggle ]);\n\n  const get = useCallback(() => {\n    if (isFeelEnabled) {\n      return directGet();\n    }\n\n    return fromFeelExpression(directGet(), property.type);\n  }, [ directGet, property, isFeelEnabled ]);\n\n  if (!shouldCastToFeel(property)) {\n    return [ directGet, directSet ];\n  }\n\n  return [ get, set ];\n}\n\n\nconst fromFeelExpression = (value, type) => {\n  if (typeof value === 'undefined') {\n    return value;\n  }\n\n  if (typeof value === 'string' && value.startsWith('=')) {\n    value = value.slice(1);\n  }\n\n  if (type === 'Number') {\n    return Number(value);\n  }\n\n  if (type === 'Boolean') {\n    return value !== 'false';\n  }\n\n  return value;\n};\n\nconst feelEnabled = (property, value) => {\n  if (!shouldCastToFeel(property)) {\n    return true;\n  }\n\n  if (property.type === 'Boolean') {\n    return !(value === '=true' || value === '=false');\n  }\n\n  if (property.type === 'Number') {\n    return isNaN(fromFeelExpression(value, property.type));\n  }\n\n  return true;\n};\n\n\nexport function propertyGetter(element, property) {\n  return function getValue() {\n    return getPropertyValue(element, property);\n  };\n}\n\nexport function propertySetter(bpmnFactory, commandStack, element, property) {\n  return function setValue(value) {\n    return setPropertyValue(bpmnFactory, commandStack, element, property, value);\n  };\n}\n\nexport function propertyValidator(translate, property) {\n  return value => validateProperty(value, property, translate);\n}\n\nexport function groupByGroupId(properties) {\n  return groupBy(properties, 'group');\n}\n\nexport function findCustomGroup(groups, id) {\n  return find(groups, g => g.id === id);\n}\n\n/**\n * Is the given property executed by the engine?\n *\n * @param { { binding: { type: string } } } property\n * @return {boolean}\n */\nexport function isExternalProperty(property) {\n  return [ 'zeebe:property', 'zeebe:taskHeader' ].includes(property.binding.type);\n}\n","import Markup from 'preact-markup';\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport { sanitizeHTML } from '../utils/sanitize';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\nexport function PropertyDescription(props) {\n  const {\n    description\n  } = props;\n\n  const translate = useService('translate');\n\n  return description && (\n    <Markup\n      markup={ sanitizeHTML(translate(description)) }\n      trim={ false } />\n  );\n}","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { TextAreaEntry } from '@bpmn-io/properties-panel';\nimport {\n  propertyGetter,\n  propertySetter,\n  propertyValidator\n} from './util';\n\nexport function TextAreaProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    language,\n    placeholder,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  return TextAreaEntry({\n    debounce,\n    element,\n    id,\n    label,\n    feel,\n    placeholder,\n    monospace: !!language,\n    autoResize: true,\n    description: PropertyDescription({ description }),\n    getValue: propertyGetter(element, property),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { TextFieldEntry } from '@bpmn-io/properties-panel';\nimport { propertyGetter, propertySetter, propertyValidator } from './util';\n\nexport function StringProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    placeholder,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  return TextFieldEntry({\n    debounce,\n    element,\n    getValue: propertyGetter(element, property),\n    id,\n    label,\n    feel,\n    placeholder,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { getVariablesForElement } from '@bpmn-io/extract-process-variables/zeebe';\nimport { useEffect, useState } from '@bpmn-io/properties-panel/preact/hooks';\nimport { useService } from 'bpmn-js-properties-panel';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\nfunction useServiceIfAvailable(service, fallback) {\n  const resolved = useService(service, false);\n\n  if (!resolved) {\n    return fallback;\n  }\n\n  return resolved;\n}\n\nexport function withVariableContext(Component) {\n  return props => {\n    const { bpmnElement, element } = props;\n\n    const bo = (bpmnElement || element).businessObject;\n\n    const [ variables, setVariables ] = useState([]);\n    const eventBus = useService('eventBus');\n\n    const variableResolver = useServiceIfAvailable('variableResolver', { getVariablesForElement });\n\n    useEffect(() => {\n      const extractVariables = async () => {\n\n        const variables = await variableResolver.getVariablesForElement(bo);\n\n        setVariables(variables.map(variable => {\n          return {\n            ...variable,\n            info: variable.info ||\n                  (variable.origin && ('Written in ' + variable.origin.map(origin => origin.name || origin.id).join(', ')))\n          };\n        }));\n      };\n\n      // The callback must return undefined, so the event propagation is not canceled.\n      // Cf. https://github.com/camunda/camunda-modeler/issues/3392\n      const callback = () => {\n        extractVariables();\n      };\n\n      eventBus.on('commandStack.changed', callback);\n      callback();\n\n      return () => {\n        eventBus.off('commandStack.changed', callback);\n      };\n    }, [ bo ]);\n\n    return <Component { ...props } variables={ variables }></Component>;\n  };\n}","import { useMemo } from '@bpmn-io/properties-panel/preact/hooks';\nimport { useService } from 'bpmn-js-properties-panel';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\nexport function withTooltipContainer(Component) {\n  return props => {\n    const tooltipContainer = useMemo(() => {\n      const config = useService('config');\n\n      return config && config.propertiesPanel && config.propertiesPanel.feelTooltipContainer;\n    }, [ ]);\n\n    return <Component { ...props }\n      tooltipContainer={ tooltipContainer }\n    ></Component>;\n  };\n}","import { FeelEntry as BaseFeelEntry, FeelTextAreaEntry as BaseFeelTextAreaEntry } from '@bpmn-io/properties-panel';\nimport { withTooltipContainer, withVariableContext } from './HOCs';\n\nexport const FeelEntry = withTooltipContainer(BaseFeelEntry);\nexport const FeelTextAreaEntry = withTooltipContainer(BaseFeelTextAreaEntry);\n\nexport const FeelEntryWithVariableContext = withVariableContext(FeelEntry);\nexport const FeelTextAreaEntryWithVariableContext = withVariableContext(FeelTextAreaEntry);","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { FeelEntryWithVariableContext, FeelEntry } from '../../../../entries/FeelEntryWithContext';\nimport { propertyGetter, propertySetter, propertyValidator, isExternalProperty } from './util';\n\nexport function FeelProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    placeholder,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const TextFieldComponent = !isExternalProperty(property)\n    ? FeelEntryWithVariableContext\n    : FeelEntry;\n\n  return TextFieldComponent({\n    debounce,\n    element,\n    getValue: propertyGetter(element, property),\n    id,\n    label,\n    feel,\n    placeholder,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport {\n  FeelTextAreaEntryWithVariableContext,\n  FeelTextAreaEntry\n} from '../../../../entries/FeelEntryWithContext';\nimport { propertyGetter, propertySetter, propertyValidator, isExternalProperty } from './util';\n\nexport function FeelTextAreaProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    placeholder,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const TextAreaComponent = !isExternalProperty(property)\n    ? FeelTextAreaEntryWithVariableContext\n    : FeelTextAreaEntry;\n\n  return TextAreaComponent({\n    debounce,\n    element,\n    getValue: propertyGetter(element, property),\n    id,\n    label,\n    feel,\n    placeholder,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { SelectEntry } from '@bpmn-io/properties-panel';\nimport { propertyGetter, propertySetter, propertyValidator } from './util';\n\nexport function DropdownProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    tooltip\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        translate = useService('translate');\n\n  const getOptions = () => {\n    const { choices, optional } = property;\n    let dropdownOptions = [];\n\n    dropdownOptions = choices.map(({ name, value }) => {\n      return {\n        label: name,\n        value\n      };\n    });\n\n    if (optional) {\n      dropdownOptions = [ { label: '', value: undefined }, ...dropdownOptions ];\n    }\n\n    return dropdownOptions;\n  };\n\n  return SelectEntry({\n    element,\n    id,\n    label,\n    getOptions,\n    description: PropertyDescription({ description }),\n    getValue: propertyGetter(element, property),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { useService } from 'bpmn-js-properties-panel';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { CheckboxEntry, FeelCheckboxEntry } from '@bpmn-io/properties-panel';\nimport { usePropertyAccessors } from './util';\n\nexport function BooleanProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    tooltip,\n    feel\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const Component = feel === 'optional' ? FeelCheckboxEntry : CheckboxEntry;\n\n  const [ getValue, setValue ] = usePropertyAccessors(bpmnFactory, commandStack, element, property);\n\n  return Component({\n    element,\n    debounce,\n    translate,\n    getValue,\n    id,\n    label,\n    description: PropertyDescription({ description }),\n    setValue,\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { FeelNumberEntry, NumberFieldEntry } from '@bpmn-io/properties-panel';\nimport { useService } from 'bpmn-js-properties-panel';\nimport { propertyValidator, usePropertyAccessors } from './util';\nimport { shouldCastToFeel } from '../../../util/FeelUtil';\nimport { PropertyDescription } from '../../../../components/PropertyDescription';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\nimport { useCallback } from '@bpmn-io/properties-panel/preact/hooks';\nimport { isNumber } from 'min-dash';\n\nexport function NumberProperty(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    feel,\n    tooltip\n  } = property;\n\n  const Component = feel === 'optional' ? FeelNumberEntry : NumberFieldEntry;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const [ getValue, setValue ] = usePropertyAccessors(bpmnFactory, commandStack, element, property);\n\n  const validate = useCallback((value) => {\n    if (shouldCastToFeel(property) && isNumber(value) && value.toString().includes('e')) {\n      return translate('Scientific notation is disallowed in FEEL.');\n    }\n\n    const defaultValidator = propertyValidator(translate, property);\n    return defaultValidator(value);\n  }, [ translate, property ]);\n\n  return Component({\n    debounce,\n    element,\n    getValue,\n    step: 'any',\n    id,\n    label,\n    description: PropertyDescription({ description }),\n    setValue,\n    validate: validate,\n    disabled: editable === false,\n    tooltip: PropertyTooltip({ tooltip })\n  });\n}\n","import { forEach } from 'min-dash';\n\nimport { getDefaultValue } from '../../../Helper';\nimport { PropertyTooltip } from '../../components/PropertyTooltip';\n\nimport {\n  Group,\n  isSelectEntryEdited,\n  isCheckboxEntryEdited,\n  isTextAreaEntryEdited,\n  isTextFieldEntryEdited,\n  isFeelEntryEdited,\n  isNumberFieldEntryEdited\n} from '@bpmn-io/properties-panel';\n\nimport {\n  PROPERTY_TYPE,\n  ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n  ZEEBE_TASK_DEFINITION,\n  ZEBBE_INPUT_TYPE,\n  ZEEBE_OUTPUT_TYPE,\n  ZEEBE_PROPERTY_TYPE,\n  ZEEBE_TASK_HEADER_TYPE\n} from '../../../util/bindingTypes';\n\nimport { groupByGroupId, findCustomGroup } from './util';\nimport { getPropertyValue } from '../../../util/propertyUtil';\nimport { TextAreaProperty } from './TextAreaProperty';\nimport { StringProperty } from './StringProperty';\nimport { FeelProperty } from './FeelProperty';\nimport { FeelTextAreaProperty } from './FeelTextAreaProperty';\nimport { DropdownProperty } from './DropdownProperty';\nimport { BooleanProperty } from './BooleanProperty';\nimport { NumberProperty } from './NumberProperty';\n\n\nexport function CustomProperties(props) {\n  const {\n    element,\n    elementTemplate,\n    injector\n  } = props;\n\n  const translate = injector.get('translate');\n\n  const groups = [];\n\n  const {\n    id,\n    properties,\n    groups: propertyGroups\n  } = elementTemplate;\n\n  // (1) group properties by group id\n  const groupedProperties = groupByGroupId(properties);\n  const defaultProps = [];\n\n  forEach(groupedProperties, (properties, groupId) => {\n\n    const group = findCustomGroup(propertyGroups, groupId);\n\n    if (!group) {\n      return defaultProps.push(...properties);\n    }\n\n    addCustomGroup(groups, {\n      element,\n      id: `ElementTemplates__CustomProperties-${groupId}`,\n      label: translate(group.label),\n      openByDefault: group.openByDefault,\n      properties: properties,\n      templateId: `${id}-${groupId}`,\n      tooltip: PropertyTooltip({ tooltip: group.tooltip })\n    });\n  });\n\n  // (2) add default custom props\n  if (defaultProps.length) {\n    addCustomGroup(groups, {\n      id: 'ElementTemplates__CustomProperties',\n      label: translate('Custom properties'),\n      element,\n      properties: defaultProps,\n      templateId: id\n    });\n  }\n\n  return groups;\n}\n\nfunction addCustomGroup(groups, props) {\n\n  const {\n    element,\n    id,\n    label,\n    openByDefault = false,\n    properties,\n    templateId,\n    tooltip\n  } = props;\n\n  const customPropertiesGroup = {\n    id,\n    label,\n    component: Group,\n    entries: [],\n    shouldOpen: openByDefault,\n    tooltip\n  };\n\n  properties.forEach((property, index) => {\n    const entry = createCustomEntry(`custom-entry-${ templateId }-${ index }`, element, property);\n\n    if (entry) {\n      customPropertiesGroup.entries.push(entry);\n    }\n  });\n\n  if (customPropertiesGroup.entries.length) {\n    groups.push(customPropertiesGroup);\n  }\n}\n\nfunction createCustomEntry(id, element, property) {\n  let { type, feel } = property;\n\n  if (!type) {\n    type = getDefaultType(property);\n  }\n\n  if (feel === 'required') {\n    return {\n      id,\n      component: FeelProperty,\n      isEdited: createIsEdited(isFeelEntryEdited, element, property),\n      property\n    };\n  }\n\n  if (type === 'Number') {\n    return {\n      id,\n      component: NumberProperty,\n      isEdited: createIsEdited(isNumberFieldEntryEdited, element, property),\n      property\n    };\n  }\n\n  if (type === 'Boolean') {\n    return {\n      id,\n      component: BooleanProperty,\n      isEdited: createIsEdited(isCheckboxEntryEdited, element, property),\n      property\n    };\n  }\n\n  if (type === 'Dropdown') {\n    return {\n      id,\n      component: DropdownProperty,\n      isEdited: createIsEdited(isSelectEntryEdited, element, property),\n      property\n    };\n  }\n\n  if (type === 'String') {\n    if (feel) {\n      return {\n        id,\n        component: FeelProperty,\n        isEdited: createIsEdited(isFeelEntryEdited, element, property),\n        property\n      };\n    }\n    return {\n      id,\n      component: StringProperty,\n      isEdited: createIsEdited(isTextFieldEntryEdited, element, property),\n      property\n    };\n  }\n\n  if (type === 'Text') {\n    if (feel) {\n      return {\n        id,\n        component: FeelTextAreaProperty,\n        isEdited: createIsEdited(isFeelEntryEdited, element, property),\n        property\n      };\n    }\n    return {\n      id,\n      component: TextAreaProperty,\n      isEdited: createIsEdited(isTextAreaEntryEdited, element, property),\n      property\n    };\n  }\n}\n\nfunction getDefaultType(property) {\n  const { binding } = property;\n\n  const { type } = binding;\n\n  if ([\n    PROPERTY_TYPE,\n    ZEEBE_TASK_DEFINITION_TYPE_TYPE,\n    ZEEBE_TASK_DEFINITION,\n    ZEBBE_INPUT_TYPE,\n    ZEEBE_OUTPUT_TYPE,\n    ZEEBE_PROPERTY_TYPE,\n    ZEEBE_TASK_HEADER_TYPE\n  ].includes(type)) {\n    return 'String';\n  }\n}\n\nfunction createIsEdited(isEditedEntry, element, property) {\n\n  if (property.generatedValue) return () => true;\n\n  const actualValue = getPropertyValue(element, property);\n  const defaultValue = getDefaultValue(property);\n\n  return !isEmpty(defaultValue) ? () => actualValue !== defaultValue : isEditedEntry;\n}\n\n/**\n * Empty string is considered empty for input/output support.\n */\nfunction isEmpty(value) {\n  return value === undefined || value === '';\n}\n","import {\n  useEffect\n} from '@bpmn-io/properties-panel/preact/hooks';\n\nimport {\n  query as domQuery\n} from 'min-dom';\n\nimport {\n  SelectEntry,\n  usePrevious\n} from '@bpmn-io/properties-panel';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\n\nexport default function ReferenceSelectEntry(props) {\n  const {\n    autoFocusEntry,\n    element,\n    getOptions\n  } = props;\n\n  const options = getOptions(element);\n  const prevOptions = usePrevious(options);\n\n  // auto focus specifc other entry when options changed\n  useEffect(() => {\n    if (autoFocusEntry && prevOptions && options.length > prevOptions.length) {\n\n      const entry = domQuery(`[data-entry-id=\"${autoFocusEntry}\"]`);\n\n      const focusableInput = domQuery('.bio-properties-panel-input', entry);\n\n      if (focusableInput) {\n        focusableInput.select();\n      }\n    }\n  }, [ options ]);\n\n  return (\n    <SelectEntry { ...props } />\n  );\n}","import {\n  getBusinessObject,\n  is,\n  isAny\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  find\n} from 'min-dash';\n\nexport function isErrorSupported(element) {\n  return isAny(element, [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:EndEvent'\n  ]) && !!getErrorEventDefinition(element);\n}\n\nexport function getErrorEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:ErrorEventDefinition');\n}\n\nexport function isTimerSupported(element) {\n  return isAny(element, [\n    'bpmn:StartEvent',\n    'bpmn:IntermediateCatchEvent',\n    'bpmn:BoundaryEvent'\n  ]) && !!getTimerEventDefinition(element);\n}\n\n/**\n * Get the timer definition type for a given timer event definition.\n *\n * @param {ModdleElement<bpmn:TimerEventDefinition>} timer\n *\n * @return {string|undefined} the timer definition type\n */\nexport function getTimerDefinitionType(timer) {\n\n  if (!timer) {\n    return;\n  }\n\n  const timeDate = timer.get('timeDate');\n  if (typeof timeDate !== 'undefined') {\n    return 'timeDate';\n  }\n\n  const timeCycle = timer.get('timeCycle');\n  if (typeof timeCycle !== 'undefined') {\n    return 'timeCycle';\n  }\n\n  const timeDuration = timer.get('timeDuration');\n  if (typeof timeDuration !== 'undefined') {\n    return 'timeDuration';\n  }\n}\n\nexport function getTimerEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:TimerEventDefinition');\n}\n\nexport function getError(element) {\n  const errorEventDefinition = getErrorEventDefinition(element);\n\n  return errorEventDefinition && errorEventDefinition.get('errorRef');\n}\n\nexport function getEventDefinition(element, eventType) {\n  const businessObject = getBusinessObject(element);\n\n  const eventDefinitions = businessObject.get('eventDefinitions') || [];\n\n  return find(eventDefinitions, function(definition) {\n    return is(definition, eventType);\n  });\n}\n\nexport function isMessageSupported(element) {\n  return is(element, 'bpmn:ReceiveTask') || (\n    isAny(element, [\n      'bpmn:StartEvent',\n      'bpmn:EndEvent',\n      'bpmn:IntermediateThrowEvent',\n      'bpmn:BoundaryEvent',\n      'bpmn:IntermediateCatchEvent'\n    ]) && !!getMessageEventDefinition(element)\n  );\n}\n\nexport function getMessageEventDefinition(element) {\n  if (is(element, 'bpmn:ReceiveTask')) {\n    return getBusinessObject(element);\n  }\n\n  return getEventDefinition(element, 'bpmn:MessageEventDefinition');\n}\n\nexport function getMessage(element) {\n  const messageEventDefinition = getMessageEventDefinition(element);\n\n  return messageEventDefinition && messageEventDefinition.get('messageRef');\n}\n\nexport function getLinkEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:LinkEventDefinition');\n}\n\nexport function getSignalEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:SignalEventDefinition');\n}\n\nexport function isLinkSupported(element) {\n  return isAny(element, [\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:IntermediateCatchEvent'\n  ]) && !!getLinkEventDefinition(element);\n}\n\nexport function isSignalSupported(element) {\n  return is(element, 'bpmn:Event') && !!getSignalEventDefinition(element);\n}\n\nexport function getSignal(element) {\n  const signalEventDefinition = getSignalEventDefinition(element);\n\n  return signalEventDefinition && signalEventDefinition.get('signalRef');\n}\n\nexport function getEscalationEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:EscalationEventDefinition');\n}\n\nexport function isEscalationSupported(element) {\n  return is(element, 'bpmn:Event') && !!getEscalationEventDefinition(element);\n}\n\nexport function getEscalation(element) {\n  const escalationEventDefinition = getEscalationEventDefinition(element);\n\n  return escalationEventDefinition && escalationEventDefinition.get('escalationRef');\n}\n\nexport function isCompensationSupported(element) {\n  return isAny(element, [\n    'bpmn:EndEvent',\n    'bpmn:IntermediateThrowEvent'\n  ]) && !!getCompensateEventDefinition(element);\n}\n\nexport function getCompensateEventDefinition(element) {\n  return getEventDefinition(element, 'bpmn:CompensateEventDefinition');\n}\n\nexport function getCompensateActivity(element) {\n  const compensateEventDefinition = getCompensateEventDefinition(element);\n\n  return compensateEventDefinition && compensateEventDefinition.get('activityRef');\n}\n","import {\n  getBusinessObject\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  sortBy\n} from 'min-dash';\n\nimport { isSelectEntryEdited } from '@bpmn-io/properties-panel';\nimport ReferenceSelect from '../../../entries/ReferenceSelect';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport {\n  getMessage,\n  getMessageEventDefinition,\n  isMessageSupported\n} from '../../../utils/EventDefinitionUtil';\n\nimport {\n  createElement,\n  findRootElementById,\n  findRootElementsByType,\n  getRoot,\n  nextId\n} from '../../../utils/ElementUtil';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\nexport const EMPTY_OPTION = '';\nexport const CREATE_NEW_OPTION = 'create-new';\n\n\n/**\n * @typedef { import('@bpmn-io/properties-panel').EntryDefinition } Entry\n */\n\n/**\n * @returns {Array<Entry>} entries\n */\nexport function MessageProps(props) {\n  const {\n    element\n  } = props;\n\n  if (!isMessageSupported(element)) {\n    return [];\n  }\n\n  return [\n    {\n      id: 'messageRef',\n      component: MessageRef,\n      isEdited: isSelectEntryEdited\n    }\n  ];\n}\n\nfunction MessageRef(props) {\n  const { element } = props;\n\n  const bpmnFactory = useService('bpmnFactory');\n  const modeling = useService('modeling');\n  const translate = useService('translate');\n\n  const messageEventDefinition = getMessageEventDefinition(element);\n\n  const getValue = () => {\n    const message = getMessage(element);\n\n    if (message) {\n      return message.get('id');\n    }\n\n    return EMPTY_OPTION;\n  };\n\n  const setValue = (value) => {\n    const root = getRoot(messageEventDefinition);\n\n    let message;\n\n    // (1) create new message\n    if (value === CREATE_NEW_OPTION) {\n      const id = nextId('Message_');\n\n      message = createElement(\n        'bpmn:Message',\n        { id, name: id },\n        root,\n        bpmnFactory\n      );\n\n      value = message.get('id');\n    }\n\n    // (2) update (or remove) messageRef\n    message = findRootElementById(messageEventDefinition, 'bpmn:Message', value) || message;\n\n    // (3) commit all updates\n    return modeling.updateModdleProperties(element, messageEventDefinition, {\n      messageRef: message\n    });\n  };\n\n  const getOptions = () => {\n\n    let options = [\n      { value: EMPTY_OPTION, label: translate('<none>') },\n      { value: CREATE_NEW_OPTION, label: translate('Create new ...') }\n    ];\n\n    const messages = findRootElementsByType(getBusinessObject(element), 'bpmn:Message');\n\n    const filteredMessages = withoutTemplatedMessages(messages);\n\n    sortByName(filteredMessages).forEach(message => {\n      options.push({\n        value: message.get('id'),\n        label: message.get('name')\n      });\n    });\n\n    return options;\n  };\n\n  return ReferenceSelect({\n    element,\n    id: 'messageRef',\n    label: translate('Global message reference'),\n    autoFocusEntry: 'messageName',\n    getValue,\n    setValue,\n    getOptions\n  });\n}\n\nfunction withoutTemplatedMessages(messages) {\n  return messages.filter(message => !message.get('zeebe:modelerTemplate'));\n}\n\n\n// helper /////////////////////////\n\nfunction sortByName(elements) {\n  return sortBy(elements, e => (e.name || '').toLowerCase());\n}","import {\n  getBusinessObject\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  sortBy\n} from 'min-dash';\n\nimport { isSelectEntryEdited } from '@bpmn-io/properties-panel';\nimport ReferenceSelect from '../../../entries/ReferenceSelect';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport {\n  getSignal,\n  getSignalEventDefinition,\n  isSignalSupported\n} from '../../../utils/EventDefinitionUtil';\n\nimport {\n  createElement,\n  findRootElementById,\n  findRootElementsByType,\n  getRoot,\n  nextId\n} from '../../../utils/ElementUtil';\n\nexport const EMPTY_OPTION = '';\nexport const CREATE_NEW_OPTION = 'create-new';\n\n\n/**\n * @typedef { import('@bpmn-io/properties-panel').EntryDefinition } Entry\n */\n\n/**\n * @returns {Array<Entry>} entries\n */\nexport function SignalProps(props) {\n  const {\n    element\n  } = props;\n\n  if (!isSignalSupported(element)) {\n    return [];\n  }\n\n  return [\n    {\n      id: 'signalRef',\n      component: SignalRef,\n      isEdited: isSelectEntryEdited\n    }\n  ];\n}\n\nfunction SignalRef(props) {\n  const { element } = props;\n\n  const bpmnFactory = useService('bpmnFactory');\n  const modeling = useService('modeling');\n  const translate = useService('translate');\n\n  const signalEventDefinition = getSignalEventDefinition(element);\n\n  const getValue = () => {\n    const signal = getSignal(element);\n\n    if (signal) {\n      return signal.get('id');\n    }\n\n    return EMPTY_OPTION;\n  };\n\n  const setValue = (value) => {\n    const root = getRoot(signalEventDefinition);\n\n    let signal;\n\n    // (1) create new signal\n    if (value === CREATE_NEW_OPTION) {\n      const id = nextId('Signal_');\n\n      signal = createElement(\n        'bpmn:Signal',\n        { id, name: id },\n        root,\n        bpmnFactory\n      );\n\n      value = signal.get('id');\n    }\n\n    // (2) update (or remove) signalRef\n    signal = findRootElementById(signalEventDefinition, 'bpmn:Signal', value) || signal;\n\n    // (3) commit all updates\n    return modeling.updateModdleProperties(element, signalEventDefinition, {\n      signalRef: signal\n    });\n  };\n\n  const getOptions = () => {\n\n    let options = [\n      { value: EMPTY_OPTION, label: translate('<none>') },\n      { value: CREATE_NEW_OPTION, label: translate('Create new ...') }\n    ];\n\n    const signals = findRootElementsByType(getBusinessObject(element), 'bpmn:Signal');\n\n    const filteredSignals = withoutTemplatedSignals(signals);\n\n    sortByName(filteredSignals).forEach(signal => {\n      options.push({\n        value: signal.get('id'),\n        label: signal.get('name')\n      });\n    });\n\n    return options;\n  };\n\n  return ReferenceSelect({\n    element,\n    id: 'signalRef',\n    label: translate('Global signal reference'),\n    autoFocusEntry: 'signalName',\n    getValue,\n    setValue,\n    getOptions\n  });\n}\n\nfunction withoutTemplatedSignals(signals) {\n  return signals.filter(signal => !signal.get('zeebe:modelerTemplate'));\n}\n\n\n// helper /////////////////////////\n\nfunction sortByName(elements) {\n  return sortBy(elements, e => (e.name || '').toLowerCase());\n}\n","import {\n  createElementTemplatesGroup,\n  TemplateProps\n} from '../../components';\n\nimport {\n  CustomProperties,\n  MessageProps,\n  SignalProps\n} from './properties';\n\nimport { getTemplateId, getTemplateVersion } from '../Helper';\n\nimport { applyConditions } from '../Condition';\nimport { getPropertyValue } from '../util/propertyUtil';\n\nconst LOWER_PRIORITY = 300;\n\nconst ALWAYS_VISIBLE_GROUPS = [\n  'general',\n  'documentation',\n  'multiInstance',\n  'Zeebe__ExecutionListeners'\n];\n\n\nexport default class ElementTemplatesPropertiesProvider {\n\n  constructor(elementTemplates, propertiesPanel, injector) {\n    propertiesPanel.registerProvider(LOWER_PRIORITY, this);\n\n    this._elementTemplates = elementTemplates;\n    this._injector = injector;\n  }\n\n  getGroups(element) {\n    return (groups) => {\n      const injector = this._injector;\n\n      updateMessageGroup(groups, element);\n      updateSignalGroup(groups, element);\n\n      if (!this._shouldShowTemplateProperties(element)) {\n        return groups;\n      }\n\n      const translate = injector.get('translate');\n\n      // (0) Copy provided groups\n      groups = groups.slice();\n\n      const templatesGroup = {\n        element,\n        id: 'ElementTemplates__Template',\n        label: translate('Template'),\n        component: createElementTemplatesGroup({\n          getTemplateId\n        }),\n        entries: TemplateProps({\n          element,\n          elementTemplates: this._elementTemplates,\n          getTemplateId,\n          getTemplateVersion\n        })\n      };\n\n      // (1) Add templates group\n      addGroupsAfter('documentation', groups, [ templatesGroup ]);\n\n      let elementTemplate = this._elementTemplates.get(element);\n\n      if (elementTemplate) {\n        elementTemplate = applyConditions(element, elementTemplate, getPropertyValue);\n\n        const templateSpecificGroups = [].concat(\n          CustomProperties({ element, elementTemplate, injector })\n        );\n\n        // (2) add template-specific properties groups\n        addGroupsAfter('ElementTemplates__Template', groups, templateSpecificGroups);\n      }\n\n      // (3) apply entries visible\n      if (getTemplateId(element)) {\n        groups = getVisibleGroups(elementTemplate || {}, groups);\n      }\n\n      return groups;\n    };\n  }\n\n  _shouldShowTemplateProperties(element) {\n    return getTemplateId(element) || this._elementTemplates.getAll(element).length;\n  }\n}\n\nElementTemplatesPropertiesProvider.$inject = [\n  'elementTemplates',\n  'propertiesPanel',\n  'injector'\n];\n\n\n// helper /////////////////////\n\nfunction updateMessageGroup(groups, element) {\n  const messageGroup = findGroup(groups, 'message');\n\n  if (!messageGroup) {\n    return;\n  }\n\n  messageGroup.entries = overrideGenericEntries(\n    messageGroup.entries,\n    MessageProps({ element })\n  );\n}\n\nfunction updateSignalGroup(groups, element) {\n  const signalGroup = findGroup(groups, 'signal');\n\n  if (!signalGroup) {\n    return;\n  }\n\n  signalGroup.entries = overrideGenericEntries(\n    signalGroup.entries,\n    SignalProps({ element })\n  );\n}\n\nfunction findGroup(groups, id) {\n  return groups.find(g => g.id === id);\n}\n\nfunction overrideGenericEntries(oldEntries, newEntries) {\n  return oldEntries.map(oldEntry => (\n    newEntries.find(newEntry => newEntry.id === oldEntry.id) || oldEntry\n  ));\n}\n\n/**\n *\n * @param {string|string[]} idOrIds\n * @param {Array<{ id: string }} groups\n * @param {Array<{ id: string }>} groupsToAdd\n */\nfunction addGroupsAfter(idOrIds, groups, groupsToAdd) {\n  let ids = idOrIds;\n  if (!Array.isArray(idOrIds)) {\n    ids = [ idOrIds ];\n  }\n\n  // find index of last group with provided id\n  const index = groups.reduce((acc, group, index) => {\n    return ids.includes(group.id) ? index : acc;\n  }, -1);\n\n  if (index !== -1) {\n    groups.splice(index + 1, 0, ...groupsToAdd);\n  } else {\n\n    // add in the beginning if group with provided id is missing\n    groups.unshift(...groupsToAdd);\n  }\n}\n\nfunction getVisibleGroups(template, groups) {\n  if (!template.entriesVisible) {\n    return groups.filter(group => {\n      return (\n        ALWAYS_VISIBLE_GROUPS.includes(group.id) ||\n        group.id.startsWith('ElementTemplates__')\n      );\n    });\n  }\n\n  return groups;\n}\n","import translateModule from 'diagram-js/lib/i18n/translate';\n\nimport ElementTemplatesPropertiesProvider from './ElementTemplatesPropertiesProvider';\n\nexport default {\n  __depends__: [\n    translateModule\n  ],\n  __init__: [\n    'elementTemplatesPropertiesProvider'\n  ],\n  elementTemplatesPropertiesProvider: [ 'type', ElementTemplatesPropertiesProvider ]\n};\n","import coreModule from './core';\nimport propertiesProviderModule from './properties-panel';\n\nexport default {\n  __depends__: [\n    coreModule,\n    propertiesProviderModule,\n  ]\n};\n","import {\n  assign,\n  forEach,\n  isObject,\n  keys\n} from 'min-dash';\n\n/**\n * Converts legacy scopes descriptor to newer supported array structure.\n *\n * For example, it transforms\n *\n * scopes: {\n *   'camunda:Connector':\n *     { properties: []\n *   }\n * }\n *\n * to\n *\n * scopes: [\n *   {\n *     type: 'camunda:Connector',\n *     properties: []\n *   }\n * ]\n *\n * @param {ScopesDescriptor} scopes\n *\n * @returns {Array}\n */\nexport default function handleLegacyScopes(scopes = []) {\n  const scopesAsArray = [];\n\n  if (!isObject(scopes)) {\n    return scopes;\n  }\n\n  forEach(keys(scopes), function(scopeName) {\n    scopesAsArray.push(assign({\n      type: scopeName\n    }, scopes[scopeName]));\n  });\n\n  return scopesAsArray;\n}\n","import { assign } from 'min-dash';\n\nimport { nextId } from '../utils/ElementUtil';\n\n\n/**\n * Create an input parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createInputParameter(binding, value, bpmnFactory) {\n  const {\n    name,\n    scriptFormat\n  } = binding;\n\n  let parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat,\n      value\n    });\n  } else {\n    parameterValue = value;\n  }\n\n  return bpmnFactory.create('camunda:InputParameter', {\n    name,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\n\n/**\n * Create an output parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createOutputParameter(binding, value, bpmnFactory) {\n  const {\n    scriptFormat,\n    source\n  } = binding;\n\n  let parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat,\n      value: source\n    });\n  } else {\n    parameterValue = source;\n  }\n\n  return bpmnFactory.create('camunda:OutputParameter', {\n    name: value,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\n\n/**\n * Create camunda property from the given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaProperty(binding, value = '', bpmnFactory) {\n  const { name } = binding;\n\n  return bpmnFactory.create('camunda:Property', {\n    name,\n    value\n  });\n}\n\n\n/**\n * Create camunda:in element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaIn(binding, value, bpmnFactory) {\n  const attrs = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:In', attrs);\n}\n\n\n/**\n * Create camunda:in with businessKey element from given binding.\n *\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaInWithBusinessKey(value, bpmnFactory) {\n  return bpmnFactory.create('camunda:In', {\n    businessKey: value\n  });\n}\n\n\n/**\n * Create camunda:out element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaOut(binding, value, bpmnFactory) {\n  const attrs = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:Out', attrs);\n}\n\n\n/**\n * Create camunda:executionListener element containing an inline script from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaExecutionListener(binding, value, bpmnFactory) {\n  const {\n    event,\n    implementationType,\n    scriptFormat\n  } = binding;\n\n  // To guarantee backwards compatibility scriptFormat is taken into account and has precedence before any other type\n  if (implementationType === 'script' || scriptFormat) {\n    return bpmnFactory.create('camunda:ExecutionListener', {\n      event,\n      script: bpmnFactory.create('camunda:Script', {\n        scriptFormat,\n        value\n      })\n    });\n  }\n\n  return bpmnFactory.create('camunda:ExecutionListener', {\n    event,\n    [implementationType]: value\n  });\n}\n\n/**\n * Create camunda:field element containing string or expression from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaFieldInjection(binding, value, bpmnFactory) {\n  const DEFAULT_PROPS = {\n    'string': undefined,\n    'expression': undefined,\n    'name': undefined\n  };\n\n  const props = assign({}, DEFAULT_PROPS);\n\n  const {\n    expression,\n    name\n  } = binding;\n\n  if (!expression) {\n    props.string = value;\n  } else {\n    props.expression = value;\n  }\n  props.name = name;\n\n  return bpmnFactory.create('camunda:Field', props);\n}\n\n\n/**\n * Create camunda:errorEventDefinition element containing expression and errorRef\n * from given binding.\n *\n * @param {String} expression\n * @param {ModdleElement} errorRef\n * @param {ModdleElement} parent\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nexport function createCamundaErrorEventDefinition(expression, errorRef, parent, bpmnFactory) {\n  const errorEventDefinition = bpmnFactory.create('camunda:ErrorEventDefinition', {\n    errorRef,\n    expression\n  });\n\n  errorEventDefinition.$parent = parent;\n\n  return errorEventDefinition;\n}\n\n\n/**\n * Create bpmn:error element containing a specific error id given by a binding.\n *\n * @param {String} bindingErrorRef\n * @param {ModdleElement} parent\n * @param {BpmnFactory} bpmnFactory\n *\n * @return { ModdleElement }\n */\nexport function createError(bindingErrorRef, parent, bpmnFactory) {\n  const error = bpmnFactory.create('bpmn:Error', {\n\n    // we need to later retrieve the error from a binding\n    id: nextId('Error_' + bindingErrorRef + '_')\n  });\n\n  error.$parent = parent;\n\n  return error;\n}\n\n\n// helpers //////////\n\n/**\n * Create properties for camunda:in and camunda:out types.\n */\nfunction createCamundaInOutAttrs(binding, value) {\n  const properties = {};\n\n  const {\n    expression,\n    source,\n    sourceExpression,\n    target,\n    type,\n    variables\n  } = binding;\n\n  // explicitly cover all conditions as specified here:\n  // https://github.com/camunda/camunda-modeler/blob/develop/docs/element-templates/README.md#camundain\n  if (type === 'camunda:in') {\n    if (target && !expression && !variables) {\n      properties.target = target;\n      properties.source = value;\n\n    } else if (target && expression === true && !variables) {\n      properties.target = target;\n      properties.sourceExpression = value;\n\n    } else if (!target && !expression && variables === 'local') {\n      properties.local = true;\n      properties.variables = 'all';\n\n    } else if (target && !expression && variables === 'local') {\n      properties.local = true;\n      properties.source = value;\n      properties.target = target;\n\n    } else if (target && expression && variables === 'local') {\n      properties.local = true;\n      properties.sourceExpression = value;\n      properties.target = target;\n\n    } else if (!target && !expression && variables === 'all') {\n      properties.variables = 'all';\n    } else {\n      throw new Error('invalid configuration for camunda:in element template binding');\n    }\n  }\n\n  // explicitly cover all conditions as specified here:\n  // https://github.com/camunda/camunda-modeler/blob/develop/docs/element-templates/README.md#camundaout\n  if (type === 'camunda:out') {\n    if (source && !sourceExpression && !variables) {\n      properties.target = value;\n      properties.source = source;\n\n    } else if (!source && sourceExpression && !variables) {\n      properties.target = value;\n      properties.sourceExpression = sourceExpression;\n\n    } else if (!source && !sourceExpression && variables === 'all') {\n      properties.variables = 'all';\n\n    } else if (source && !sourceExpression && variables === 'local') {\n      properties.local = true;\n      properties.source = source;\n      properties.target = value;\n\n    } else if (!source && sourceExpression && variables === 'local') {\n      properties.local = true;\n      properties.sourceExpression = sourceExpression;\n      properties.target = value;\n\n    } else if (!source && !sourceExpression && variables === 'local') {\n      properties.local = true;\n      properties.variables = 'all';\n    } else {\n      throw new Error('invalid configuration for camunda:out element template binding');\n    }\n  }\n\n  return properties;\n}\n","import {\n  getBusinessObject,\n  is,\n  isAny\n} from 'bpmn-js/lib/util/ModelUtil';\n\nimport {\n  findCamundaErrorEventDefinition,\n  findExtension,\n  findExtensions,\n  getTemplateId,\n  getTemplateVersion\n} from '../Helper';\n\nimport handleLegacyScopes from '../util/handleLegacyScopes';\n\nimport {\n  createCamundaExecutionListener,\n  createCamundaFieldInjection,\n  createCamundaIn,\n  createCamundaInWithBusinessKey,\n  createCamundaOut,\n  createCamundaProperty,\n  createInputParameter,\n  createOutputParameter,\n  createCamundaErrorEventDefinition,\n  createError\n} from '../CreateHelper';\n\nimport { getSignalEventDefinition } from '../../utils/EventDefinitionUtil';\n\nimport { getRoot } from '../../utils/ElementUtil';\n\nimport {\n  find,\n  isString,\n  isUndefined,\n  keys,\n  without\n} from 'min-dash';\n\nconst CAMUNDA_SERVICE_TASK_LIKE = [\n  'camunda:class',\n  'camunda:delegateExpression',\n  'camunda:expression'\n];\n\n/**\n * Applies an element template to an element. Sets `camunda:modelerTemplate` and\n * `camunda:modelerTemplateVersion`.\n */\nexport default class ChangeElementTemplateHandler {\n  constructor(bpmnFactory, bpmnReplace, commandStack, modeling) {\n    this._bpmnFactory = bpmnFactory;\n    this._bpmnReplace = bpmnReplace;\n    this._commandStack = commandStack;\n    this._modeling = modeling;\n  }\n\n  /**\n   * Change an element's template and update its properties as specified in `newTemplate`. Specify\n   * `oldTemplate` to update from one template to another. If `newTemplate` isn't specified the\n   * `camunda:modelerTemplate` and `camunda:modelerTemplateVersion` properties will be removed from\n   * the element.\n   *\n   * @param {Object} context\n   * @param {Object} context.element\n   * @param {Object} [context.oldTemplate]\n   * @param {Object} [context.newTemplate]\n   */\n  preExecute(context) {\n    const newTemplate = context.newTemplate,\n          oldTemplate = context.oldTemplate;\n\n    let element = context.element;\n\n    // update camunda:modelerTemplate attribute\n    this._updateCamundaModelerTemplate(element, newTemplate);\n\n    if (newTemplate) {\n\n      element = context.element = this._updateTaskType(element, newTemplate);\n\n      // update properties\n      this._updateProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:ExecutionListener properties\n      this._updateCamundaExecutionListenerProperties(element, newTemplate);\n\n      // update camunda:Field properties\n      this._updateCamundaFieldProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:In and camunda:Out properties\n      this._updateCamundaInOutProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:InputParameter and camunda:OutputParameter properties\n      this._updateCamundaInputOutputParameterProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:Property properties\n      this._updateCamundaPropertyProperties(element, oldTemplate, newTemplate);\n\n      // update camunda:ErrorEventDefinition properties\n      this._updateCamundaErrorEventDefinitionProperties(element, oldTemplate, newTemplate);\n\n      // update properties for each scope\n      handleLegacyScopes(newTemplate.scopes).forEach((newScopeTemplate) => {\n        this._updateScopeProperties(element, oldTemplate, newScopeTemplate, newTemplate);\n      });\n\n    }\n  }\n\n  _getOrCreateExtensionElements(element) {\n    const bpmnFactory = this._bpmnFactory,\n          modeling = this._modeling;\n\n    const businessObject = getBusinessObject(element);\n\n    let extensionElements = businessObject.get('extensionElements');\n\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      extensionElements.$parent = businessObject;\n\n      modeling.updateProperties(element, {\n        extensionElements: extensionElements\n      });\n    }\n\n    return extensionElements;\n  }\n\n  /**\n   * Update `camunda:ErrorEventDefinition` properties of specified business object. Event\n   * definitions can only exist in `bpmn:ExtensionElements`.\n   *\n   * Ensures an bpmn:Error exists for the event definition.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateCamundaErrorEventDefinitionProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:errorEventDefinition';\n    });\n\n    // (1) do not override if no updates\n    if (!newProperties.length) {\n      return;\n    }\n\n    const extensionElements = this._getOrCreateExtensionElements(element);\n\n    const oldErrorEventDefinitions = findExtensions(element, [ 'camunda:ErrorEventDefinition' ]);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldEventDefinition = oldProperty && findOldBusinessObject(extensionElements, oldProperty),\n            newBinding = newProperty.binding;\n\n      // (2) update old event definitions\n      if (oldProperty && oldEventDefinition) {\n\n        if (!propertyChanged(oldEventDefinition, oldProperty)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldEventDefinition,\n            properties: {\n              expression: newProperty.value\n            }\n          });\n        }\n\n        remove(oldErrorEventDefinitions, oldEventDefinition);\n      }\n\n      // (3) create new event definition + error\n      else {\n        const rootElement = getRoot(getBusinessObject(element)),\n              newError = createError(newBinding.errorRef, rootElement, bpmnFactory),\n              newEventDefinition = createCamundaErrorEventDefinition(newProperty.value, newError, extensionElements, bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: rootElement,\n          properties: {\n            rootElements: [ ...rootElement.get('rootElements'), newError ]\n          }\n        });\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: extensionElements,\n          properties: {\n            values: [ ...extensionElements.get('values'), newEventDefinition ]\n          }\n        });\n      }\n\n    });\n\n    // (4) remove old event definitions\n    if (oldErrorEventDefinitions.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: without(extensionElements.get('values'), value => oldErrorEventDefinitions.includes(value))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `camunda:ExecutionListener` properties of specified business object. Execution listeners\n   * will always be overridden. Execution listeners can only exist in `bpmn:ExtensionElements`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} newTemplate\n   */\n  _updateCamundaExecutionListenerProperties(element, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:executionListener';\n    });\n\n    // (1) do not override old execution listeners if no new execution listeners specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    const extensionElements = this._getOrCreateExtensionElements(element);\n\n    // (2) remove old execution listeners\n    const oldExecutionListeners = findExtensions(element, [ 'camunda:ExecutionListener' ]);\n\n    // (3) add new execution listeners\n    const newExecutionListeners = newProperties.map((newProperty) => {\n      const newBinding = newProperty.binding,\n            propertyValue = newProperty.value;\n\n      return createCamundaExecutionListener(newBinding, propertyValue, bpmnFactory);\n    });\n\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: extensionElements,\n      properties: {\n        values: [\n          ...without(extensionElements.get('values'), value => oldExecutionListeners.includes(value)),\n          ...newExecutionListeners\n        ]\n      }\n    });\n  }\n\n  /**\n   * Update `camunda:Field` properties of specified business object.\n   * If business object is `camunda:ExecutionListener` or `camunda:TaskListener` `fields` property\n   * will be updated. Otherwise `extensionElements.values` property will be updated.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   * @param {ModdleElement} businessObject\n   */\n  _updateCamundaFieldProperties(element, oldTemplate, newTemplate, businessObject) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:field';\n    });\n\n    // (1) do not override old fields if no new fields specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    if (!businessObject) {\n      businessObject = this._getOrCreateExtensionElements(element);\n    }\n\n    const propertyName = isAny(businessObject, [ 'camunda:ExecutionListener', 'camunda:TaskListener' ])\n      ? 'fields'\n      : 'values';\n\n    const oldFields = findExtensions(element, [ 'camunda:Field' ]);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldField = oldProperty && findOldBusinessObject(businessObject, oldProperty),\n            newBinding = newProperty.binding;\n\n      // (2) update old fields\n      if (oldProperty && oldField) {\n\n        if (!propertyChanged(oldField, oldProperty)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldField,\n            properties: {\n              string: newProperty.value\n            }\n          });\n        }\n\n        remove(oldFields, oldField);\n      }\n\n      // (3) add new fields\n      else {\n        const newCamundaFieldInjection = createCamundaFieldInjection(newBinding, newProperty.value, bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            [ propertyName ]: [ ...businessObject.get(propertyName), newCamundaFieldInjection ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old fields\n    if (oldFields.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          [ propertyName ]: without(businessObject.get(propertyName), value => oldFields.includes(value))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `camunda:In` and `camunda:Out` properties of specified business object. Only\n   * `bpmn:CallActivity` and events with `bpmn:SignalEventDefinition` can have ins. Only\n   * `camunda:CallActivity` can have outs.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateCamundaInOutProperties(element, oldTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:in'\n      || newBindingType === 'camunda:in:businessKey'\n      || newBindingType === 'camunda:out';\n    });\n\n    // (1) do not override old fields if no new fields specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    // get extension elements of either signal event definition or call activity\n    const extensionElements = this._getOrCreateExtensionElements(getSignalEventDefinition(element) || element);\n\n    const oldInsAndOuts = findExtensions(extensionElements, [ 'camunda:In', 'camunda:Out' ]);\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldBinding = oldProperty && oldProperty.binding,\n            oldInOurOut = oldProperty && findOldBusinessObject(extensionElements, oldProperty),\n            newPropertyValue = newProperty.value,\n            newBinding = newProperty.binding,\n            newBindingType = newBinding.type,\n            properties = {};\n\n      let newInOrOut;\n\n      // (2) update old ins and outs\n      if (oldProperty && oldInOurOut) {\n\n        if (!propertyChanged(oldInOurOut, oldProperty)) {\n          if (newBindingType === 'camunda:in') {\n            if (newBinding.expression) {\n              properties[ 'camunda:sourceExpression' ] = newPropertyValue;\n            } else {\n              properties[ 'camunda:source' ] = newPropertyValue;\n            }\n          } else if (newBindingType === 'camunda:in:businessKey') {\n            properties[ 'camunda:businessKey' ] = newPropertyValue;\n          } else if (newBindingType === 'camunda:out') {\n            properties[ 'camunda:target' ] = newPropertyValue;\n          }\n        }\n\n        // update camunda:local property if it changed\n        if ((oldBinding.local && !newBinding.local) || !oldBinding.local && newBinding.local) {\n          properties.local = newBinding.local;\n        }\n\n        if (keys(properties)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldInOurOut,\n            properties\n          });\n        }\n\n        remove(oldInsAndOuts, oldInOurOut);\n      }\n\n      // (3) add new ins and outs\n      else {\n        if (newBindingType === 'camunda:in') {\n          newInOrOut = createCamundaIn(newBinding, newPropertyValue, bpmnFactory);\n        } else if (newBindingType === 'camunda:out') {\n          newInOrOut = createCamundaOut(newBinding, newPropertyValue, bpmnFactory);\n        } else if (newBindingType === 'camunda:in:businessKey') {\n          newInOrOut = createCamundaInWithBusinessKey(newPropertyValue, bpmnFactory);\n        }\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: extensionElements,\n          properties: {\n            values: [ ...extensionElements.get('values'), newInOrOut ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old ins and outs\n    if (oldInsAndOuts.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: extensionElements,\n        properties: {\n          values: without(extensionElements.get('values'), value => oldInsAndOuts.includes(value))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `camunda:InputParameter` and `camunda:OutputParameter` properties of specified business\n   * object. Both can only exist in `camunda:InputOutput` which can exist in `bpmn:ExtensionElements`\n   * or `camunda:Connector`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   */\n  _updateCamundaInputOutputParameterProperties(element, oldTemplate, newTemplate, businessObject) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:inputParameter' || newBindingType === 'camunda:outputParameter';\n    });\n\n    // (1) do not override old inputs and outputs if no new inputs and outputs specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    if (!businessObject) {\n      businessObject = this._getOrCreateExtensionElements(element);\n    }\n\n    let inputOutput;\n\n    if (is(businessObject, 'camunda:Connector')) {\n      inputOutput = businessObject.get('camunda:inputOutput');\n\n      if (!inputOutput) {\n        inputOutput = bpmnFactory.create('camunda:InputOutput');\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            inputOutput\n          }\n        });\n      }\n    } else {\n      inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n      if (!inputOutput) {\n        inputOutput = bpmnFactory.create('camunda:InputOutput');\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties: {\n            values: [ ...businessObject.get('values'), inputOutput ]\n          }\n        });\n      }\n    }\n\n    const oldInputs = inputOutput.get('camunda:inputParameters')\n      ? inputOutput.get('camunda:inputParameters').slice()\n      : [];\n\n    const oldOutputs = inputOutput.get('camunda:outputParameters')\n      ? inputOutput.get('camunda:outputParameters').slice()\n      : [];\n\n    let propertyName;\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldInputOrOutput = oldProperty && findOldBusinessObject(businessObject, oldProperty),\n            newPropertyValue = newProperty.value,\n            newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      let newInputOrOutput,\n          properties;\n\n      // (2) update old inputs and outputs\n      if (oldProperty && oldInputOrOutput) {\n\n        if (!propertyChanged(oldInputOrOutput, oldProperty)) {\n          if (is(oldInputOrOutput, 'camunda:InputParameter')) {\n            properties = {\n              value: newPropertyValue\n            };\n          } else {\n            properties = {\n              name: newPropertyValue\n            };\n          }\n\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldInputOrOutput,\n            properties\n          });\n        }\n\n        if (is(oldInputOrOutput, 'camunda:InputParameter')) {\n          remove(oldInputs, oldInputOrOutput);\n        } else {\n          remove(oldOutputs, oldInputOrOutput);\n        }\n      }\n\n      // (3) add new inputs and outputs\n      else {\n        if (newBindingType === 'camunda:inputParameter') {\n          propertyName = 'inputParameters';\n\n          newInputOrOutput = createInputParameter(newBinding, newPropertyValue, bpmnFactory);\n        } else {\n          propertyName = 'outputParameters';\n\n          newInputOrOutput = createOutputParameter(newBinding, newPropertyValue, bpmnFactory);\n        }\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: inputOutput,\n          properties: {\n            [ propertyName ]: [ ...inputOutput.get(propertyName), newInputOrOutput ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old inputs and outputs\n    if (oldInputs.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: inputOutput,\n        properties: {\n          inputParameters: without(inputOutput.get('inputParameters'), inputParameter => oldInputs.includes(inputParameter))\n        }\n      });\n    }\n\n    if (oldOutputs.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: inputOutput,\n        properties: {\n          outputParameters: without(inputOutput.get('outputParameters'), outputParameter => oldOutputs.includes(outputParameter))\n        }\n      });\n    }\n  }\n\n  _updateCamundaModelerTemplate(element, newTemplate) {\n    const modeling = this._modeling;\n\n    const newId = newTemplate && newTemplate.id;\n    const newVersion = newTemplate && newTemplate.version;\n\n    if (getTemplateId(element) !== newId || getTemplateVersion(element) !== newVersion) {\n      modeling.updateProperties(element, {\n        'camunda:modelerTemplate': newId,\n        'camunda:modelerTemplateVersion': newVersion\n      });\n    }\n  }\n\n  /**\n   * Update `camunda:Property` properties of specified business object. `camunda:Property` can only\n   * exist in `camunda:Properties`.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newTemplate\n   * @param {ModdleElement} businessObject\n   */\n  _updateCamundaPropertyProperties(element, oldTemplate, newTemplate, businessObject) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'camunda:property';\n    });\n\n    // (1) do not override old properties if no new properties specified\n    if (!newProperties.length) {\n      return;\n    }\n\n    if (businessObject) {\n      businessObject = this._getOrCreateExtensionElements(businessObject);\n    } else {\n      businessObject = this._getOrCreateExtensionElements(element);\n    }\n\n    let camundaProperties = findExtension(businessObject, 'camunda:Properties');\n\n    if (!camundaProperties) {\n      camundaProperties = bpmnFactory.create('camunda:Properties');\n\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          values: [ ...businessObject.get('values'), camundaProperties ]\n        }\n      });\n    }\n\n    const oldCamundaProperties = camundaProperties.get('camunda:values')\n      ? camundaProperties.get('camunda:values').slice()\n      : [];\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            oldCamundaProperty = oldProperty && findOldBusinessObject(businessObject, oldProperty),\n            newPropertyValue = newProperty.value,\n            newBinding = newProperty.binding;\n\n      // (2) update old properties\n      if (oldProperty && oldCamundaProperty) {\n\n        if (!propertyChanged(oldCamundaProperty, oldProperty)) {\n          commandStack.execute('element.updateModdleProperties', {\n            element,\n            moddleElement: oldCamundaProperty,\n            properties: {\n              value: newPropertyValue\n            }\n          });\n        }\n\n        remove(oldCamundaProperties, oldCamundaProperty);\n      }\n\n      // (3) add new properties\n      else {\n        const newCamundaProperty = createCamundaProperty(newBinding, newPropertyValue, bpmnFactory);\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: camundaProperties,\n          properties: {\n            values: [ ...camundaProperties.get('values'), newCamundaProperty ]\n          }\n        });\n      }\n    });\n\n    // (4) remove old properties\n    if (oldCamundaProperties.length) {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: camundaProperties,\n        properties: {\n          values: without(camundaProperties.get('values'), value => oldCamundaProperties.includes(value))\n        }\n      });\n    }\n  }\n\n  /**\n   * Update `bpmn:conditionExpression` property of specified element. Since condition expression is\n   * is not primitive it needs special handling.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldProperty\n   * @param {Object} newProperty\n   */\n  _updateConditionExpression(element, oldProperty, newProperty) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack,\n          modeling = this._modeling;\n\n    const newBinding = newProperty.binding,\n          newPropertyValue = newProperty.value;\n\n    if (!oldProperty) {\n      modeling.updateProperties(element, {\n        conditionExpression: bpmnFactory.create('bpmn:FormalExpression', {\n          body: newPropertyValue,\n          language: newBinding.scriptFormat\n        })\n      });\n\n      return;\n    }\n\n    const oldBinding = oldProperty.binding,\n          oldPropertyValue = oldProperty.value;\n\n    const businessObject = getBusinessObject(element),\n          conditionExpression = businessObject.get('bpmn:conditionExpression');\n\n    const properties = {};\n\n    if (conditionExpression.get('body') === oldPropertyValue) {\n      properties.body = newPropertyValue;\n    }\n\n    if (conditionExpression.get('language') === oldBinding.scriptFormat) {\n      properties.language = newBinding.scriptFormat;\n    }\n\n    if (!keys(properties).length) {\n      return;\n    }\n\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: conditionExpression,\n      properties\n    });\n  }\n\n  _updateProperties(element, oldTemplate, newTemplate, businessObject) {\n    const commandStack = this._commandStack;\n\n    const newProperties = newTemplate.properties.filter((newProperty) => {\n      const newBinding = newProperty.binding,\n            newBindingType = newBinding.type;\n\n      return newBindingType === 'property';\n    });\n\n    const oldProperties = oldTemplate && oldTemplate.properties.filter((oldProperty) => {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'property';\n    });\n\n    if (!newProperties.length) {\n      return;\n    }\n\n    if (!businessObject) {\n      businessObject = getBusinessObject(element);\n    }\n\n    newProperties.forEach((newProperty) => {\n      const oldProperty = findOldProperty(oldTemplate, newProperty),\n            newBinding = newProperty.binding,\n            newBindingName = newBinding.name,\n            newPropertyValue = newProperty.value;\n\n      let changedElement,\n          properties;\n\n      if (oldProperty) {\n        remove(oldProperties, oldProperty);\n      }\n\n      if (newBindingName === 'conditionExpression') {\n        this._updateConditionExpression(element, oldProperty, newProperty);\n      } else {\n\n        if (is(businessObject, 'bpmn:Error')) {\n          changedElement = businessObject;\n        } else {\n          changedElement = element;\n        }\n\n        if (oldProperty && propertyChanged(changedElement, oldProperty)) {\n          return;\n        }\n\n        properties = {};\n\n        properties[ newBindingName ] = newPropertyValue;\n\n        // only one of `camunda:class`, `camunda:delegateExpression` and `camunda:expression` can be set\n        // TODO(philippfromme): ensuring only one of these properties is set at a time should be\n        // implemented in a behavior and not in this handler and properties panel UI\n        if (CAMUNDA_SERVICE_TASK_LIKE.indexOf(newBindingName) !== -1) {\n          CAMUNDA_SERVICE_TASK_LIKE.forEach((camundaServiceTaskLikeProperty) => {\n            if (camundaServiceTaskLikeProperty !== newBindingName) {\n              properties[ camundaServiceTaskLikeProperty ] = undefined;\n            }\n          });\n        }\n\n        commandStack.execute('element.updateModdleProperties', {\n          element,\n          moddleElement: businessObject,\n          properties\n        });\n      }\n    });\n\n    // remove old properties not present in new template\n    oldProperties && oldProperties.forEach((oldProperty) => {\n      commandStack.execute('element.updateModdleProperties', {\n        element,\n        moddleElement: businessObject,\n        properties: {\n          [oldProperty.binding.name]: null\n        }\n      });\n    });\n  }\n\n  /**\n   * Update properties for a specified scope.\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} oldTemplate\n   * @param {Object} newScopeTemplate\n   * @param {Object} newTemplate\n   */\n  _updateScopeProperties(element, oldTemplate, newScopeTemplate, newTemplate) {\n    const bpmnFactory = this._bpmnFactory,\n          commandStack = this._commandStack;\n\n    const scopeName = newScopeTemplate.type;\n\n    let scopeElement;\n\n    scopeElement = findOldScopeElement(element, newScopeTemplate, newTemplate);\n\n    if (!scopeElement) {\n\n      scopeElement = bpmnFactory.create(scopeName);\n    }\n\n    const oldScopeTemplate = findOldScopeTemplate(newScopeTemplate, oldTemplate);\n\n    // update properties\n    this._updateProperties(element, oldScopeTemplate, newScopeTemplate, scopeElement);\n\n    // update camunda:ExecutionListener properties\n    this._updateCamundaExecutionListenerProperties(element, newScopeTemplate);\n\n    // update camunda:In and camunda:Out properties\n    this._updateCamundaInOutProperties(element, oldScopeTemplate, newScopeTemplate);\n\n    // update camunda:InputParameter and camunda:OutputParameter properties\n    this._updateCamundaInputOutputParameterProperties(element, oldScopeTemplate, newScopeTemplate, scopeElement);\n\n    // update camunda:Field properties\n    this._updateCamundaFieldProperties(element, oldScopeTemplate, newScopeTemplate, scopeElement);\n\n    // update camunda:Property properties\n    this._updateCamundaPropertyProperties(element, oldScopeTemplate, newScopeTemplate, scopeElement);\n\n    // assume that root elements were already created in root by referenced event definition binding\n    if (isRootElementScope(scopeName)) {\n      return;\n    }\n\n    const extensionElements = this._getOrCreateExtensionElements(element);\n\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: extensionElements,\n      properties: {\n        values: [ ...extensionElements.get('values'), scopeElement ]\n      }\n    });\n  }\n\n  /**\n   * Replaces the element with the specified elementType\n   *\n   * @param {djs.model.Base} element\n   * @param {Object} newTemplate\n   */\n  _updateTaskType(element, newTemplate) {\n\n    // determine new task type\n    const newType = newTemplate.elementType;\n\n    if (!newType) {\n      return element;\n    }\n\n    // don't replace Task that is already the correct type\n    if (element.$type === newType.value) {\n      return element;\n    }\n\n    return this._bpmnReplace.replaceElement(element, { type: newType.value });\n  }\n}\n\nChangeElementTemplateHandler.$inject = [\n  'bpmnFactory',\n  'bpmnReplace',\n  'commandStack',\n  'modeling'\n];\n\n\n// helpers //////////\n\n/**\n * Find old business object matching specified old property.\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} oldProperty\n *\n * @returns {ModdleElement}\n */\nfunction findOldBusinessObject(element, oldProperty) {\n  let businessObject = getBusinessObject(element),\n      propertyName;\n\n  const oldBinding = oldProperty.binding,\n        oldBindingType = oldBinding.type;\n\n  if (oldBindingType === 'camunda:field') {\n\n    if (isAny(businessObject, [ 'camunda:ExecutionListener', 'camunda:TaskListener' ])) {\n      propertyName = 'camunda:fields';\n    } else {\n      propertyName = 'bpmn:values';\n    }\n\n    if (!businessObject || !businessObject.get(propertyName) || !businessObject.get(propertyName).length) {\n      return;\n    }\n\n    return find(businessObject.get(propertyName), function(oldBusinessObject) {\n      return oldBusinessObject.get('camunda:name') === oldBinding.name;\n    });\n  }\n\n  if (oldBindingType === 'camunda:in') {\n    return find(businessObject.get('values'), function(oldBusinessObject) {\n      return oldBusinessObject.get('target') === oldBinding.target;\n    });\n  }\n\n  if (oldBindingType === 'camunda:in:businessKey') {\n    return find(businessObject.get('values'), function(oldBusinessObject) {\n      return isString(oldBusinessObject.get('businessKey'));\n    });\n  }\n\n  if (oldBindingType === 'camunda:out') {\n    return find(businessObject.get('values'), function(oldBusinessObject) {\n      return oldBusinessObject.get('source') === oldBinding.source ||\n        oldBusinessObject.get('sourceExpression') || oldBinding.sourceExpression;\n    });\n  }\n\n  if (oldBindingType === 'camunda:inputParameter' || oldBindingType === 'camunda:outputParameter') {\n\n    if (is(businessObject, 'camunda:Connector')) {\n      businessObject = businessObject.get('camunda:inputOutput');\n\n      if (!businessObject) {\n        return;\n      }\n    } else {\n      businessObject = findExtension(businessObject, 'camunda:InputOutput');\n\n      if (!businessObject) {\n        return;\n      }\n    }\n\n    if (oldBindingType === 'camunda:inputParameter') {\n      return find(businessObject.get('camunda:inputParameters'), function(oldBusinessObject) {\n        return oldBusinessObject.get('camunda:name') === oldBinding.name;\n      });\n    } else {\n      return find(businessObject.get('camunda:outputParameters'), function(oldBusinessObject) {\n        if (oldBinding.scriptFormat) {\n          const definition = oldBusinessObject.get('camunda:definition');\n\n          return definition && definition.get('camunda:value') === oldBinding.source;\n        } else {\n          return oldBusinessObject.get('camunda:value') === oldBinding.source;\n        }\n      });\n    }\n\n  }\n\n  if (oldBindingType === 'camunda:property') {\n    if (!businessObject || !businessObject.get('values') || !businessObject.get('values').length) {\n      return;\n    }\n\n    businessObject = findExtension(businessObject, 'camunda:Properties');\n\n    if (!businessObject) {\n      return;\n    }\n\n    return find(businessObject.get('values'), function(oldBusinessObject) {\n      return oldBusinessObject.get('camunda:name') === oldBinding.name;\n    });\n  }\n\n  if (oldBindingType === 'camunda:errorEventDefinition') {\n    return findCamundaErrorEventDefinition(element, oldBinding.errorRef);\n  }\n}\n\n/**\n * Find old property matching specified new property.\n *\n * @param {Object} oldTemplate\n * @param {Object} newProperty\n *\n * @returns {Object}\n */\nfunction findOldProperty(oldTemplate, newProperty) {\n  if (!oldTemplate) {\n    return;\n  }\n\n  const oldProperties = oldTemplate.properties,\n        newBinding = newProperty.binding,\n        newBindingName = newBinding.name,\n        newBindingType = newBinding.type;\n\n  if (newBindingType === 'property') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'property' && oldBindingName === newBindingName;\n    });\n  }\n\n  if (newBindingType === 'camunda:field') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:field' && oldBindingName === newBindingName;\n    });\n  }\n\n  if (newBindingType === 'camunda:in') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'camunda:in') {\n        return;\n      }\n\n      // always override if change from source to source expression or vice versa\n      if ((oldBinding.expression && !newBinding.expression) ||\n        !oldBinding.expression && newBinding.expression) {\n        return;\n      }\n\n      return oldBinding.target === newBinding.target;\n    });\n  }\n\n  if (newBindingType === 'camunda:in:businessKey') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:in:businessKey';\n    });\n  }\n\n  if (newBindingType === 'camunda:out') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:out' && (\n        oldBinding.source === newBinding.source ||\n        oldBinding.sourceExpression === newBinding.sourceExpression\n      );\n    });\n  }\n\n  if (newBindingType === 'camunda:inputParameter') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'camunda:inputParameter') {\n        return;\n      }\n\n      return oldBindingName === newBindingName\n        && oldBinding.scriptFormat === newBinding.scriptFormat;\n    });\n  }\n\n  if (newBindingType === 'camunda:outputParameter') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingType = oldBinding.type;\n\n      if (oldBindingType !== 'camunda:outputParameter') {\n        return;\n      }\n\n      return oldBinding.source === newBinding.source\n        && oldBinding.scriptFormat === newBinding.scriptFormat;\n    });\n  }\n\n  if (newBindingType === 'camunda:property') {\n    return find(oldProperties, function(oldProperty) {\n      const oldBinding = oldProperty.binding,\n            oldBindingName = oldBinding.name,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:property' && oldBindingName === newBindingName;\n    });\n  }\n\n  if (newBindingType === 'camunda:errorEventDefinition') {\n    return find(oldProperties, function(oldProperty) {\n      const newBindingRef = newBinding.errorRef,\n            oldBinding = oldProperty.binding,\n            oldBindingRef = oldBinding.errorRef,\n            oldBindingType = oldBinding.type;\n\n      return oldBindingType === 'camunda:errorEventDefinition'\n        && oldBindingRef === newBindingRef;\n    });\n  }\n}\n\nfunction findOldScopeElement(element, scopeTemplate, template) {\n  const scopeName = scopeTemplate.type,\n        id = scopeTemplate.id;\n\n  if (scopeName === 'camunda:Connector') {\n    return findExtension(element, 'camunda:Connector');\n  }\n\n  if (scopeName === 'bpmn:Error') {\n\n    // (1) find by error event definition binding\n    const errorEventDefinitionBinding = findErrorEventDefinitionBinding(template, id);\n\n    if (!errorEventDefinitionBinding) {\n      return;\n    }\n\n    // (2) find error event definition\n    const errorEventDefinition = findOldBusinessObject(element, errorEventDefinitionBinding);\n\n    if (!errorEventDefinition) {\n      return;\n    }\n\n    // (3) retrieve referenced error\n    return errorEventDefinition.errorRef;\n  }\n}\n\nfunction isRootElementScope(scopeName) {\n  return [ 'bpmn:Error' ].includes(scopeName);\n}\n\nfunction findOldScopeTemplate(scopeTemplate, oldTemplate) {\n  const scopeName = scopeTemplate.type,\n        scopeId = scopeTemplate.id,\n        scopes = oldTemplate && handleLegacyScopes(oldTemplate.scopes);\n\n  return scopes && find(scopes, function(scope) {\n\n    if (isRootElementScope(scopeName)) {\n      return scope.id === scopeId;\n    }\n\n    return scope.type === scopeName;\n  });\n}\n\nfunction findErrorEventDefinitionBinding(template, templateErrorId) {\n  return find(template.properties, function(property) {\n    return property.binding.errorRef === templateErrorId;\n  });\n}\n\n/**\n * Check whether property was changed after being set by template.\n *\n * @param {djs.model.Base|ModdleElement} element\n * @param {Object} oldProperty\n *\n * @returns {boolean}\n */\nfunction propertyChanged(element, oldProperty) {\n  const businessObject = getBusinessObject(element);\n\n  const oldBinding = oldProperty.binding,\n        oldBindingName = oldBinding.name,\n        oldBindingType = oldBinding.type,\n        oldPropertyValue = oldProperty.value;\n\n  let conditionExpression,\n      definition;\n\n  if (oldBindingType === 'property') {\n    if (oldBindingName === 'conditionExpression') {\n      conditionExpression = businessObject.get('bpmn:conditionExpression');\n\n      return conditionExpression.get('bpmn:body') !== oldPropertyValue;\n    }\n\n    return businessObject.get(oldBindingName) !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:field') {\n    return businessObject.get('camunda:string') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:in') {\n    if (oldBinding.expression) {\n      return businessObject.get('sourceExpression') !== oldPropertyValue;\n    } else {\n      return businessObject.get('camunda:source') !== oldPropertyValue;\n    }\n  }\n\n  if (oldBindingType === 'camunda:in:businessKey') {\n    return businessObject.get('camunda:businessKey') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:out') {\n    return businessObject.get('camunda:target') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:inputParameter') {\n    if (oldBinding.scriptFormat) {\n      definition = businessObject.get('camunda:definition');\n\n      return definition && definition.get('camunda:value') !== oldPropertyValue;\n    } else {\n      return businessObject.get('camunda:value') !== oldPropertyValue;\n    }\n  }\n\n  if (oldBindingType === 'camunda:outputParameter') {\n    return businessObject.get('camunda:name') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:property') {\n    return businessObject.get('camunda:value') !== oldPropertyValue;\n  }\n\n  if (oldBindingType === 'camunda:errorEventDefinition') {\n    return businessObject.get('expression') !== oldPropertyValue;\n  }\n}\n\nfunction remove(array, item) {\n  const index = array.indexOf(item);\n\n  if (isUndefined(index)) {\n    return array;\n  }\n\n  array.splice(index, 1);\n\n  return array;\n}","import { getLabel, setLabel } from 'bpmn-js/lib/features/label-editing/LabelUtil';\nimport { getShapeIdFromPlane, isPlane } from 'bpmn-js/lib/util/DrilldownUtil';\nimport { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\nexport default class RemoveElementTemplateHandler {\n  constructor(\n      modeling,\n      elementFactory,\n      elementRegistry,\n      canvas,\n      bpmnFactory,\n      replace,\n      commandStack\n  ) {\n    this._modeling = modeling;\n    this._elementFactory = elementFactory;\n    this._elementRegistry = elementRegistry;\n    this._canvas = canvas;\n    this._bpmnFactory = bpmnFactory;\n    this._replace = replace;\n    this._commandStack = commandStack;\n  }\n\n  preExecute(context) {\n    const {\n      element\n    } = context;\n\n    if (element.parent) {\n      context.newElement = this._removeTemplate(element);\n    } else {\n      context.newElement = this._removeRootTemplate(element);\n    }\n  }\n\n  _removeTemplate(element) {\n    const replace = this._replace;\n\n    const businessObject = getBusinessObject(element);\n\n    const type = businessObject.$type,\n          eventDefinitionType = this._getEventDefinitionType(businessObject);\n\n    const newBusinessObject = this._createBlankBusinessObject(element);\n\n    return replace.replaceElement(element,\n      {\n        type: type,\n        businessObject: newBusinessObject,\n        eventDefinitionType: eventDefinitionType,\n      },\n      {\n        createElementsBehavior: false\n      }\n    );\n  }\n\n  /**\n   * Remove template from a given element.\n   *\n   * @param {djs.model.Base} element\n   *\n   * @return {djs.model.Base} the updated element\n   */\n  _removeRootTemplate(element) {\n    var modeling = this._modeling,\n        elementFactory = this._elementFactory,\n        elementRegistry = this._elementRegistry,\n        canvas = this._canvas;\n\n    // We are inside a collapsed subprocess, move up to the parent before replacing the collapsed object\n    if (isPlane(element)) {\n      const shapeId = getShapeIdFromPlane(element);\n      const shape = elementRegistry.get(shapeId);\n\n      if (shape && shape !== element) {\n        canvas.setRootElement(canvas.findRoot(shape));\n        return this._removeTemplate(shape);\n      }\n    }\n\n    const businessObject = getBusinessObject(element);\n\n    const type = businessObject.$type;\n\n    const newBusinessObject = this._createBlankBusinessObject(element);\n\n    const newRoot = elementFactory.create('root', {\n      type: type,\n      businessObject: newBusinessObject\n    });\n\n    this._commandStack.execute('canvas.updateRoot', {\n      newRoot: newRoot,\n      oldRoot: element\n    });\n\n    modeling.moveElements(element.children, { x: 0, y: 0 }, newRoot);\n\n    return newRoot;\n  }\n\n  _getEventDefinitionType(businessObject) {\n    if (!businessObject.eventDefinitions) {\n      return null;\n    }\n\n    const eventDefinition = businessObject.eventDefinitions[ 0 ];\n\n    if (!eventDefinition) {\n      return null;\n    }\n\n    return eventDefinition.$type;\n  }\n\n  _createBlankBusinessObject(element) {\n    const bpmnFactory = this._bpmnFactory;\n\n    const bo = getBusinessObject(element),\n          newBo = bpmnFactory.create(bo.$type),\n          label = getLabel(element);\n\n    if (!label) {\n      return newBo;\n    }\n\n    if (is(element, 'bpmn:Group')) {\n      newBo.categoryValueRef = bpmnFactory.create('bpmn:CategoryValue');\n    }\n\n    setLabel({ businessObject: newBo }, label);\n\n    return newBo;\n  }\n}\n\n\nRemoveElementTemplateHandler.$inject = [\n  'modeling',\n  'elementFactory',\n  'elementRegistry',\n  'canvas',\n  'bpmnFactory',\n  'replace',\n  'commandStack'\n];\n","export default class UnlinkElementTemplateHandler {\n  constructor(commandStack) {\n    this._commandStack = commandStack;\n  }\n\n  preExecute(context) {\n    const {\n      element,\n      oldTemplate\n    } = context;\n\n    this._commandStack.execute('propertiesPanel.camunda.changeTemplate', {\n      element,\n      oldTemplate,\n      newTemplate: null\n    });\n  }\n}\n\n\nUnlinkElementTemplateHandler.$inject = [ 'commandStack' ];","import ChangeElementTemplateHandler from './ChangeElementTemplateHandler';\nimport RemoveElementTemplateHandler from './RemoveElementTemplateHandler';\nimport UnlinkElementTemplateHandler from './UnlinkElementTemplateHandler';\nimport MultiCommandHandler from './MultiCommandHandler';\n\nexport default class ElementTemplatesCommands {\n  constructor(commandStack, elementTemplates, eventBus) {\n    commandStack.registerHandler(\n      'element-templates.multi-command-executor',\n      MultiCommandHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.camunda.changeTemplate',\n      ChangeElementTemplateHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.removeTemplate',\n      RemoveElementTemplateHandler\n    );\n\n    commandStack.registerHandler(\n      'propertiesPanel.unlinkTemplate',\n      UnlinkElementTemplateHandler\n    );\n\n    // apply default element templates on shape creation\n    eventBus.on([ 'commandStack.shape.create.postExecuted' ], function(event) {\n      const {\n        context: {\n          hints = {},\n          shape\n        }\n      } = event;\n\n      if (hints.createElementsBehavior !== false) {\n        applyDefaultTemplate(shape, elementTemplates, commandStack);\n      }\n    });\n\n    // apply default element templates on connection creation\n    eventBus.on([ 'commandStack.connection.create.postExecuted' ], function(event) {\n      const {\n        context: {\n          hints = {},\n          connection\n        }\n      } = event;\n\n      if (hints.createElementsBehavior !== false) {\n        applyDefaultTemplate(connection, elementTemplates, commandStack);\n      }\n    });\n  }\n}\n\nElementTemplatesCommands.$inject = [ 'commandStack', 'elementTemplates', 'eventBus' ];\n\nfunction applyDefaultTemplate(element, elementTemplates, commandStack) {\n\n  if (!elementTemplates.get(element) && elementTemplates.getDefault(element)) {\n\n    const command = 'propertiesPanel.camunda.changeTemplate';\n    const commandContext = {\n      element: element,\n      newTemplate: elementTemplates.getDefault(element)\n    };\n\n    commandStack.execute(command, commandContext);\n  }\n}\n","import ElementTemplateCommands from './ElementTemplateCommands';\n\nexport default {\n  __init__: [ 'elementTemplateCommands' ],\n  elementTemplateCommands: [ 'type', ElementTemplateCommands ]\n};","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getBusinessObject, is } from 'bpmn-js/lib/util/ModelUtil';\n\n/**\n * This Behavior checks if the new element's type is in\n * the list of elements the template applies to and unlinks\n * it if not.\n */\nexport default class ReplaceBehavior extends CommandInterceptor {\n  constructor(elementTemplates, injector) {\n    super(injector.get('eventBus'));\n\n    this.postExecuted('shape.replace', function(e) {\n      var context = e.context,\n          oldShape = context.oldShape,\n          oldBo = getBusinessObject(oldShape),\n          newShape = context.newShape,\n          newBo = getBusinessObject(newShape);\n\n      if (!oldBo.modelerTemplate) {\n        return;\n      }\n\n      const template = newBo.modelerTemplate;\n      const version = newBo.modelerTemplateVersion;\n\n      const elementTemplate = elementTemplates.get(template, version);\n\n      if (!elementTemplate) {\n        elementTemplates.unlinkTemplate(newShape, injector);\n        return;\n      }\n\n      const { appliesTo, elementType } = elementTemplate;\n\n      if (elementType) {\n        if (!is(newShape, elementType.value)) {\n          elementTemplates.unlinkTemplate(newShape, injector);\n        }\n\n        return;\n      }\n\n      const allowed = appliesTo.reduce((allowed, type) => {\n        return allowed || is(newBo, type);\n      }, false);\n\n      if (!allowed) {\n        elementTemplates.unlinkTemplate(newShape, injector);\n      }\n    });\n  }\n}\n\nReplaceBehavior.$inject = [\n  'elementTemplates',\n  'injector'\n];\n","import ReplaceBehavior from './ReplaceBehavior';\n\nexport default {\n  __init__: [\n    'elementTemplatesReplaceBehavior'\n  ],\n  elementTemplatesReplaceBehavior: [ 'type', ReplaceBehavior ]\n};\n","import ElementTemplates from '../ElementTemplates';\nimport ElementTemplatesLoader from '../ElementTemplatesLoader';\n\nimport commandsModule from '../cmd';\nimport behaviorModule from '../behavior';\n\nexport default {\n  __depends__: [\n    commandsModule,\n    behaviorModule\n  ],\n  __init__: [\n    'elementTemplatesLoader'\n  ],\n  elementTemplates: [ 'type', ElementTemplates ],\n  elementTemplatesLoader: [ 'type', ElementTemplatesLoader ]\n};\n","export const CAMUNDA_ERROR_EVENT_DEFINITION_TYPE = 'camunda:errorEventDefinition';\nexport const CAMUNDA_EXECUTION_LISTENER_TYPE = 'camunda:executionListener';\nexport const CAMUNDA_FIELD_TYPE = 'camunda:field';\nexport const CAMUNDA_IN_BUSINESS_KEY_TYPE = 'camunda:in:businessKey';\nexport const CAMUNDA_IN_TYPE = 'camunda:in';\nexport const CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter';\nexport const CAMUNDA_OUT_TYPE = 'camunda:out';\nexport const CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter';\nexport const CAMUNDA_PROPERTY_TYPE = 'camunda:property';\nexport const PROPERTY_TYPE = 'property';\n\nexport const EXTENSION_BINDING_TYPES = [\n  CAMUNDA_ERROR_EVENT_DEFINITION_TYPE,\n  CAMUNDA_FIELD_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_PROPERTY_TYPE\n];\n\nexport const IO_BINDING_TYPES = [\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE\n];\n\nexport const IN_OUT_BINDING_TYPES = [\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE\n];","import {\n  forEach,\n  find,\n  groupBy,\n  isArray,\n  isString,\n  isUndefined\n} from 'min-dash';\n\nimport { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport {\n  Group,\n  SelectEntry, isSelectEntryEdited,\n  CheckboxEntry, isCheckboxEntryEdited,\n  TextAreaEntry, isTextAreaEntryEdited,\n  TextFieldEntry, isTextFieldEntryEdited\n} from '@bpmn-io/properties-panel';\n\nimport { PropertyDescription } from '../../../components/PropertyDescription';\n\nimport {\n  findCamundaErrorEventDefinition,\n  findCamundaInOut,\n  findCamundaProperty,\n  findExtension,\n  findExtensions,\n  findInputParameter,\n  findOutputParameter\n} from '../../Helper';\n\nimport {\n  createElement,\n  getRoot\n} from '../../../utils/ElementUtil';\n\nimport {\n  createCamundaErrorEventDefinition,\n  createCamundaFieldInjection,\n  createCamundaIn,\n  createCamundaInWithBusinessKey,\n  createCamundaOut,\n  createCamundaProperty,\n  createError,\n  createInputParameter,\n  createOutputParameter\n} from '../../CreateHelper';\n\nimport {\n  CAMUNDA_ERROR_EVENT_DEFINITION_TYPE,\n  CAMUNDA_EXECUTION_LISTENER_TYPE,\n  CAMUNDA_FIELD_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_PROPERTY_TYPE,\n  PROPERTY_TYPE,\n  EXTENSION_BINDING_TYPES,\n  IO_BINDING_TYPES,\n  IN_OUT_BINDING_TYPES\n} from '../../util/bindingTypes';\n\nconst PRIMITIVE_MODDLE_TYPES = [\n  'Boolean',\n  'Integer',\n  'String'\n];\n\nexport function CustomProperties(props) {\n  const {\n    element,\n    elementTemplate,\n    injector\n  } = props;\n\n  const translate = injector.get('translate');\n\n  const groups = [];\n\n  const {\n    id,\n    properties,\n    groups: propertyGroups,\n    scopes\n  } = elementTemplate;\n\n  // (1) group properties by group id\n  const groupedProperties = groupByGroupId(properties);\n  const defaultProps = [];\n\n  forEach(groupedProperties, (properties, groupId) => {\n\n    const group = findCustomGroup(propertyGroups, groupId);\n\n    if (!group) {\n      return defaultProps.push(...properties);\n    }\n\n    addCustomGroup(groups, {\n      element,\n      id: `ElementTemplates__CustomProperties-${groupId}`,\n      label: translate(group.label),\n      properties: properties,\n      templateId: `${id}-${groupId}`\n    });\n  });\n\n  // (2) add default custom props\n  if (defaultProps.length) {\n    addCustomGroup(groups, {\n      id: 'ElementTemplates__CustomProperties',\n      label: translate('Custom properties'),\n      element,\n      properties: defaultProps,\n      templateId: id\n    });\n  }\n\n  // (3) add custom scopes props\n  if (isArray(scopes)) {\n    scopes.forEach((scope) => {\n      const {\n        properties,\n        type\n      } = scope;\n\n      const id = type.replace(/:/g, '-');\n\n      addCustomGroup(groups, {\n        element,\n        id: `ElementTemplates__CustomGroup-${ id }`,\n        label: translate(`Custom properties for scope <${ type }>`),\n        properties,\n        templateId: id,\n        scope\n      });\n    });\n  }\n\n  return groups;\n}\n\nfunction addCustomGroup(groups, props) {\n\n  const {\n    element,\n    id,\n    label,\n    properties,\n    scope,\n    templateId\n  } = props;\n\n  const customPropertiesGroup = {\n    id,\n    label,\n    component: Group,\n    entries: [],\n    shouldOpen: false\n  };\n\n  properties.forEach((property, index) => {\n    const entry = createCustomEntry(\n      `custom-entry-${ templateId }-${ index }`,\n      element,\n      property,\n      scope\n    );\n\n    if (entry) {\n      customPropertiesGroup.entries.push(entry);\n    }\n  });\n\n  if (customPropertiesGroup.entries.length) {\n    groups.push(customPropertiesGroup);\n  }\n}\n\nfunction createCustomEntry(id, element, property, scope) {\n  let { type } = property;\n\n  if (!type) {\n    type = getDefaultType(property);\n  }\n\n  if (type === 'Boolean') {\n    return {\n      id,\n      component: BooleanProperty,\n      isEdited: isCheckboxEntryEdited,\n      property,\n      scope\n    };\n  }\n\n  if (type === 'Dropdown') {\n    return {\n      id,\n      component: DropdownProperty,\n      isEdited: isSelectEntryEdited,\n      property,\n      scope\n    };\n  }\n\n  if (type === 'String') {\n    return {\n      id,\n      component: StringProperty,\n      isEdited: isTextFieldEntryEdited,\n      property,\n      scope\n    };\n  }\n\n  if (type === 'Text') {\n    return {\n      id,\n      component: TextAreaProperty,\n      isEdited: isTextAreaEntryEdited,\n      property,\n      scope\n    };\n  }\n}\n\nfunction getDefaultType(property) {\n  const { binding } = property;\n\n  const { type } = binding;\n\n  if ([\n    PROPERTY_TYPE,\n    CAMUNDA_PROPERTY_TYPE,\n    CAMUNDA_IN_TYPE,\n    CAMUNDA_IN_BUSINESS_KEY_TYPE,\n    CAMUNDA_OUT_TYPE,\n    CAMUNDA_FIELD_TYPE\n  ].includes(type)) {\n    return 'String';\n  }\n\n  if (type === CAMUNDA_EXECUTION_LISTENER_TYPE) {\n    return 'Hidden';\n  }\n}\n\nfunction BooleanProperty(props) {\n  const {\n    element,\n    id,\n    property,\n    scope\n  } = props;\n\n  const {\n    description,\n    editable,\n    label\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        translate = useService('translate');\n\n  return CheckboxEntry({\n    element,\n    getValue: propertyGetter(element, property, scope),\n    id,\n    label: label ? translate(label) : label,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property, scope),\n    disabled: editable === false\n  });\n}\n\nfunction DropdownProperty(props) {\n  const {\n    element,\n    id,\n    property,\n    scope\n  } = props;\n\n  const {\n    description,\n    editable,\n    label\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        translate = useService('translate');\n\n  const getOptions = () => {\n    const { choices } = property;\n\n    return choices.map(({ name, value }) => {\n      return {\n        label: translate(name),\n        value\n      };\n    });\n  };\n\n  return SelectEntry({\n    element,\n    id,\n    label: label ? translate(label) : label,\n    getOptions,\n    description: PropertyDescription({ description }),\n    getValue: propertyGetter(element, property, scope),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property, scope),\n    disabled: editable === false,\n    validate: propertyValidator(translate, property)\n  });\n}\n\nfunction StringProperty(props) {\n  const {\n    element,\n    id,\n    property,\n    scope\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    placeholder\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  return TextFieldEntry({\n    debounce,\n    element,\n    getValue: propertyGetter(element, property, scope),\n    id,\n    placeholder,\n    label: label ? translate(label) : label,\n    description: PropertyDescription({ description }),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property, scope),\n    validate: propertyValidator(translate, property),\n    disabled: editable === false\n  });\n}\n\nfunction TextAreaProperty(props) {\n  const {\n    element,\n    id,\n    property,\n    scope\n  } = props;\n\n  const {\n    description,\n    editable,\n    label,\n    placeholder\n  } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  return TextAreaEntry({\n    debounce,\n    element,\n    id,\n    placeholder,\n    label: label ? translate(label) : label,\n    description: PropertyDescription({ description }),\n    getValue: propertyGetter(element, property, scope),\n    setValue: propertySetter(bpmnFactory, commandStack, element, property, scope),\n    disabled: editable === false,\n    validate: propertyValidator(translate, property)\n  });\n}\n\nfunction propertyGetter(element, property, scope) {\n  return function getValue() {\n    let businessObject = getBusinessObject(element);\n\n    const {\n      binding,\n      value: defaultValue = ''\n    } = property;\n\n    const {\n      name,\n      type\n    } = binding;\n\n    if (scope) {\n      businessObject = getScopeBusinessObject(businessObject, scope);\n\n      if (!businessObject) {\n        return defaultValue;\n      }\n    }\n\n    // property\n    if (type === 'property') {\n      const value = businessObject.get(name);\n\n      if (name === 'conditionExpression') {\n        if (value) {\n          return value.get('body');\n        }\n\n        return defaultValue;\n      } else {\n        if (!isUndefined(value)) {\n          return value;\n        }\n\n        return defaultValue;\n      }\n    }\n\n    // camunda:ErrorEventDefinition\n    if (type === CAMUNDA_ERROR_EVENT_DEFINITION_TYPE) {\n      const { errorRef } = binding;\n\n      const errorEventDefinition = findCamundaErrorEventDefinition(businessObject, errorRef);\n\n      if (errorEventDefinition) {\n        return errorEventDefinition.get('camunda:expression');\n      } else {\n        return '';\n      }\n    }\n\n    // camunda:Field\n    if (type === CAMUNDA_FIELD_TYPE) {\n      const camundaFields = findExtensions(businessObject, [ 'camunda:Field' ]);\n\n      const camundaField = camundaFields.find((camundaField) => {\n        return camundaField.get('camunda:name') === name;\n      });\n\n      if (camundaField) {\n        return camundaField.get('camunda:string') || camundaField.get('camunda:expression');\n      } else {\n        return '';\n      }\n    }\n\n    // camunda:Property\n    if (type === CAMUNDA_PROPERTY_TYPE) {\n      let camundaProperties;\n\n      if (scope) {\n\n        // TODO(philippfromme): as only bpmn:Error and camunda:Connector are supported this code is practically dead\n        camundaProperties = businessObject.get('properties');\n      } else {\n        camundaProperties = findExtension(businessObject, 'camunda:Properties');\n      }\n\n      if (camundaProperties) {\n        const camundaProperty = findCamundaProperty(camundaProperties, binding);\n\n        if (camundaProperty) {\n          return camundaProperty.get('camunda:value');\n        }\n      }\n\n      return defaultValue;\n    }\n\n    if (IO_BINDING_TYPES.includes(type)) {\n      let inputOutput;\n\n      if (scope) {\n        inputOutput = businessObject.get('inputOutput');\n      } else {\n        inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n      }\n\n      if (!inputOutput) {\n        return defaultValue;\n      }\n\n      // camunda:InputParameter\n      if (type === CAMUNDA_INPUT_PARAMETER_TYPE) {\n        const inputParameter = findInputParameter(inputOutput, binding);\n\n        if (inputParameter) {\n          const { scriptFormat } = binding;\n\n          if (scriptFormat) {\n            const definition = inputParameter.get('camunda:definition');\n\n            if (definition) {\n              return definition.get('camunda:value');\n            }\n          } else {\n            return inputParameter.get('value') || '';\n          }\n        }\n\n        return defaultValue;\n      }\n\n      // camunda:OutputParameter\n      if (type === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n        const outputParameter = findOutputParameter(inputOutput, binding);\n\n        if (outputParameter) {\n          return outputParameter.get('camunda:name');\n        }\n\n        return defaultValue;\n      }\n    }\n\n    // camunda:In and camunda:Out\n    if (IN_OUT_BINDING_TYPES.includes(type)) {\n      const camundaInOut = findCamundaInOut(businessObject, binding);\n\n      if (camundaInOut) {\n        if (type === CAMUNDA_IN_BUSINESS_KEY_TYPE) {\n          return camundaInOut.get('camunda:businessKey');\n        } else if (type === CAMUNDA_OUT_TYPE) {\n          return camundaInOut.get('camunda:target');\n        } else if (type === CAMUNDA_IN_TYPE) {\n          const { expression } = binding;\n\n          if (expression) {\n            return camundaInOut.get('camunda:sourceExpression');\n          } else {\n            return camundaInOut.get('camunda:source');\n          }\n        }\n      }\n\n      return defaultValue;\n    }\n\n    // should never throw as templates are validated beforehand\n    throw unknownBindingError(element, property);\n  };\n}\n\nfunction propertySetter(bpmnFactory, commandStack, element, property, scope) {\n  return function setValue(value) {\n    let businessObject = getBusinessObject(element);\n\n    const { binding } = property;\n\n    const {\n      name,\n      type\n    } = binding;\n\n    const rootElement = getRoot(businessObject);\n\n    let extensionElements;\n\n    let propertyValue;\n\n    const commands = [];\n\n    if (EXTENSION_BINDING_TYPES.includes(type)) {\n      extensionElements = businessObject.get('extensionElements');\n\n      if (!extensionElements) {\n        extensionElements = createElement('bpmn:ExtensionElements', null, businessObject, bpmnFactory);\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: businessObject,\n            properties: { extensionElements }\n          }\n        });\n      }\n    }\n\n    if (scope) {\n      businessObject = getScopeBusinessObject(businessObject, scope);\n\n      if (!businessObject) {\n\n        // bpmn:Error\n        if (scope.type === 'bpmn:Error') {\n          businessObject = createError(scope.id, rootElement, bpmnFactory);\n\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: rootElement,\n              properties: { rootElements: [ ...rootElement.get('rootElements'), businessObject ] }\n            }\n          });\n        } else {\n          businessObject = createElement(scope.type, null, element, bpmnFactory);\n\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: extensionElements,\n              properties: { values: [ ...extensionElements.get('values'), businessObject ] }\n            }\n          });\n        }\n      }\n    }\n\n    // property\n    if (type === 'property') {\n\n      if (name === 'conditionExpression') {\n        const { scriptFormat } = binding;\n\n        propertyValue = createElement('bpmn:FormalExpression', {\n          body: value,\n          language: scriptFormat\n        }, businessObject, bpmnFactory);\n      } else {\n        const propertyDescriptor = businessObject.$descriptor.propertiesByName[ name ];\n\n        const { type: propertyType } = propertyDescriptor;\n\n        // do not override non-primitive types\n        if (!PRIMITIVE_MODDLE_TYPES.includes(propertyType)) {\n          throw new Error(`cannot set property of type <${ propertyType }>`);\n        }\n\n        if (propertyType === 'Boolean') {\n          propertyValue = !!value;\n        } else if (propertyType === 'Integer') {\n          propertyValue = parseInt(value, 10);\n\n          if (isNaN(propertyValue)) {\n\n            // do not set NaN value\n            propertyValue = undefined;\n          }\n        } else {\n\n          // make sure we don't remove the property\n          propertyValue = value || '';\n        }\n      }\n\n      if (!isUndefined(propertyValue)) {\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: businessObject,\n            properties: { [ name ]: propertyValue }\n          }\n        });\n      }\n    }\n\n    // camunda:ErrorEventDefinition\n    if (type === CAMUNDA_ERROR_EVENT_DEFINITION_TYPE) {\n      const { errorRef } = binding;\n\n      const oldCamundaErrorEventDefinition = findCamundaErrorEventDefinition(businessObject, errorRef);\n\n      if (oldCamundaErrorEventDefinition) {\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: oldCamundaErrorEventDefinition,\n            properties: { 'camunda:expression': value }\n          }\n        });\n      } else {\n        const newError = createError(binding.errorRef, rootElement, bpmnFactory),\n              newCamundaErrorEventDefinition = createCamundaErrorEventDefinition(value, newError, extensionElements, bpmnFactory);\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: rootElement,\n            properties: { rootElements: [ ...rootElement.get('rootElements'), newError ] }\n          }\n        });\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: extensionElements,\n            properties: { values: [ ...extensionElements.get('values'), newCamundaErrorEventDefinition ] }\n          }\n        });\n      }\n    }\n\n    // camunda:Field\n    if (type === CAMUNDA_FIELD_TYPE) {\n      const oldCamundaFields = findExtensions(businessObject, [ 'camunda:Field' ]);\n\n      const newCamundaFields = [];\n\n      if (oldCamundaFields.length) {\n        oldCamundaFields.forEach((camundaField) => {\n          if (camundaField.name === name) {\n            newCamundaFields.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n          } else {\n            newCamundaFields.push(camundaField);\n          }\n        });\n      } else {\n        newCamundaFields.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n      }\n\n      const values = extensionElements.get('values').filter((value) => !oldCamundaFields.includes(value));\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          moddleElement: extensionElements,\n          properties: {\n            values:\n            [ ...values, ...newCamundaFields ]\n          }\n        }\n      });\n    }\n\n    // camunda:Property\n    if (type === CAMUNDA_PROPERTY_TYPE) {\n      let camundaProperties;\n\n      if (scope) {\n        camundaProperties = businessObject.get('properties');\n      } else {\n        camundaProperties = findExtension(extensionElements, 'camunda:Properties');\n      }\n\n      if (!camundaProperties) {\n        camundaProperties = createElement('camunda:Properties', null, businessObject, bpmnFactory);\n\n        if (scope) {\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: businessObject,\n              properties: { properties: camundaProperties }\n            }\n          });\n        } else {\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: extensionElements,\n              properties: { values: [ ...extensionElements.get('values'), camundaProperties ] }\n            }\n          });\n        }\n      }\n\n      const oldCamundaProperty = findCamundaProperty(camundaProperties, binding);\n\n      const newCamundaProperty = createCamundaProperty(binding, value, bpmnFactory);\n\n      const values = camundaProperties.get('values').filter((value) => value !== oldCamundaProperty);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          moddleElement: camundaProperties,\n          properties: { values: [ ...values, newCamundaProperty ] }\n        }\n      });\n    }\n\n    if (IO_BINDING_TYPES.includes(type)) {\n      let inputOutput;\n\n      if (scope) {\n        inputOutput = businessObject.get('inputOutput');\n      } else {\n        inputOutput = findExtension(extensionElements, 'camunda:InputOutput');\n      }\n\n      if (!inputOutput) {\n        inputOutput = createElement('camunda:InputOutput', null, businessObject, bpmnFactory);\n\n        if (scope) {\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: businessObject,\n              properties: { inputOutput }\n            }\n          });\n        }\n        else {\n          commands.push({\n            cmd: 'element.updateModdleProperties',\n            context: {\n              element,\n              moddleElement: extensionElements,\n              properties: { values: [ ...extensionElements.get('values'), inputOutput ] }\n            }\n          });\n        }\n      }\n\n      // camunda:InputParameter\n      if (type === CAMUNDA_INPUT_PARAMETER_TYPE) {\n        const oldCamundaInputParameter = findInputParameter(inputOutput, binding);\n\n        const newCamundaInputParameter = createInputParameter(binding, value, bpmnFactory);\n\n        const values = inputOutput.get('camunda:inputParameters').filter((value) => value !== oldCamundaInputParameter);\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: inputOutput,\n            properties: { 'camunda:inputParameters': [ ...values, newCamundaInputParameter ] }\n          }\n        });\n      }\n\n      // camunda:OutputParameter\n      if (type === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n        const oldCamundaOutputParameter = findOutputParameter(inputOutput, binding);\n\n        const newCamundaOutputParameter = createOutputParameter(binding, value, bpmnFactory);\n\n        const values = inputOutput.get('camunda:outputParameters').filter((value) => value !== oldCamundaOutputParameter);\n\n        commands.push({\n          cmd: 'element.updateModdleProperties',\n          context: {\n            element,\n            moddleElement: inputOutput,\n            properties: { 'camunda:outputParameters': [ ...values, newCamundaOutputParameter ] }\n          }\n        });\n      }\n    }\n\n    // camunda:In and camunda:Out\n    if (IN_OUT_BINDING_TYPES.includes(type)) {\n      const oldCamundaInOut = findCamundaInOut(businessObject, binding);\n\n      let newCamundaInOut;\n\n      if (type === CAMUNDA_IN_TYPE) {\n        newCamundaInOut = createCamundaIn(binding, value, bpmnFactory);\n      } else if (type === CAMUNDA_OUT_TYPE) {\n        newCamundaInOut = createCamundaOut(binding, value, bpmnFactory);\n      } else {\n        newCamundaInOut = createCamundaInWithBusinessKey(value, bpmnFactory);\n      }\n\n      const values = extensionElements.get('values').filter((value) => value !== oldCamundaInOut);\n\n      commands.push({\n        cmd: 'element.updateModdleProperties',\n        context: {\n          element,\n          moddleElement: extensionElements,\n          properties: { values: [ ...values, newCamundaInOut ] }\n        }\n      });\n    }\n\n    if (commands.length) {\n      commandStack.execute(\n        'element-templates.multi-command-executor',\n        commands\n      );\n\n      return;\n    }\n\n    // should never throw as templates are validated beforehand\n    throw unknownBindingError(element, property);\n  };\n}\n\nfunction propertyValidator(translate, property) {\n  return function validate(value) {\n    const { constraints = {} } = property;\n\n    const {\n      maxLength,\n      minLength,\n      notEmpty\n    } = constraints;\n\n    if (notEmpty && isEmptyString(value)) {\n      return translate('Must not be empty.');\n    }\n\n    if (property.feel && isFeel(value)) {\n      return;\n    }\n\n    if (maxLength && value.length > maxLength) {\n      return translate('Must have max length {maxLength}.', { maxLength });\n    }\n\n    if (minLength && value.length < minLength) {\n      return translate('Must have min length {minLength}.', { minLength });\n    }\n\n    let { pattern } = constraints;\n\n    if (pattern) {\n      let message;\n\n      if (!isString(pattern)) {\n        message = pattern.message;\n        pattern = pattern.value;\n      }\n\n      if (!matchesPattern(value, pattern)) {\n        return message || translate('Must match pattern {pattern}.', { pattern });\n      }\n    }\n  };\n}\n\nfunction getScopeBusinessObject(businessObject, scope) {\n  const {\n    id,\n    type\n  } = scope;\n\n  if (type === 'bpmn:Error') {\n\n    // retrieve error through referenced error event definition\n    const errorEventDefinition = findCamundaErrorEventDefinition(businessObject, id);\n\n    if (errorEventDefinition) {\n      return errorEventDefinition.get('errorRef');\n    }\n  }\n\n  return findExtension(businessObject, type);\n}\n\nfunction unknownBindingError(element, property) {\n  const businessObject = getBusinessObject(element);\n\n  const id = businessObject.get('id');\n\n  const { binding } = property;\n\n  const { type } = binding;\n\n  return new Error(`unknown binding <${ type }> for element <${ id }>, this should never happen`);\n}\n\nfunction isEmptyString(string) {\n  return !string || !string.trim().length;\n}\n\nfunction matchesPattern(string, pattern) {\n  return new RegExp(pattern).test(string);\n}\n\nfunction groupByGroupId(properties) {\n  return groupBy(properties, 'group');\n}\n\nfunction findCustomGroup(groups, id) {\n  return find(groups, g => g.id === id);\n}\n\nfunction isFeel(value) {\n  return isString(value) && value.trim().startsWith('=');\n}","import { without } from 'min-dash';\n\nimport { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { TextFieldEntry } from '@bpmn-io/properties-panel';\n\nimport {\n  findCamundaErrorEventDefinition,\n  findExtensions\n} from '../../Helper';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\n\nexport function ErrorProperties(props) {\n  const {\n    element,\n    index,\n    property,\n    groups\n  } = props;\n\n  const {\n    binding,\n    label\n  } = property;\n\n  const {\n    errorRef\n  } = binding;\n\n  const businessObject = getBusinessObject(element),\n        errorEventDefinitions = findExtensions(businessObject, [ 'camunda:ErrorEventDefinition' ]);\n\n  if (!errorEventDefinitions.length) {\n    return;\n  }\n\n  const errorEventDefinition = findCamundaErrorEventDefinition(element, errorRef);\n\n  const id = `${ element.id }-error-${ index }`;\n\n  let entries = [];\n\n  const errorGroup = groups.find(({ id }) => id === 'CamundaPlatform__Errors');\n  const originalItem = errorGroup.items.find(({ entries }) => entries[0].errorEventDefinition === errorEventDefinition);\n  entries = originalItem.entries;\n\n  // (1) remove global error referenced entry\n  // entries.shift();\n  entries = removeEntry(entries, '-errorRef');\n\n  // (2) remove throw expression input\n  // entries.pop();\n  entries = removeEntry(entries, '-expression');\n\n  // (3) add disabled throw expression input\n  entries.push({\n    id: `${ id }-expression`,\n    component: Expression,\n    errorEventDefinition,\n    property\n  });\n\n  const item = {\n    id,\n    label: label || getErrorLabel(errorEventDefinition),\n    entries\n  };\n\n  return item;\n}\n\nfunction Expression(props) {\n  const {\n    errorEventDefinition,\n    id\n  } = props;\n\n  const translate = useService('translate');\n  const debounce = useService('debounceInput');\n\n  const setValue = () => {};\n\n  const getValue = () => {\n    return errorEventDefinition.get('camunda:expression');\n  };\n\n  return TextFieldEntry({\n    element: errorEventDefinition,\n    id,\n    label: translate('Throw expression'),\n    getValue,\n    setValue,\n    debounce,\n    disabled: true\n  });\n}\n\nfunction removeEntry(entries, suffix) {\n  const entry = entries.find(({ id }) => id.endsWith(suffix));\n\n  return without(entries, entry);\n}\n\nfunction getErrorLabel(errorEventDefinition) {\n  const error = errorEventDefinition.get('errorRef');\n\n  if (!error) {\n    return '<no reference>';\n  }\n\n  const errorCode = error.get('errorCode'),\n        name = error.get('name') || '<unnamed>';\n\n  if (errorCode) {\n    return `${ name } (code = ${ errorCode })`;\n  }\n\n  return name;\n}\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { ToggleSwitchEntry } from '@bpmn-io/properties-panel';\n\nimport {\n  findExtension,\n  findInputParameter\n} from '../../Helper';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport { without } from 'min-dash';\n\nimport { createElement } from '../../../utils/ElementUtil';\n\nimport { PropertyDescription } from '../../../components/PropertyDescription';\n\nimport { createInputParameter } from '../../CreateHelper';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\n\nexport function InputProperties(props) {\n  const {\n    element,\n    index,\n    property,\n    groups\n  } = props;\n\n  const {\n    binding,\n    description,\n    label\n  } = property;\n\n  const { name } = binding;\n\n  const businessObject = getBusinessObject(element),\n        inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n  const inputParameter = inputOutput && findInputParameter(inputOutput, binding);\n\n  const id = `${ element.id }-inputParameter-${ index }`;\n\n  let entries = [];\n\n  if (inputParameter) {\n    const inputGroup = groups.find(({ id }) => id === 'CamundaPlatform__Input');\n    const item = inputGroup.items.find(({ entries }) => entries[0].parameter === inputParameter);\n    entries = item.entries;\n\n    // (1) remove name entry\n    entries = removeEntry(entries, '-name');\n  }\n\n  // (2) add local variable assignment entry\n  entries.unshift({\n    id: `${ id }-local-variable-assignment`,\n    component: LocalVariableAssignment,\n    inputParameter,\n    property\n  });\n\n  // (3) add description entry\n  if (description) {\n    entries.unshift({\n      id: `${ id }-description`,\n      component: Description,\n      text: description\n    });\n  }\n\n  // @barmac: binding#name is required so there is no third option\n  const item = {\n    id,\n    label: label || name,\n    entries\n  };\n\n  return item;\n}\n\n// TODO(philippfromme): add text entry to properties-panel\nfunction Description(props) {\n  const {\n    id,\n    text\n  } = props;\n\n  return <div class=\"bio-properties-panel-entry\" data-entry-id={ id }>\n    <div class=\"bio-properties-panel-description\">\n      <PropertyDescription description={ text } />\n    </div>\n  </div>;\n}\n\nfunction LocalVariableAssignment(props) {\n  const {\n    element,\n    id,\n    property,\n    inputParameter\n  } = props;\n\n  const { binding } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        modeling = useService('modeling'),\n        translate = useService('translate');\n\n  const getValue = () => {\n    return inputParameter;\n  };\n\n  const setValue = (value) => {\n    if (value) {\n      addInputParameter(element, property, bpmnFactory, modeling);\n    } else {\n      removeInputParameter(element, binding, modeling);\n    }\n  };\n\n  return ToggleSwitchEntry({\n    id,\n    label: translate('Local variable assignment'),\n    switcherLabel: inputParameter ?\n      translate('On') :\n      translate('Off'),\n    description: inputParameter ?\n      '' :\n      translate('Parameter won\\'t be created as local variable.'),\n    getValue,\n    setValue\n  });\n}\n\nfunction addInputParameter(element, property, bpmnFactory, modeling) {\n  const {\n    binding,\n    value\n  } = property;\n\n  const businessObject = getBusinessObject(element);\n\n  const extensionElements = businessObject.get('extensionElements');\n  const inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n  let updatedBusinessObject, update;\n\n  if (!extensionElements) {\n    updatedBusinessObject = businessObject;\n\n    const extensionElements = createExtensionElements(businessObject, bpmnFactory),\n          inputOutput = createInputOutput(binding, value, bpmnFactory, extensionElements);\n    extensionElements.values.push(inputOutput);\n\n    update = { extensionElements };\n  } else if (!inputOutput) {\n    updatedBusinessObject = extensionElements;\n\n    const inputOutput = createInputOutput(binding, value, bpmnFactory, extensionElements);\n\n    update = { values: extensionElements.get('values').concat(inputOutput) };\n  } else {\n    updatedBusinessObject = inputOutput;\n\n    const inputParameter = createInputParameter(binding, value, bpmnFactory);\n    inputParameter.$parent = inputOutput;\n\n    update = { inputParameters: inputOutput.get('camunda:inputParameters').concat(inputParameter) };\n  }\n\n  modeling.updateModdleProperties(element, updatedBusinessObject, update);\n}\n\nfunction removeInputParameter(element, binding, modeling) {\n  const businessObject = getBusinessObject(element);\n\n  const inputOutput = findExtension(businessObject, 'camunda:InputOutput'),\n        inputParameters = inputOutput.get('camunda:inputParameters');\n\n  const inputParameter = findInputParameter(inputOutput, binding);\n\n  modeling.updateModdleProperties(element, inputOutput, {\n    inputParameters: without(inputParameters, inputParameter)\n  });\n}\n\nfunction removeEntry(entries, suffix) {\n  const entry = entries.find(({ id }) => id.endsWith(suffix));\n\n  return without(entries, entry);\n}\n\nfunction createExtensionElements(businessObject, bpmnFactory) {\n  return createElement(\n    'bpmn:ExtensionElements',\n    { values: [] },\n    businessObject,\n    bpmnFactory\n  );\n}\n\nfunction createInputOutput(binding, value, bpmnFactory, extensionElements) {\n  const inputParameter = createInputParameter(binding, value, bpmnFactory);\n  const inputOutput = createElement('camunda:InputOutput', {\n    inputParameters: [ inputParameter ],\n    outputParameters: []\n  }, extensionElements, bpmnFactory);\n\n  inputParameter.$parent = inputOutput;\n  return inputOutput;\n}\n","const SPACE_REGEX = /\\s/;\n\n// for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\nconst QNAME_REGEX = /^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i;\n\n// for ID validation as per BPMN Schema (QName - Namespace)\nconst ID_REGEX = /^[a-z_][\\w-.]*$/i;\n\n/**\n * checks whether the id value is valid\n *\n * @param {ModdleElement} element\n * @param {String} idValue\n * @param {Function} translate\n *\n * @return {String} error message\n */\nexport function isIdValid(element, idValue, translate) {\n  const assigned = element.$model.ids.assigned(idValue);\n  const idAlreadyExists = assigned && assigned !== element;\n\n  if (!idValue) {\n    return translate('ID must not be empty.');\n  }\n\n  if (idAlreadyExists) {\n    return translate('ID must be unique.');\n  }\n\n  return validateId(idValue, translate);\n}\n\nexport function validateId(idValue, translate) {\n\n  if (containsSpace(idValue)) {\n    return translate('ID must not contain spaces.');\n  }\n\n  if (!ID_REGEX.test(idValue)) {\n\n    if (QNAME_REGEX.test(idValue)) {\n      return translate('ID must not contain prefix.');\n    }\n\n    return translate('ID must be a valid QName.');\n  }\n}\n\nexport function containsSpace(value) {\n  return SPACE_REGEX.test(value);\n}","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { TextFieldEntry, ToggleSwitchEntry } from '@bpmn-io/properties-panel';\n\nimport { containsSpace } from '../../util/validationUtil';\n\nimport {\n  findExtension,\n  findOutputParameter\n} from '../../Helper';\n\nimport { useService } from 'bpmn-js-properties-panel';\n\nimport { without } from 'min-dash';\n\nimport { PropertyDescription } from '../../../components/PropertyDescription';\n\nimport { createElement } from '../../../utils/ElementUtil';\n\nimport { createOutputParameter } from '../../CreateHelper';\n\n{ /* Required to break up imports, see https://github.com/babel/babel/issues/15156 */ }\n\n\nexport function OutputProperties(props) {\n  const {\n    element,\n    index,\n    injector,\n    property\n  } = props;\n\n  const {\n    binding,\n    description,\n    label\n  } = property;\n\n  const { name } = binding;\n\n  const businessObject = getBusinessObject(element),\n        inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n  const translate = injector.get('translate');\n\n  const outputParameter = inputOutput && findOutputParameter(inputOutput, binding);\n\n  const id = `${ element.id }-outputParameter-${ index }`;\n\n  let entries = [];\n\n  // (1) add description entry\n  if (description) {\n    entries.push({\n      id: `${ id }-description`,\n      component: Description,\n      text: description\n    });\n  }\n\n  // (2) add local variable assignment entry\n  entries.push({\n    id: `${ id }-local-variable-assignment`,\n    component: ProcessVariableAssignment,\n    outputParameter,\n    property\n  });\n\n  if (outputParameter) {\n\n    // (3) add assign to process variable entry\n    entries.push({\n      id: `${ id }-assign-to-process-variable`,\n      component: AssignToProcessVariable,\n      property\n    });\n  }\n\n  const item = {\n    id,\n    label: label || name || translate('<unnamed>'),\n    entries\n  };\n\n  return item;\n}\n\n// TODO(philippfromme): add text entry to properties-panel\nfunction Description(props) {\n  const {\n    id,\n    text\n  } = props;\n\n  return <div class=\"bio-properties-panel-entry\" data-entry-id={ id }>\n    <div class=\"bio-properties-panel-description\">\n      <PropertyDescription description={ text } />\n    </div>\n  </div>;\n}\n\nfunction ProcessVariableAssignment(props) {\n  const {\n    element,\n    id,\n    property,\n    outputParameter\n  } = props;\n\n  const { binding } = property;\n\n  const bpmnFactory = useService('bpmnFactory'),\n        modeling = useService('modeling'),\n        translate = useService('translate');\n\n  const getValue = () => {\n    return outputParameter;\n  };\n\n  const setValue = (value) => {\n    if (value) {\n      addOutputParameter(element, property, bpmnFactory, modeling);\n    } else {\n      removeOutputParameter(element, binding, modeling);\n    }\n  };\n\n  return ToggleSwitchEntry({\n    id,\n    label: translate('Process variable assignment'),\n    switcherLabel: outputParameter ?\n      translate('On') :\n      translate('Off'),\n    description: outputParameter ?\n      '' :\n      translate('Parameter won\\'t be available in process scope.'),\n    getValue,\n    setValue\n  });\n}\n\nfunction AssignToProcessVariable(props) {\n  const {\n    element,\n    id,\n    property\n  } = props;\n\n  const { binding } = property;\n\n  const inputOutput = findExtension(element, 'camunda:InputOutput'),\n        outputParameter = findOutputParameter(inputOutput, binding);\n\n  const commandStack = useService('commandStack'),\n        debounce = useService('debounceInput'),\n        translate = useService('translate');\n\n  const setValue = (value) => {\n    commandStack.execute('element.updateModdleProperties', {\n      element,\n      moddleElement: outputParameter,\n      properties: { name: value }\n    });\n  };\n\n  const getValue = () => {\n    return outputParameter.get('camunda:name');\n  };\n\n  const validate = (value) => {\n    if (!value) {\n      return translate('Process variable name must not be empty.');\n    } else if (containsSpace(value)) {\n      return translate('Process variable name must not contain spaces.');\n    }\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: outputParameter,\n    id,\n    label: translate('Assign to process variable'),\n    getValue,\n    setValue,\n    validate\n  });\n}\n\nfunction addOutputParameter(element, property, bpmnFactory, modeling) {\n  const {\n    binding,\n    value\n  } = property;\n\n  const businessObject = getBusinessObject(element);\n\n  const extensionElements = businessObject.get('extensionElements');\n  const inputOutput = findExtension(businessObject, 'camunda:InputOutput');\n\n  let updatedBusinessObject, update;\n\n  if (!extensionElements) {\n    updatedBusinessObject = businessObject;\n\n    const extensionElements = createExtensionElements(businessObject, bpmnFactory),\n          inputOutput = createInputOutput(binding, value, bpmnFactory, extensionElements);\n    extensionElements.values.push(inputOutput);\n\n    update = { extensionElements };\n  } else if (!inputOutput) {\n    updatedBusinessObject = extensionElements;\n\n    const inputOutput = createInputOutput(binding, value, bpmnFactory, extensionElements);\n\n    update = { values: extensionElements.get('values').concat(inputOutput) };\n  } else {\n    updatedBusinessObject = inputOutput;\n\n    const outputParameter = createOutputParameter(binding, value, bpmnFactory);\n    outputParameter.$parent = inputOutput;\n\n    update = { outputParameters: inputOutput.get('camunda:outputParameters').concat(outputParameter) };\n  }\n\n  modeling.updateModdleProperties(element, updatedBusinessObject, update);\n}\n\nfunction removeOutputParameter(element, binding, modeling) {\n  const businessObject = getBusinessObject(element);\n\n  const inputOutput = findExtension(businessObject, 'camunda:InputOutput'),\n        outputParameters = inputOutput.get('camunda:outputParameters');\n\n  const outputParameter = findOutputParameter(inputOutput, binding);\n\n  modeling.updateModdleProperties(element, inputOutput, {\n    outputParameters: without(outputParameters, outputParameter)\n  });\n}\n\nfunction createExtensionElements(businessObject, bpmnFactory) {\n  return createElement(\n    'bpmn:ExtensionElements',\n    { values: [] },\n    businessObject,\n    bpmnFactory\n  );\n}\n\nfunction createInputOutput(binding, value, bpmnFactory, extensionElements) {\n  const outputParameter = createOutputParameter(binding, value, bpmnFactory);\n  const inputOutput = createElement('camunda:InputOutput', {\n    inputParameters: [],\n    outputParameters: [ outputParameter ],\n  }, extensionElements, bpmnFactory);\n\n  outputParameter.$parent = inputOutput;\n  return inputOutput;\n}\n","import { ListGroup } from '@bpmn-io/properties-panel';\n\nimport {\n  createElementTemplatesGroup,\n  TemplateProps\n} from '../../components';\n\nimport {\n  CustomProperties,\n  ErrorProperties,\n  InputProperties,\n  OutputProperties\n} from './properties';\n\nimport { getTemplateId, getTemplateVersion } from '../Helper';\n\nconst CAMUNDA_ERROR_EVENT_DEFINITION_TYPE = 'camunda:errorEventDefinition',\n      CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter',\n      CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter';\n\nconst LOWER_PRIORITY = 300;\n\nconst ALWAYS_DISPLAYED_GROUPS = [\n  'general',\n  'documentation',\n  'multiInstance'\n];\n\n\nexport default class ElementTemplatesPropertiesProvider {\n\n  constructor(elementTemplates, propertiesPanel, injector) {\n    propertiesPanel.registerProvider(LOWER_PRIORITY, this);\n\n    this._elementTemplates = elementTemplates;\n    this._injector = injector;\n  }\n\n  getGroups(element) {\n    return (groups) => {\n      const injector = this._injector;\n\n      if (!this._shouldShowTemplateProperties(element)) {\n        return groups;\n      }\n\n      const translate = injector.get('translate');\n\n      // (0) Copy provided groups\n      groups = groups.slice();\n\n      const templatesGroup = {\n        element,\n        id: 'ElementTemplates__Template',\n        label: translate('Template'),\n        component: createElementTemplatesGroup({\n          getTemplateId\n        }),\n        entries: TemplateProps({\n          element,\n          elementTemplates: this._elementTemplates,\n          getTemplateId,\n          getTemplateVersion\n        })\n      };\n\n      // (1) Add templates group\n      addGroupsAfter(ALWAYS_DISPLAYED_GROUPS, groups, [ templatesGroup ]);\n\n      const elementTemplate = this._elementTemplates.get(element);\n\n      if (elementTemplate) {\n        const templateSpecificGroups = [].concat(\n          createInputGroup(element, elementTemplate, injector, groups) || [],\n          createOutputGroup(element, elementTemplate, injector, groups) || [],\n          createErrorGroup(element, elementTemplate, injector, groups) || [],\n          CustomProperties({ element, elementTemplate, injector })\n        );\n\n        // (2) add template-specific properties groups\n        addGroupsAfter('ElementTemplates__Template', groups, templateSpecificGroups);\n      }\n\n      // (3) apply entries visible\n      if (getTemplateId(element)) {\n        groups = filterWithEntriesVisible(elementTemplate || {}, groups);\n      }\n\n      return groups;\n    };\n  }\n\n  _shouldShowTemplateProperties(element) {\n    return getTemplateId(element) || this._elementTemplates.getAll(element).length;\n  }\n}\n\nElementTemplatesPropertiesProvider.$inject = [\n  'elementTemplates',\n  'propertiesPanel',\n  'injector'\n];\n\n\n// helper /////////////////////\n\nfunction createInputGroup(element, elementTemplate, injector, groups) {\n  const translate = injector.get('translate');\n\n  const group = {\n    label: translate('Inputs'),\n    id: 'ElementTemplates__Input',\n    component: ListGroup,\n    items: []\n  };\n\n  const properties = elementTemplate.properties.filter(({ binding, type }) => {\n    return !type && binding.type === CAMUNDA_INPUT_PARAMETER_TYPE;\n  });\n\n  properties.forEach((property, index) => {\n    const item = InputProperties({ element, index, property, groups });\n\n    if (item) {\n      group.items.push(item);\n    }\n  });\n\n  // remove if empty\n  if (!group.items.length) {\n    return null;\n  }\n\n  return group;\n}\n\nfunction createOutputGroup(element, elementTemplate, injector, groups) {\n  const translate = injector.get('translate');\n\n  const group = {\n    label: translate('Outputs'),\n    id: 'ElementTemplates__Output',\n    component: ListGroup,\n    items: []\n  };\n\n  const properties = elementTemplate.properties.filter(({ binding, type }) => {\n    return !type && binding.type === CAMUNDA_OUTPUT_PARAMETER_TYPE;\n  });\n\n  properties.forEach((property, index) => {\n    const item = OutputProperties({ element, index, property, injector });\n\n    if (item) {\n      group.items.push(item);\n    }\n  });\n\n  // remove if empty\n  if (!group.items.length) {\n    return null;\n  }\n\n  return group;\n}\n\nfunction createErrorGroup(element, elementTemplate, injector, groups) {\n  const translate = injector.get('translate');\n\n  const group = {\n    label: translate('Errors'),\n    id: 'ElementTemplates__Error',\n    component: ListGroup,\n    items: []\n  };\n\n  const properties = elementTemplate.properties.filter(({ binding, type }) => {\n    return !type && binding.type === CAMUNDA_ERROR_EVENT_DEFINITION_TYPE;\n  });\n\n  properties.forEach((property, index) => {\n    const item = ErrorProperties({ element, index, property, groups });\n\n    if (item) {\n      group.items.push(item);\n    }\n  });\n\n  // remove if empty\n  if (!group.items.length) {\n    return null;\n  }\n\n  return group;\n}\n\n/**\n *\n * @param {string|string[]} idOrIds\n * @param {Array<{ id: string }} groups\n * @param {Array<{ id: string }>} groupsToAdd\n */\nfunction addGroupsAfter(idOrIds, groups, groupsToAdd) {\n  let ids = idOrIds;\n  if (!Array.isArray(idOrIds)) {\n    ids = [ idOrIds ];\n  }\n\n  // find index of last group with provided id\n  const index = groups.reduce((acc, group, index) => {\n    return ids.includes(group.id) ? index : acc;\n  }, -1);\n\n  if (index !== -1) {\n    groups.splice(index + 1, 0, ...groupsToAdd);\n  } else {\n\n    // add in the beginning if group with provided id is missing\n    groups.unshift(...groupsToAdd);\n  }\n}\n\nfunction filterWithEntriesVisible(template, groups) {\n  if (!template.entriesVisible) {\n    return groups.filter(group => {\n      return (\n        ALWAYS_DISPLAYED_GROUPS.includes(group.id) ||\n        group.id.startsWith('ElementTemplates__')\n      );\n    });\n  }\n\n  return groups;\n}\n","import translateModule from 'diagram-js/lib/i18n/translate';\n\nimport ElementTemplatesPropertiesProvider from './ElementTemplatesPropertiesProvider';\n\nimport { CamundaPlatformPropertiesProviderModule } from 'bpmn-js-properties-panel';\n\nexport default {\n  __depends__: [\n    translateModule,\n    CamundaPlatformPropertiesProviderModule\n  ],\n  __init__: [\n    'elementTemplatesPropertiesProvider'\n  ],\n  elementTemplatesPropertiesProvider: [ 'type', ElementTemplatesPropertiesProvider ]\n};\n","import coreModule from './core';\nimport propertiesProviderModule from './properties-panel';\n\nexport default {\n  __depends__: [\n    coreModule,\n    propertiesProviderModule,\n  ]\n};\n","/**\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\n * under one or more contributor license agreements. See the NOTICE file\n * distributed with this work for additional information regarding copyright\n * ownership.\n *\n * Camunda licenses this file to you under the MIT; you may not use this file\n * except in compliance with the MIT License.\n */\n\nimport ElementTemplates from '../../ElementTemplates';\nimport EventBus from 'diagram-js/lib/core/EventBus';\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\nimport { getPropertyValue, validateProperty } from '../../util/propertyUtil';\n\nimport { applyConditions } from '../../Condition';\n\nexport default function({ templates = [] }) {\n\n  // We use the ElementTemplates Module without the required bpmn-js modules\n  // As we only use it to facilitate template ID and version lookup,\n  // access to commandstack etc. is not required\n  const eventBus = new EventBus();\n  const elementTemplates = new ElementTemplates(null, null, eventBus, null, null);\n\n  elementTemplates.set(templates);\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:FlowElement')) {\n      return;\n    }\n\n    let template = elementTemplates.get(node);\n\n    const templateId = elementTemplates._getTemplateId(node);\n    const templateVersion = elementTemplates._getTemplateVersion(node);\n\n    // Handle missing template\n    if (templateId && !template) {\n      const versionText = templateVersion ? ` (version: ${templateVersion})` : '';\n      reporter.report(\n        node.id,\n        `Linked element template '${templateId}'${versionText} not found`,\n        {\n          name: node.name\n        }\n      );\n      return;\n    }\n\n    if (!template) {\n      return;\n    }\n\n    template = applyConditions(node, template);\n\n    // Check attributes\n    template.properties.forEach((property) => {\n      const value = getPropertyValue(node, property);\n      const error = validateProperty(value, property);\n\n      if (!error) {\n        return;\n      }\n\n      reporter.report(\n        node.id,\n        error,\n        {\n          propertiesPanel: {\n            entryIds: [ getEntryId(property, template) ]\n          },\n          name: node.name\n        }\n      );\n    });\n  }\n\n  return {\n    check\n  };\n\n};\n\n// helpers //////////////////////\n\nfunction getEntryId(property, template) {\n  const index = template.properties\n    .filter(p => p.group === property.group)\n    .indexOf(property);\n\n  const path = [ 'custom-entry', template.id ];\n\n  if (property.group) {\n    path.push(property.group);\n  }\n\n  path.push(index);\n  return path.join('-');\n}\n","/**\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\n * under one or more contributor license agreements. See the NOTICE file\n * distributed with this work for additional information regarding copyright\n * ownership.\n *\n * Camunda licenses this file to you under the MIT; you may not use this file\n * except in compliance with the MIT License.\n */\n\nimport ElementTemplates from '../../ElementTemplates';\nimport EventBus from 'diagram-js/lib/core/EventBus';\n\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\n\nexport default function({ templates = [] }) {\n\n  // We use the ElementTemplates Module without the required bpmn-js modules\n  // As we only use it to facilitate template ID and version lookup,\n  // access to commandstack etc. is not required\n  const eventBus = new EventBus();\n  const elementTemplates = new ElementTemplates(null, null, eventBus, null, null);\n\n  elementTemplates.set(templates);\n\n  function isUpdateAvailable(template) {\n\n    const latestTemplate = elementTemplates.getLatest(template.id, { deprecated: true })[0];\n\n    if (latestTemplate && latestTemplate !== template) {\n      return true;\n    }\n\n    return false;\n  }\n\n  function check(node, reporter) {\n\n    if (is(node, 'bpmn:Definitions')) {\n      elementTemplates.setEngines(getEnginesConfig(node));\n    }\n\n    if (!is(node, 'bpmn:FlowElement')) {\n      return;\n    }\n\n    let template = elementTemplates.get(node);\n\n    if (!template) {\n      return;\n    }\n\n    // Check compatibility\n    if (template.engines) {\n      const incomp = elementTemplates.getIncompatibleEngines(template);\n      Object.keys(incomp).forEach((engine) => {\n        reporter.report(\n          node.id,\n          getIncompatibilityText(engine, incomp[engine], isUpdateAvailable(template)),\n          {\n            name: node.name\n          }\n        );\n      });\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n\n// helpers //////////////////////\n\nfunction getEnginesConfig(definitions) {\n  const engines = {};\n\n  const executionPlatform = definitions.get('modeler:executionPlatform');\n  const executionPlatformVersion = definitions.get('modeler:executionPlatformVersion');\n\n  if (executionPlatform === 'Camunda Cloud' && executionPlatformVersion) {\n    engines.camunda = executionPlatformVersion;\n  }\n\n  return engines;\n}\n\n\nfunction getIncompatibilityText(engine, { actual, required }, updateAvailable) {\n  const message =\n    `Element template incompatible with current <${engine}> environment. ` +\n    `Requires '${engine} ${required}'; found '${actual}'. ` +\n    `${updateAvailable ? 'Update available.' : ''}`;\n\n  return message.trim();\n}\n","import { forEach, bind, pick, assign, isString, isObject, set } from 'min-dash';\n\n/**\n * Moddle base element.\n */\nfunction Base() { }\n\nBase.prototype.get = function(name) {\n  return this.$model.properties.get(this, name);\n};\n\nBase.prototype.set = function(name, value) {\n  this.$model.properties.set(this, name, value);\n};\n\n/**\n * A model element factory.\n *\n * @param {Moddle} model\n * @param {Properties} properties\n */\nfunction Factory(model, properties) {\n  this.model = model;\n  this.properties = properties;\n}\n\n\nFactory.prototype.createType = function(descriptor) {\n\n  var model = this.model;\n\n  var props = this.properties,\n      prototype = Object.create(Base.prototype);\n\n  // initialize default values\n  forEach(descriptor.properties, function(p) {\n    if (!p.isMany && p.default !== undefined) {\n      prototype[p.name] = p.default;\n    }\n  });\n\n  props.defineModel(prototype, model);\n  props.defineDescriptor(prototype, descriptor);\n\n  var name = descriptor.ns.name;\n\n  /**\n   * The new type constructor\n   */\n  function ModdleElement(attrs) {\n    props.define(this, '$type', { value: name, enumerable: true });\n    props.define(this, '$attrs', { value: {} });\n    props.define(this, '$parent', { writable: true });\n\n    forEach(attrs, bind(function(val, key) {\n      this.set(key, val);\n    }, this));\n  }\n\n  ModdleElement.prototype = prototype;\n\n  ModdleElement.hasType = prototype.$instanceOf = this.model.hasType;\n\n  // static links\n  props.defineModel(ModdleElement, model);\n  props.defineDescriptor(ModdleElement, descriptor);\n\n  return ModdleElement;\n};\n\n/**\n * Built-in moddle types\n */\nvar BUILTINS = {\n  String: true,\n  Boolean: true,\n  Integer: true,\n  Real: true,\n  Element: true\n};\n\n/**\n * Converters for built in types from string representations\n */\nvar TYPE_CONVERTERS = {\n  String: function(s) { return s; },\n  Boolean: function(s) { return s === 'true'; },\n  Integer: function(s) { return parseInt(s, 10); },\n  Real: function(s) { return parseFloat(s); }\n};\n\n/**\n * Convert a type to its real representation\n */\nfunction coerceType(type, value) {\n\n  var converter = TYPE_CONVERTERS[type];\n\n  if (converter) {\n    return converter(value);\n  } else {\n    return value;\n  }\n}\n\n/**\n * Return whether the given type is built-in\n */\nfunction isBuiltIn(type) {\n  return !!BUILTINS[type];\n}\n\n/**\n * Return whether the given type is simple\n */\nfunction isSimple(type) {\n  return !!TYPE_CONVERTERS[type];\n}\n\n/**\n * Parses a namespaced attribute name of the form (ns:)localName to an object,\n * given a default prefix to assume in case no explicit namespace is given.\n *\n * @param {String} name\n * @param {String} [defaultPrefix] the default prefix to take, if none is present.\n *\n * @return {Object} the parsed name\n */\nfunction parseName(name, defaultPrefix) {\n  var parts = name.split(/:/),\n      localName, prefix;\n\n  // no prefix (i.e. only local name)\n  if (parts.length === 1) {\n    localName = name;\n    prefix = defaultPrefix;\n  }\n\n  // prefix + local name\n  else if (parts.length === 2) {\n    localName = parts[1];\n    prefix = parts[0];\n  }\n\n  else {\n    throw new Error('expected <prefix:localName> or <localName>, got ' + name);\n  }\n\n  name = (prefix ? prefix + ':' : '') + localName;\n\n  return {\n    name: name,\n    prefix: prefix,\n    localName: localName\n  };\n}\n\n/**\n * A utility to build element descriptors.\n */\nfunction DescriptorBuilder(nameNs) {\n  this.ns = nameNs;\n  this.name = nameNs.name;\n  this.allTypes = [];\n  this.allTypesByName = {};\n  this.properties = [];\n  this.propertiesByName = {};\n}\n\n\nDescriptorBuilder.prototype.build = function() {\n  return pick(this, [\n    'ns',\n    'name',\n    'allTypes',\n    'allTypesByName',\n    'properties',\n    'propertiesByName',\n    'bodyProperty',\n    'idProperty'\n  ]);\n};\n\n/**\n * Add property at given index.\n *\n * @param {Object} p\n * @param {Number} [idx]\n * @param {Boolean} [validate=true]\n */\nDescriptorBuilder.prototype.addProperty = function(p, idx, validate) {\n\n  if (typeof idx === 'boolean') {\n    validate = idx;\n    idx = undefined;\n  }\n\n  this.addNamedProperty(p, validate !== false);\n\n  var properties = this.properties;\n\n  if (idx !== undefined) {\n    properties.splice(idx, 0, p);\n  } else {\n    properties.push(p);\n  }\n};\n\n\nDescriptorBuilder.prototype.replaceProperty = function(oldProperty, newProperty, replace) {\n  var oldNameNs = oldProperty.ns;\n\n  var props = this.properties,\n      propertiesByName = this.propertiesByName,\n      rename = oldProperty.name !== newProperty.name;\n\n  if (oldProperty.isId) {\n    if (!newProperty.isId) {\n      throw new Error(\n        'property <' + newProperty.ns.name + '> must be id property ' +\n        'to refine <' + oldProperty.ns.name + '>');\n    }\n\n    this.setIdProperty(newProperty, false);\n  }\n\n  if (oldProperty.isBody) {\n\n    if (!newProperty.isBody) {\n      throw new Error(\n        'property <' + newProperty.ns.name + '> must be body property ' +\n        'to refine <' + oldProperty.ns.name + '>');\n    }\n\n    // TODO: Check compatibility\n    this.setBodyProperty(newProperty, false);\n  }\n\n  // validate existence and get location of old property\n  var idx = props.indexOf(oldProperty);\n  if (idx === -1) {\n    throw new Error('property <' + oldNameNs.name + '> not found in property list');\n  }\n\n  // remove old property\n  props.splice(idx, 1);\n\n  // replacing the named property is intentional\n  //\n  //  * validate only if this is a \"rename\" operation\n  //  * add at specific index unless we \"replace\"\n  //\n  this.addProperty(newProperty, replace ? undefined : idx, rename);\n\n  // make new property available under old name\n  propertiesByName[oldNameNs.name] = propertiesByName[oldNameNs.localName] = newProperty;\n};\n\n\nDescriptorBuilder.prototype.redefineProperty = function(p, targetPropertyName, replace) {\n\n  var nsPrefix = p.ns.prefix;\n  var parts = targetPropertyName.split('#');\n\n  var name = parseName(parts[0], nsPrefix);\n  var attrName = parseName(parts[1], name.prefix).name;\n\n  var redefinedProperty = this.propertiesByName[attrName];\n  if (!redefinedProperty) {\n    throw new Error('refined property <' + attrName + '> not found');\n  } else {\n    this.replaceProperty(redefinedProperty, p, replace);\n  }\n\n  delete p.redefines;\n};\n\nDescriptorBuilder.prototype.addNamedProperty = function(p, validate) {\n  var ns = p.ns,\n      propsByName = this.propertiesByName;\n\n  if (validate) {\n    this.assertNotDefined(p, ns.name);\n    this.assertNotDefined(p, ns.localName);\n  }\n\n  propsByName[ns.name] = propsByName[ns.localName] = p;\n};\n\nDescriptorBuilder.prototype.removeNamedProperty = function(p) {\n  var ns = p.ns,\n      propsByName = this.propertiesByName;\n\n  delete propsByName[ns.name];\n  delete propsByName[ns.localName];\n};\n\nDescriptorBuilder.prototype.setBodyProperty = function(p, validate) {\n\n  if (validate && this.bodyProperty) {\n    throw new Error(\n      'body property defined multiple times ' +\n      '(<' + this.bodyProperty.ns.name + '>, <' + p.ns.name + '>)');\n  }\n\n  this.bodyProperty = p;\n};\n\nDescriptorBuilder.prototype.setIdProperty = function(p, validate) {\n\n  if (validate && this.idProperty) {\n    throw new Error(\n      'id property defined multiple times ' +\n      '(<' + this.idProperty.ns.name + '>, <' + p.ns.name + '>)');\n  }\n\n  this.idProperty = p;\n};\n\nDescriptorBuilder.prototype.assertNotTrait = function(typeDescriptor) {\n\n  const _extends = typeDescriptor.extends || [];\n\n  if (_extends.length) {\n    throw new Error(\n      `cannot create <${ typeDescriptor.name }> extending <${ typeDescriptor.extends }>`\n    );\n  }\n};\n\nDescriptorBuilder.prototype.assertNotDefined = function(p, name) {\n  var propertyName = p.name,\n      definedProperty = this.propertiesByName[propertyName];\n\n  if (definedProperty) {\n    throw new Error(\n      'property <' + propertyName + '> already defined; ' +\n      'override of <' + definedProperty.definedBy.ns.name + '#' + definedProperty.ns.name + '> by ' +\n      '<' + p.definedBy.ns.name + '#' + p.ns.name + '> not allowed without redefines');\n  }\n};\n\nDescriptorBuilder.prototype.hasProperty = function(name) {\n  return this.propertiesByName[name];\n};\n\nDescriptorBuilder.prototype.addTrait = function(t, inherited) {\n\n  if (inherited) {\n    this.assertNotTrait(t);\n  }\n\n  var typesByName = this.allTypesByName,\n      types = this.allTypes;\n\n  var typeName = t.name;\n\n  if (typeName in typesByName) {\n    return;\n  }\n\n  forEach(t.properties, bind(function(p) {\n\n    // clone property to allow extensions\n    p = assign({}, p, {\n      name: p.ns.localName,\n      inherited: inherited\n    });\n\n    Object.defineProperty(p, 'definedBy', {\n      value: t\n    });\n\n    var replaces = p.replaces,\n        redefines = p.redefines;\n\n    // add replace/redefine support\n    if (replaces || redefines) {\n      this.redefineProperty(p, replaces || redefines, replaces);\n    } else {\n      if (p.isBody) {\n        this.setBodyProperty(p);\n      }\n      if (p.isId) {\n        this.setIdProperty(p);\n      }\n      this.addProperty(p);\n    }\n  }, this));\n\n  types.push(t);\n  typesByName[typeName] = t;\n};\n\n/**\n * A registry of Moddle packages.\n *\n * @param {Array<Package>} packages\n * @param {Properties} properties\n */\nfunction Registry(packages, properties) {\n  this.packageMap = {};\n  this.typeMap = {};\n\n  this.packages = [];\n\n  this.properties = properties;\n\n  forEach(packages, bind(this.registerPackage, this));\n}\n\n\nRegistry.prototype.getPackage = function(uriOrPrefix) {\n  return this.packageMap[uriOrPrefix];\n};\n\nRegistry.prototype.getPackages = function() {\n  return this.packages;\n};\n\n\nRegistry.prototype.registerPackage = function(pkg) {\n\n  // copy package\n  pkg = assign({}, pkg);\n\n  var pkgMap = this.packageMap;\n\n  ensureAvailable(pkgMap, pkg, 'prefix');\n  ensureAvailable(pkgMap, pkg, 'uri');\n\n  // register types\n  forEach(pkg.types, bind(function(descriptor) {\n    this.registerType(descriptor, pkg);\n  }, this));\n\n  pkgMap[pkg.uri] = pkgMap[pkg.prefix] = pkg;\n  this.packages.push(pkg);\n};\n\n\n/**\n * Register a type from a specific package with us\n */\nRegistry.prototype.registerType = function(type, pkg) {\n\n  type = assign({}, type, {\n    superClass: (type.superClass || []).slice(),\n    extends: (type.extends || []).slice(),\n    properties: (type.properties || []).slice(),\n    meta: assign((type.meta || {}))\n  });\n\n  var ns = parseName(type.name, pkg.prefix),\n      name = ns.name,\n      propertiesByName = {};\n\n  // parse properties\n  forEach(type.properties, bind(function(p) {\n\n    // namespace property names\n    var propertyNs = parseName(p.name, ns.prefix),\n        propertyName = propertyNs.name;\n\n    // namespace property types\n    if (!isBuiltIn(p.type)) {\n      p.type = parseName(p.type, propertyNs.prefix).name;\n    }\n\n    assign(p, {\n      ns: propertyNs,\n      name: propertyName\n    });\n\n    propertiesByName[propertyName] = p;\n  }, this));\n\n  // update ns + name\n  assign(type, {\n    ns: ns,\n    name: name,\n    propertiesByName: propertiesByName\n  });\n\n  forEach(type.extends, bind(function(extendsName) {\n    var extendsNameNs = parseName(extendsName, ns.prefix);\n\n    var extended = this.typeMap[extendsNameNs.name];\n\n    extended.traits = extended.traits || [];\n    extended.traits.push(name);\n  }, this));\n\n  // link to package\n  this.definePackage(type, pkg);\n\n  // register\n  this.typeMap[name] = type;\n};\n\n\n/**\n * Traverse the type hierarchy from bottom to top,\n * calling iterator with (type, inherited) for all elements in\n * the inheritance chain.\n *\n * @param {Object} nsName\n * @param {Function} iterator\n * @param {Boolean} [trait=false]\n */\nRegistry.prototype.mapTypes = function(nsName, iterator, trait) {\n\n  var type = isBuiltIn(nsName.name) ? { name: nsName.name } : this.typeMap[nsName.name];\n\n  var self = this;\n\n  /**\n   * Traverse the selected super type or trait\n   *\n   * @param {String} cls\n   * @param {Boolean} [trait=false]\n   */\n  function traverse(cls, trait) {\n    var parentNs = parseName(cls, isBuiltIn(cls) ? '' : nsName.prefix);\n    self.mapTypes(parentNs, iterator, trait);\n  }\n\n  /**\n   * Traverse the selected trait.\n   *\n   * @param {String} cls\n   */\n  function traverseTrait(cls) {\n    return traverse(cls, true);\n  }\n\n  /**\n   * Traverse the selected super type\n   *\n   * @param {String} cls\n   */\n  function traverseSuper(cls) {\n    return traverse(cls, false);\n  }\n\n  if (!type) {\n    throw new Error('unknown type <' + nsName.name + '>');\n  }\n\n  forEach(type.superClass, trait ? traverseTrait : traverseSuper);\n\n  // call iterator with (type, inherited=!trait)\n  iterator(type, !trait);\n\n  forEach(type.traits, traverseTrait);\n};\n\n\n/**\n * Returns the effective descriptor for a type.\n *\n * @param  {String} type the namespaced name (ns:localName) of the type\n *\n * @return {Descriptor} the resulting effective descriptor\n */\nRegistry.prototype.getEffectiveDescriptor = function(name) {\n\n  var nsName = parseName(name);\n\n  var builder = new DescriptorBuilder(nsName);\n\n  this.mapTypes(nsName, function(type, inherited) {\n    builder.addTrait(type, inherited);\n  });\n\n  var descriptor = builder.build();\n\n  // define package link\n  this.definePackage(descriptor, descriptor.allTypes[descriptor.allTypes.length - 1].$pkg);\n\n  return descriptor;\n};\n\n\nRegistry.prototype.definePackage = function(target, pkg) {\n  this.properties.define(target, '$pkg', { value: pkg });\n};\n\n\n\n// helpers ////////////////////////////\n\nfunction ensureAvailable(packageMap, pkg, identifierKey) {\n\n  var value = pkg[identifierKey];\n\n  if (value in packageMap) {\n    throw new Error('package with ' + identifierKey + ' <' + value + '> already defined');\n  }\n}\n\n/**\n * A utility that gets and sets properties of model elements.\n *\n * @param {Model} model\n */\nfunction Properties(model) {\n  this.model = model;\n}\n\n\n/**\n * Sets a named property on the target element.\n * If the value is undefined, the property gets deleted.\n *\n * @param {Object} target\n * @param {String} name\n * @param {Object} value\n */\nProperties.prototype.set = function(target, name, value) {\n\n  if (!isString(name) || !name.length) {\n    throw new TypeError('property name must be a non-empty string');\n  }\n\n  var property = this.getProperty(target, name);\n\n  var propertyName = property && property.name;\n\n  if (isUndefined(value)) {\n\n    // unset the property, if the specified value is undefined;\n    // delete from $attrs (for extensions) or the target itself\n    if (property) {\n      delete target[propertyName];\n    } else {\n      delete target.$attrs[stripGlobal(name)];\n    }\n  } else {\n\n    // set the property, defining well defined properties on the fly\n    // or simply updating them in target.$attrs (for extensions)\n    if (property) {\n      if (propertyName in target) {\n        target[propertyName] = value;\n      } else {\n        defineProperty(target, property, value);\n      }\n    } else {\n      target.$attrs[stripGlobal(name)] = value;\n    }\n  }\n};\n\n/**\n * Returns the named property of the given element\n *\n * @param  {Object} target\n * @param  {String} name\n *\n * @return {Object}\n */\nProperties.prototype.get = function(target, name) {\n\n  var property = this.getProperty(target, name);\n\n  if (!property) {\n    return target.$attrs[stripGlobal(name)];\n  }\n\n  var propertyName = property.name;\n\n  // check if access to collection property and lazily initialize it\n  if (!target[propertyName] && property.isMany) {\n    defineProperty(target, property, []);\n  }\n\n  return target[propertyName];\n};\n\n\n/**\n * Define a property on the target element\n *\n * @param  {Object} target\n * @param  {String} name\n * @param  {Object} options\n */\nProperties.prototype.define = function(target, name, options) {\n\n  if (!options.writable) {\n\n    var value = options.value;\n\n    // use getters for read-only variables to support ES6 proxies\n    // cf. https://github.com/bpmn-io/internal-docs/issues/386\n    options = assign({}, options, {\n      get: function() { return value; }\n    });\n\n    delete options.value;\n  }\n\n  Object.defineProperty(target, name, options);\n};\n\n\n/**\n * Define the descriptor for an element\n */\nProperties.prototype.defineDescriptor = function(target, descriptor) {\n  this.define(target, '$descriptor', { value: descriptor });\n};\n\n/**\n * Define the model for an element\n */\nProperties.prototype.defineModel = function(target, model) {\n  this.define(target, '$model', { value: model });\n};\n\n/**\n * Return property with the given name on the element.\n *\n * @param {any} target\n * @param {string} name\n *\n * @return {object | null} property\n */\nProperties.prototype.getProperty = function(target, name) {\n\n  var model = this.model;\n\n  var property = model.getPropertyDescriptor(target, name);\n\n  if (property) {\n    return property;\n  }\n\n  if (name.includes(':')) {\n    return null;\n  }\n\n  const strict = model.config.strict;\n\n  if (typeof strict !== 'undefined') {\n    const error = new TypeError(`unknown property <${ name }> on <${ target.$type }>`);\n\n    if (strict) {\n      throw error;\n    } else {\n\n      // eslint-disable-next-line no-undef\n      typeof console !== 'undefined' && console.warn(error);\n    }\n  }\n\n  return null;\n};\n\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\nfunction defineProperty(target, property, value) {\n  Object.defineProperty(target, property.name, {\n    enumerable: !property.isReference,\n    writable: true,\n    value: value,\n    configurable: true\n  });\n}\n\nfunction stripGlobal(name) {\n  return name.replace(/^:/, '');\n}\n\n// Moddle implementation /////////////////////////////////////////////////\n\n/**\n * @class Moddle\n *\n * A model that can be used to create elements of a specific type.\n *\n * @example\n *\n * var Moddle = require('moddle');\n *\n * var pkg = {\n *   name: 'mypackage',\n *   prefix: 'my',\n *   types: [\n *     { name: 'Root' }\n *   ]\n * };\n *\n * var moddle = new Moddle([pkg]);\n *\n * @param {Array<Package>} packages the packages to contain\n *\n * @param { { strict?: boolean } } [config] moddle configuration\n */\nfunction Moddle(packages, config = {}) {\n\n  this.properties = new Properties(this);\n\n  this.factory = new Factory(this, this.properties);\n  this.registry = new Registry(packages, this.properties);\n\n  this.typeCache = {};\n\n  this.config = config;\n}\n\n\n/**\n * Create an instance of the specified type.\n *\n * @method Moddle#create\n *\n * @example\n *\n * var foo = moddle.create('my:Foo');\n * var bar = moddle.create('my:Bar', { id: 'BAR_1' });\n *\n * @param  {String|Object} descriptor the type descriptor or name know to the model\n * @param  {Object} attrs   a number of attributes to initialize the model instance with\n * @return {Object}         model instance\n */\nModdle.prototype.create = function(descriptor, attrs) {\n  var Type = this.getType(descriptor);\n\n  if (!Type) {\n    throw new Error('unknown type <' + descriptor + '>');\n  }\n\n  return new Type(attrs);\n};\n\n\n/**\n * Returns the type representing a given descriptor\n *\n * @method Moddle#getType\n *\n * @example\n *\n * var Foo = moddle.getType('my:Foo');\n * var foo = new Foo({ 'id' : 'FOO_1' });\n *\n * @param  {String|Object} descriptor the type descriptor or name know to the model\n * @return {Object}         the type representing the descriptor\n */\nModdle.prototype.getType = function(descriptor) {\n\n  var cache = this.typeCache;\n\n  var name = isString(descriptor) ? descriptor : descriptor.ns.name;\n\n  var type = cache[name];\n\n  if (!type) {\n    descriptor = this.registry.getEffectiveDescriptor(name);\n    type = cache[name] = this.factory.createType(descriptor);\n  }\n\n  return type;\n};\n\n\n/**\n * Creates an any-element type to be used within model instances.\n *\n * This can be used to create custom elements that lie outside the meta-model.\n * The created element contains all the meta-data required to serialize it\n * as part of meta-model elements.\n *\n * @method Moddle#createAny\n *\n * @example\n *\n * var foo = moddle.createAny('vendor:Foo', 'http://vendor', {\n *   value: 'bar'\n * });\n *\n * var container = moddle.create('my:Container', 'http://my', {\n *   any: [ foo ]\n * });\n *\n * // go ahead and serialize the stuff\n *\n *\n * @param  {String} name  the name of the element\n * @param  {String} nsUri the namespace uri of the element\n * @param  {Object} [properties] a map of properties to initialize the instance with\n * @return {Object} the any type instance\n */\nModdle.prototype.createAny = function(name, nsUri, properties) {\n\n  var nameNs = parseName(name);\n\n  var element = {\n    $type: name,\n    $instanceOf: function(type) {\n      return type === this.$type;\n    },\n    get: function(key) {\n      return this[key];\n    },\n    set: function(key, value) {\n      set(this, [ key ], value);\n    }\n  };\n\n  var descriptor = {\n    name: name,\n    isGeneric: true,\n    ns: {\n      prefix: nameNs.prefix,\n      localName: nameNs.localName,\n      uri: nsUri\n    }\n  };\n\n  this.properties.defineDescriptor(element, descriptor);\n  this.properties.defineModel(element, this);\n  this.properties.define(element, 'get', { enumerable: false, writable: true });\n  this.properties.define(element, 'set', { enumerable: false, writable: true });\n  this.properties.define(element, '$parent', { enumerable: false, writable: true });\n  this.properties.define(element, '$instanceOf', { enumerable: false, writable: true });\n\n  forEach(properties, function(a, key) {\n    if (isObject(a) && a.value !== undefined) {\n      element[a.name] = a.value;\n    } else {\n      element[key] = a;\n    }\n  });\n\n  return element;\n};\n\n/**\n * Returns a registered package by uri or prefix\n *\n * @return {Object} the package\n */\nModdle.prototype.getPackage = function(uriOrPrefix) {\n  return this.registry.getPackage(uriOrPrefix);\n};\n\n/**\n * Returns a snapshot of all known packages\n *\n * @return {Object} the package\n */\nModdle.prototype.getPackages = function() {\n  return this.registry.getPackages();\n};\n\n/**\n * Returns the descriptor for an element\n */\nModdle.prototype.getElementDescriptor = function(element) {\n  return element.$descriptor;\n};\n\n/**\n * Returns true if the given descriptor or instance\n * represents the given type.\n *\n * May be applied to this, if element is omitted.\n */\nModdle.prototype.hasType = function(element, type) {\n  if (type === undefined) {\n    type = element;\n    element = this;\n  }\n\n  var descriptor = element.$model.getElementDescriptor(element);\n\n  return (type in descriptor.allTypesByName);\n};\n\n/**\n * Returns the descriptor of an elements named property\n */\nModdle.prototype.getPropertyDescriptor = function(element, property) {\n  return this.getElementDescriptor(element).propertiesByName[property];\n};\n\n/**\n * Returns a mapped type's descriptor\n */\nModdle.prototype.getTypeDescriptor = function(type) {\n  return this.registry.typeMap[type];\n};\n\nexport { Moddle, coerceType, isBuiltIn as isBuiltInType, isSimple as isSimpleType, parseName as parseNameNS };\n//# sourceMappingURL=index.js.map\n","var fromCharCode = String.fromCharCode;\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar ENTITY_PATTERN = /&#(\\d+);|&#x([0-9a-f]+);|&(\\w+);/ig;\n\nvar ENTITY_MAPPING = {\n  'amp': '&',\n  'apos': '\\'',\n  'gt': '>',\n  'lt': '<',\n  'quot': '\"'\n};\n\n// map UPPERCASE variants of supported special chars\nObject.keys(ENTITY_MAPPING).forEach(function(k) {\n  ENTITY_MAPPING[k.toUpperCase()] = ENTITY_MAPPING[k];\n});\n\n\nfunction replaceEntities(_, d, x, z) {\n\n  // reserved names, i.e. &nbsp;\n  if (z) {\n    if (hasOwnProperty.call(ENTITY_MAPPING, z)) {\n      return ENTITY_MAPPING[z];\n    } else {\n\n      // fall back to original value\n      return '&' + z + ';';\n    }\n  }\n\n  // decimal encoded char\n  if (d) {\n    return fromCharCode(d);\n  }\n\n  // hex encoded char\n  return fromCharCode(parseInt(x, 16));\n}\n\n\n/**\n * A basic entity decoder that can decode a minimal\n * sub-set of reserved names (&amp;) as well as\n * hex (&#xaaf;) and decimal (&#1231;) encoded characters.\n *\n * @param {string} s\n *\n * @return {string} decoded string\n */\nfunction decodeEntities(s) {\n  if (s.length > 3 && s.indexOf('&') !== -1) {\n    return s.replace(ENTITY_PATTERN, replaceEntities);\n  }\n\n  return s;\n}\n\nvar NON_WHITESPACE_OUTSIDE_ROOT_NODE = 'non-whitespace outside of root node';\n\nfunction error(msg) {\n  return new Error(msg);\n}\n\nfunction missingNamespaceForPrefix(prefix) {\n  return 'missing namespace for prefix <' + prefix + '>';\n}\n\nfunction getter(getFn) {\n  return {\n    'get': getFn,\n    'enumerable': true\n  };\n}\n\nfunction cloneNsMatrix(nsMatrix) {\n  var clone = {}, key;\n  for (key in nsMatrix) {\n    clone[key] = nsMatrix[key];\n  }\n  return clone;\n}\n\nfunction uriPrefix(prefix) {\n  return prefix + '$uri';\n}\n\nfunction buildNsMatrix(nsUriToPrefix) {\n  var nsMatrix = {},\n      uri,\n      prefix;\n\n  for (uri in nsUriToPrefix) {\n    prefix = nsUriToPrefix[uri];\n    nsMatrix[prefix] = prefix;\n    nsMatrix[uriPrefix(prefix)] = uri;\n  }\n\n  return nsMatrix;\n}\n\nfunction noopGetContext() {\n  return { line: 0, column: 0 };\n}\n\nfunction throwFunc(err) {\n  throw err;\n}\n\n/**\n * Creates a new parser with the given options.\n *\n * @constructor\n *\n * @param  {!Object<string, ?>=} options\n */\nfunction Parser(options) {\n\n  if (!this) {\n    return new Parser(options);\n  }\n\n  var proxy = options && options['proxy'];\n\n  var onText,\n      onOpenTag,\n      onCloseTag,\n      onCDATA,\n      onError = throwFunc,\n      onWarning,\n      onComment,\n      onQuestion,\n      onAttention;\n\n  var getContext = noopGetContext;\n\n  /**\n   * Do we need to parse the current elements attributes for namespaces?\n   *\n   * @type {boolean}\n   */\n  var maybeNS = false;\n\n  /**\n   * Do we process namespaces at all?\n   *\n   * @type {boolean}\n   */\n  var isNamespace = false;\n\n  /**\n   * The caught error returned on parse end\n   *\n   * @type {Error}\n   */\n  var returnError = null;\n\n  /**\n   * Should we stop parsing?\n   *\n   * @type {boolean}\n   */\n  var parseStop = false;\n\n  /**\n   * A map of { uri: prefix } used by the parser.\n   *\n   * This map will ensure we can normalize prefixes during processing;\n   * for each uri, only one prefix will be exposed to the handlers.\n   *\n   * @type {!Object<string, string>}}\n   */\n  var nsUriToPrefix;\n\n  /**\n   * Handle parse error.\n   *\n   * @param  {string|Error} err\n   */\n  function handleError(err) {\n    if (!(err instanceof Error)) {\n      err = error(err);\n    }\n\n    returnError = err;\n\n    onError(err, getContext);\n  }\n\n  /**\n   * Handle parse error.\n   *\n   * @param  {string|Error} err\n   */\n  function handleWarning(err) {\n\n    if (!onWarning) {\n      return;\n    }\n\n    if (!(err instanceof Error)) {\n      err = error(err);\n    }\n\n    onWarning(err, getContext);\n  }\n\n  /**\n   * Register parse listener.\n   *\n   * @param  {string}   name\n   * @param  {Function} cb\n   *\n   * @return {Parser}\n   */\n  this['on'] = function(name, cb) {\n\n    if (typeof cb !== 'function') {\n      throw error('required args <name, cb>');\n    }\n\n    switch (name) {\n    case 'openTag': onOpenTag = cb; break;\n    case 'text': onText = cb; break;\n    case 'closeTag': onCloseTag = cb; break;\n    case 'error': onError = cb; break;\n    case 'warn': onWarning = cb; break;\n    case 'cdata': onCDATA = cb; break;\n    case 'attention': onAttention = cb; break; // <!XXXXX zzzz=\"eeee\">\n    case 'question': onQuestion = cb; break; // <? ....  ?>\n    case 'comment': onComment = cb; break;\n    default:\n      throw error('unsupported event: ' + name);\n    }\n\n    return this;\n  };\n\n  /**\n   * Set the namespace to prefix mapping.\n   *\n   * @example\n   *\n   * parser.ns({\n   *   'http://foo': 'foo',\n   *   'http://bar': 'bar'\n   * });\n   *\n   * @param  {!Object<string, string>} nsMap\n   *\n   * @return {Parser}\n   */\n  this['ns'] = function(nsMap) {\n\n    if (typeof nsMap === 'undefined') {\n      nsMap = {};\n    }\n\n    if (typeof nsMap !== 'object') {\n      throw error('required args <nsMap={}>');\n    }\n\n    var _nsUriToPrefix = {}, k;\n\n    for (k in nsMap) {\n      _nsUriToPrefix[k] = nsMap[k];\n    }\n\n    isNamespace = true;\n    nsUriToPrefix = _nsUriToPrefix;\n\n    return this;\n  };\n\n  /**\n   * Parse xml string.\n   *\n   * @param  {string} xml\n   *\n   * @return {Error} returnError, if not thrown\n   */\n  this['parse'] = function(xml) {\n    if (typeof xml !== 'string') {\n      throw error('required args <xml=string>');\n    }\n\n    returnError = null;\n\n    parse(xml);\n\n    getContext = noopGetContext;\n    parseStop = false;\n\n    return returnError;\n  };\n\n  /**\n   * Stop parsing.\n   */\n  this['stop'] = function() {\n    parseStop = true;\n  };\n\n  /**\n   * Parse string, invoking configured listeners on element.\n   *\n   * @param  {string} xml\n   */\n  function parse(xml) {\n    var nsMatrixStack = isNamespace ? [] : null,\n        nsMatrix = isNamespace ? buildNsMatrix(nsUriToPrefix) : null,\n        _nsMatrix,\n        nodeStack = [],\n        anonymousNsCount = 0,\n        tagStart = false,\n        tagEnd = false,\n        i = 0, j = 0,\n        x, y, q, w, v,\n        xmlns,\n        elementName,\n        _elementName,\n        elementProxy\n        ;\n\n    var attrsString = '',\n        attrsStart = 0,\n        cachedAttrs // false = parsed with errors, null = needs parsing\n        ;\n\n    /**\n     * Parse attributes on demand and returns the parsed attributes.\n     *\n     * Return semantics: (1) `false` on attribute parse error,\n     * (2) object hash on extracted attrs.\n     *\n     * @return {boolean|Object}\n     */\n    function getAttrs() {\n      if (cachedAttrs !== null) {\n        return cachedAttrs;\n      }\n\n      var nsUri,\n          nsUriPrefix,\n          nsName,\n          defaultAlias = isNamespace && nsMatrix['xmlns'],\n          attrList = isNamespace && maybeNS ? [] : null,\n          i = attrsStart,\n          s = attrsString,\n          l = s.length,\n          hasNewMatrix,\n          newalias,\n          value,\n          alias,\n          name,\n          attrs = {},\n          seenAttrs = {},\n          skipAttr,\n          w,\n          j;\n\n      parseAttr:\n      for (; i < l; i++) {\n        skipAttr = false;\n        w = s.charCodeAt(i);\n\n        if (w === 32 || (w < 14 && w > 8)) { // WHITESPACE={ \\f\\n\\r\\t\\v}\n          continue;\n        }\n\n        // wait for non whitespace character\n        if (w < 65 || w > 122 || (w > 90 && w < 97)) {\n          if (w !== 95 && w !== 58) { // char 95\"_\" 58\":\"\n            handleWarning('illegal first char attribute name');\n            skipAttr = true;\n          }\n        }\n\n        // parse attribute name\n        for (j = i + 1; j < l; j++) {\n          w = s.charCodeAt(j);\n\n          if (\n            w > 96 && w < 123 ||\n            w > 64 && w < 91 ||\n            w > 47 && w < 59 ||\n            w === 46 || // '.'\n            w === 45 || // '-'\n            w === 95 // '_'\n          ) {\n            continue;\n          }\n\n          // unexpected whitespace\n          if (w === 32 || (w < 14 && w > 8)) { // WHITESPACE\n            handleWarning('missing attribute value');\n            i = j;\n\n            continue parseAttr;\n          }\n\n          // expected \"=\"\n          if (w === 61) { // \"=\" == 61\n            break;\n          }\n\n          handleWarning('illegal attribute name char');\n          skipAttr = true;\n        }\n\n        name = s.substring(i, j);\n\n        if (name === 'xmlns:xmlns') {\n          handleWarning('illegal declaration of xmlns');\n          skipAttr = true;\n        }\n\n        w = s.charCodeAt(j + 1);\n\n        if (w === 34) { // '\"'\n          j = s.indexOf('\"', i = j + 2);\n\n          if (j === -1) {\n            j = s.indexOf('\\'', i);\n\n            if (j !== -1) {\n              handleWarning('attribute value quote missmatch');\n              skipAttr = true;\n            }\n          }\n\n        } else if (w === 39) { // \"'\"\n          j = s.indexOf('\\'', i = j + 2);\n\n          if (j === -1) {\n            j = s.indexOf('\"', i);\n\n            if (j !== -1) {\n              handleWarning('attribute value quote missmatch');\n              skipAttr = true;\n            }\n          }\n\n        } else {\n          handleWarning('missing attribute value quotes');\n          skipAttr = true;\n\n          // skip to next space\n          for (j = j + 1; j < l; j++) {\n            w = s.charCodeAt(j + 1);\n\n            if (w === 32 || (w < 14 && w > 8)) { // WHITESPACE\n              break;\n            }\n          }\n\n        }\n\n        if (j === -1) {\n          handleWarning('missing closing quotes');\n\n          j = l;\n          skipAttr = true;\n        }\n\n        if (!skipAttr) {\n          value = s.substring(i, j);\n        }\n\n        i = j;\n\n        // ensure SPACE follows attribute\n        // skip illegal content otherwise\n        // example a=\"b\"c\n        for (; j + 1 < l; j++) {\n          w = s.charCodeAt(j + 1);\n\n          if (w === 32 || (w < 14 && w > 8)) { // WHITESPACE\n            break;\n          }\n\n          // FIRST ILLEGAL CHAR\n          if (i === j) {\n            handleWarning('illegal character after attribute end');\n            skipAttr = true;\n          }\n        }\n\n        // advance cursor to next attribute\n        i = j + 1;\n\n        if (skipAttr) {\n          continue parseAttr;\n        }\n\n        // check attribute re-declaration\n        if (name in seenAttrs) {\n          handleWarning('attribute <' + name + '> already defined');\n          continue;\n        }\n\n        seenAttrs[name] = true;\n\n        if (!isNamespace) {\n          attrs[name] = value;\n          continue;\n        }\n\n        // try to extract namespace information\n        if (maybeNS) {\n          newalias = (\n            name === 'xmlns'\n              ? 'xmlns'\n              : (name.charCodeAt(0) === 120 && name.substr(0, 6) === 'xmlns:')\n                ? name.substr(6)\n                : null\n          );\n\n          // handle xmlns(:alias) assignment\n          if (newalias !== null) {\n            nsUri = decodeEntities(value);\n            nsUriPrefix = uriPrefix(newalias);\n\n            alias = nsUriToPrefix[nsUri];\n\n            if (!alias) {\n\n              // no prefix defined or prefix collision\n              if (\n                (newalias === 'xmlns') ||\n                (nsUriPrefix in nsMatrix && nsMatrix[nsUriPrefix] !== nsUri)\n              ) {\n\n                // alocate free ns prefix\n                do {\n                  alias = 'ns' + (anonymousNsCount++);\n                } while (typeof nsMatrix[alias] !== 'undefined');\n              } else {\n                alias = newalias;\n              }\n\n              nsUriToPrefix[nsUri] = alias;\n            }\n\n            if (nsMatrix[newalias] !== alias) {\n              if (!hasNewMatrix) {\n                nsMatrix = cloneNsMatrix(nsMatrix);\n                hasNewMatrix = true;\n              }\n\n              nsMatrix[newalias] = alias;\n              if (newalias === 'xmlns') {\n                nsMatrix[uriPrefix(alias)] = nsUri;\n                defaultAlias = alias;\n              }\n\n              nsMatrix[nsUriPrefix] = nsUri;\n            }\n\n            // expose xmlns(:asd)=\"...\" in attributes\n            attrs[name] = value;\n            continue;\n          }\n\n          // collect attributes until all namespace\n          // declarations are processed\n          attrList.push(name, value);\n          continue;\n\n        } /** end if (maybeNs) */\n\n        // handle attributes on element without\n        // namespace declarations\n        w = name.indexOf(':');\n        if (w === -1) {\n          attrs[name] = value;\n          continue;\n        }\n\n        // normalize ns attribute name\n        if (!(nsName = nsMatrix[name.substring(0, w)])) {\n          handleWarning(missingNamespaceForPrefix(name.substring(0, w)));\n          continue;\n        }\n\n        name = defaultAlias === nsName\n          ? name.substr(w + 1)\n          : nsName + name.substr(w);\n\n        // end: normalize ns attribute name\n\n        attrs[name] = value;\n      }\n\n\n      // handle deferred, possibly namespaced attributes\n      if (maybeNS) {\n\n        // normalize captured attributes\n        for (i = 0, l = attrList.length; i < l; i++) {\n\n          name = attrList[i++];\n          value = attrList[i];\n\n          w = name.indexOf(':');\n\n          if (w !== -1) {\n\n            // normalize ns attribute name\n            if (!(nsName = nsMatrix[name.substring(0, w)])) {\n              handleWarning(missingNamespaceForPrefix(name.substring(0, w)));\n              continue;\n            }\n\n            name = defaultAlias === nsName\n              ? name.substr(w + 1)\n              : nsName + name.substr(w);\n\n            // end: normalize ns attribute name\n          }\n\n          attrs[name] = value;\n        }\n\n        // end: normalize captured attributes\n      }\n\n      return cachedAttrs = attrs;\n    }\n\n    /**\n     * Extract the parse context { line, column, part }\n     * from the current parser position.\n     *\n     * @return {Object} parse context\n     */\n    function getParseContext() {\n      var splitsRe = /(\\r\\n|\\r|\\n)/g;\n\n      var line = 0;\n      var column = 0;\n      var startOfLine = 0;\n      var endOfLine = j;\n      var match;\n      var data;\n\n      while (i >= startOfLine) {\n\n        match = splitsRe.exec(xml);\n\n        if (!match) {\n          break;\n        }\n\n        // end of line = (break idx + break chars)\n        endOfLine = match[0].length + match.index;\n\n        if (endOfLine > i) {\n          break;\n        }\n\n        // advance to next line\n        line += 1;\n\n        startOfLine = endOfLine;\n      }\n\n      // EOF errors\n      if (i == -1) {\n        column = endOfLine;\n        data = xml.substring(j);\n      } else\n\n      // start errors\n      if (j === 0) {\n        data = xml.substring(j, i);\n      }\n\n      // other errors\n      else {\n        column = i - startOfLine;\n        data = (j == -1 ? xml.substring(i) : xml.substring(i, j + 1));\n      }\n\n      return {\n        'data': data,\n        'line': line,\n        'column': column\n      };\n    }\n\n    getContext = getParseContext;\n\n\n    if (proxy) {\n      elementProxy = Object.create({}, {\n        'name': getter(function() {\n          return elementName;\n        }),\n        'originalName': getter(function() {\n          return _elementName;\n        }),\n        'attrs': getter(getAttrs),\n        'ns': getter(function() {\n          return nsMatrix;\n        })\n      });\n    }\n\n    // actual parse logic\n    while (j !== -1) {\n\n      if (xml.charCodeAt(j) === 60) { // \"<\"\n        i = j;\n      } else {\n        i = xml.indexOf('<', j);\n      }\n\n      // parse end\n      if (i === -1) {\n        if (nodeStack.length) {\n          return handleError('unexpected end of file');\n        }\n\n        if (j === 0) {\n          return handleError('missing start tag');\n        }\n\n        if (j < xml.length) {\n          if (xml.substring(j).trim()) {\n            handleWarning(NON_WHITESPACE_OUTSIDE_ROOT_NODE);\n          }\n        }\n\n        return;\n      }\n\n      // parse text\n      if (j !== i) {\n\n        if (nodeStack.length) {\n          if (onText) {\n            onText(xml.substring(j, i), decodeEntities, getContext);\n\n            if (parseStop) {\n              return;\n            }\n          }\n        } else {\n          if (xml.substring(j, i).trim()) {\n            handleWarning(NON_WHITESPACE_OUTSIDE_ROOT_NODE);\n\n            if (parseStop) {\n              return;\n            }\n          }\n        }\n      }\n\n      w = xml.charCodeAt(i + 1);\n\n      // parse comments + CDATA\n      if (w === 33) { // \"!\"\n        q = xml.charCodeAt(i + 2);\n\n        // CDATA section\n        if (q === 91 && xml.substr(i + 3, 6) === 'CDATA[') { // 91 == \"[\"\n          j = xml.indexOf(']]>', i);\n          if (j === -1) {\n            return handleError('unclosed cdata');\n          }\n\n          if (onCDATA) {\n            onCDATA(xml.substring(i + 9, j), getContext);\n            if (parseStop) {\n              return;\n            }\n          }\n\n          j += 3;\n          continue;\n        }\n\n        // comment\n        if (q === 45 && xml.charCodeAt(i + 3) === 45) { // 45 == \"-\"\n          j = xml.indexOf('-->', i);\n          if (j === -1) {\n            return handleError('unclosed comment');\n          }\n\n\n          if (onComment) {\n            onComment(xml.substring(i + 4, j), decodeEntities, getContext);\n            if (parseStop) {\n              return;\n            }\n          }\n\n          j += 3;\n          continue;\n        }\n      }\n\n      // parse question <? ... ?>\n      if (w === 63) { // \"?\"\n        j = xml.indexOf('?>', i);\n        if (j === -1) {\n          return handleError('unclosed question');\n        }\n\n        if (onQuestion) {\n          onQuestion(xml.substring(i, j + 2), getContext);\n          if (parseStop) {\n            return;\n          }\n        }\n\n        j += 2;\n        continue;\n      }\n\n      // find matching closing tag for attention or standard tags\n      // for that we must skip through attribute values\n      // (enclosed in single or double quotes)\n      for (x = i + 1; ; x++) {\n        v = xml.charCodeAt(x);\n        if (isNaN(v)) {\n          j = -1;\n          return handleError('unclosed tag');\n        }\n\n        // [10] AttValue ::= '\"' ([^<&\"] | Reference)* '\"' | \"'\" ([^<&'] | Reference)* \"'\"\n        // skips the quoted string\n        // (double quotes) does not appear in a literal enclosed by (double quotes)\n        // (single quote) does not appear in a literal enclosed by (single quote)\n        if (v === 34) { //  '\"'\n          q = xml.indexOf('\"', x + 1);\n          x = q !== -1 ? q : x;\n        } else if (v === 39) { // \"'\"\n          q = xml.indexOf(\"'\", x + 1);\n          x = q !== -1 ? q : x;\n        } else if (v === 62) { // '>'\n          j = x;\n          break;\n        }\n      }\n\n\n      // parse attention <! ...>\n      // previously comment and CDATA have already been parsed\n      if (w === 33) { // \"!\"\n\n        if (onAttention) {\n          onAttention(xml.substring(i, j + 1), decodeEntities, getContext);\n          if (parseStop) {\n            return;\n          }\n        }\n\n        j += 1;\n        continue;\n      }\n\n      // don't process attributes;\n      // there are none\n      cachedAttrs = {};\n\n      // if (xml.charCodeAt(i+1) === 47) { // </...\n      if (w === 47) { // </...\n        tagStart = false;\n        tagEnd = true;\n\n        if (!nodeStack.length) {\n          return handleError('missing open tag');\n        }\n\n        // verify open <-> close tag match\n        x = elementName = nodeStack.pop();\n        q = i + 2 + x.length;\n\n        if (xml.substring(i + 2, q) !== x) {\n          return handleError('closing tag mismatch');\n        }\n\n        // verify chars in close tag\n        for (; q < j; q++) {\n          w = xml.charCodeAt(q);\n\n          if (w === 32 || (w > 8 && w < 14)) { // \\f\\n\\r\\t\\v space\n            continue;\n          }\n\n          return handleError('close tag');\n        }\n\n      } else {\n        if (xml.charCodeAt(j - 1) === 47) { // .../>\n          x = elementName = xml.substring(i + 1, j - 1);\n\n          tagStart = true;\n          tagEnd = true;\n\n        } else {\n          x = elementName = xml.substring(i + 1, j);\n\n          tagStart = true;\n          tagEnd = false;\n        }\n\n        if (!(w > 96 && w < 123 || w > 64 && w < 91 || w === 95 || w === 58)) { // char 95\"_\" 58\":\"\n          return handleError('illegal first char nodeName');\n        }\n\n        for (q = 1, y = x.length; q < y; q++) {\n          w = x.charCodeAt(q);\n\n          if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w == 46) {\n            continue;\n          }\n\n          if (w === 32 || (w < 14 && w > 8)) { // \\f\\n\\r\\t\\v space\n            elementName = x.substring(0, q);\n\n            // maybe there are attributes\n            cachedAttrs = null;\n            break;\n          }\n\n          return handleError('invalid nodeName');\n        }\n\n        if (!tagEnd) {\n          nodeStack.push(elementName);\n        }\n      }\n\n      if (isNamespace) {\n\n        _nsMatrix = nsMatrix;\n\n        if (tagStart) {\n\n          // remember old namespace\n          // unless we're self-closing\n          if (!tagEnd) {\n            nsMatrixStack.push(_nsMatrix);\n          }\n\n          if (cachedAttrs === null) {\n\n            // quick check, whether there may be namespace\n            // declarations on the node; if that is the case\n            // we need to eagerly parse the node attributes\n            if ((maybeNS = x.indexOf('xmlns', q) !== -1)) {\n              attrsStart = q;\n              attrsString = x;\n\n              getAttrs();\n\n              maybeNS = false;\n            }\n          }\n        }\n\n        _elementName = elementName;\n\n        w = elementName.indexOf(':');\n        if (w !== -1) {\n          xmlns = nsMatrix[elementName.substring(0, w)];\n\n          // prefix given; namespace must exist\n          if (!xmlns) {\n            return handleError('missing namespace on <' + _elementName + '>');\n          }\n\n          elementName = elementName.substr(w + 1);\n        } else {\n          xmlns = nsMatrix['xmlns'];\n\n          // if no default namespace is defined,\n          // we'll import the element as anonymous.\n          //\n          // it is up to users to correct that to the document defined\n          // targetNamespace, or whatever their undersanding of the\n          // XML spec mandates.\n        }\n\n        // adjust namespace prefixs as configured\n        if (xmlns) {\n          elementName = xmlns + ':' + elementName;\n        }\n\n      }\n\n      if (tagStart) {\n        attrsStart = q;\n        attrsString = x;\n\n        if (onOpenTag) {\n          if (proxy) {\n            onOpenTag(elementProxy, decodeEntities, tagEnd, getContext);\n          } else {\n            onOpenTag(elementName, getAttrs, decodeEntities, tagEnd, getContext);\n          }\n\n          if (parseStop) {\n            return;\n          }\n        }\n\n      }\n\n      if (tagEnd) {\n\n        if (onCloseTag) {\n          onCloseTag(proxy ? elementProxy : elementName, decodeEntities, tagStart, getContext);\n\n          if (parseStop) {\n            return;\n          }\n        }\n\n        // restore old namespace\n        if (isNamespace) {\n          if (!tagStart) {\n            nsMatrix = nsMatrixStack.pop();\n          } else {\n            nsMatrix = _nsMatrix;\n          }\n        }\n      }\n\n      j += 1;\n    }\n  } /** end parse */\n\n}\n\nexport { Parser, decodeEntities as decode };\n//# sourceMappingURL=index.js.map\n","import { forEach, assign, find, isString, findIndex, filter, has } from 'min-dash';\nimport { Parser } from 'saxen';\nimport { coerceType, parseNameNS, isSimpleType, Moddle } from 'moddle';\n\nfunction hasLowerCaseAlias(pkg) {\n  return pkg.xml && pkg.xml.tagAlias === 'lowerCase';\n}\n\nvar DEFAULT_NS_MAP = {\n  'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n  'xml': 'http://www.w3.org/XML/1998/namespace'\n};\n\nvar SERIALIZE_PROPERTY = 'property';\n\nfunction getSerialization(element) {\n  return element.xml && element.xml.serialize;\n}\n\nfunction getSerializationType(element) {\n  const type = getSerialization(element);\n\n  return type !== SERIALIZE_PROPERTY && (type || null);\n}\n\nfunction capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nfunction aliasToName(aliasNs, pkg) {\n\n  if (!hasLowerCaseAlias(pkg)) {\n    return aliasNs.name;\n  }\n\n  return aliasNs.prefix + ':' + capitalize(aliasNs.localName);\n}\n\n/**\n * Un-prefix a potentially prefixed type name.\n *\n * @param {NsName} nameNs\n * @param {Object} [pkg]\n *\n * @return {string}\n */\nfunction prefixedToName(nameNs, pkg) {\n\n  var name = nameNs.name,\n      localName = nameNs.localName;\n\n  var typePrefix = pkg && pkg.xml && pkg.xml.typePrefix;\n\n  if (typePrefix && localName.indexOf(typePrefix) === 0) {\n    return nameNs.prefix + ':' + localName.slice(typePrefix.length);\n  } else {\n    return name;\n  }\n}\n\nfunction normalizeTypeName(name, nsMap, model) {\n\n  // normalize against actual NS\n  const nameNs = parseNameNS(name, nsMap.xmlns);\n\n  const normalizedName = `${ nsMap[nameNs.prefix] || nameNs.prefix }:${ nameNs.localName }`;\n\n  const normalizedNameNs = parseNameNS(normalizedName);\n\n  // determine actual type name, based on package-defined prefix\n  var pkg = model.getPackage(normalizedNameNs.prefix);\n\n  return prefixedToName(normalizedNameNs, pkg);\n}\n\nfunction error(message) {\n  return new Error(message);\n}\n\n/**\n * Get the moddle descriptor for a given instance or type.\n *\n * @param  {ModdleElement|Function} element\n *\n * @return {Object} the moddle descriptor\n */\nfunction getModdleDescriptor(element) {\n  return element.$descriptor;\n}\n\n\n/**\n * A parse context.\n *\n * @class\n *\n * @param {Object} options\n * @param {ElementHandler} options.rootHandler the root handler for parsing a document\n * @param {boolean} [options.lax=false] whether or not to ignore invalid elements\n */\nfunction Context(options) {\n\n  /**\n   * @property {ElementHandler} rootHandler\n   */\n\n  /**\n   * @property {Boolean} lax\n   */\n\n  assign(this, options);\n\n  this.elementsById = {};\n  this.references = [];\n  this.warnings = [];\n\n  /**\n   * Add an unresolved reference.\n   *\n   * @param {Object} reference\n   */\n  this.addReference = function(reference) {\n    this.references.push(reference);\n  };\n\n  /**\n   * Add a processed element.\n   *\n   * @param {ModdleElement} element\n   */\n  this.addElement = function(element) {\n\n    if (!element) {\n      throw error('expected element');\n    }\n\n    var elementsById = this.elementsById;\n\n    var descriptor = getModdleDescriptor(element);\n\n    var idProperty = descriptor.idProperty,\n        id;\n\n    if (idProperty) {\n      id = element.get(idProperty.name);\n\n      if (id) {\n\n        // for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\n        if (!/^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i.test(id)) {\n          throw new Error('illegal ID <' + id + '>');\n        }\n\n        if (elementsById[id]) {\n          throw error('duplicate ID <' + id + '>');\n        }\n\n        elementsById[id] = element;\n      }\n    }\n  };\n\n  /**\n   * Add an import warning.\n   *\n   * @param {Object} warning\n   * @param {String} warning.message\n   * @param {Error} [warning.error]\n   */\n  this.addWarning = function(warning) {\n    this.warnings.push(warning);\n  };\n}\n\nfunction BaseHandler() {}\n\nBaseHandler.prototype.handleEnd = function() {};\nBaseHandler.prototype.handleText = function() {};\nBaseHandler.prototype.handleNode = function() {};\n\n\n/**\n * A simple pass through handler that does nothing except for\n * ignoring all input it receives.\n *\n * This is used to ignore unknown elements and\n * attributes.\n */\nfunction NoopHandler() { }\n\nNoopHandler.prototype = Object.create(BaseHandler.prototype);\n\nNoopHandler.prototype.handleNode = function() {\n  return this;\n};\n\nfunction BodyHandler() {}\n\nBodyHandler.prototype = Object.create(BaseHandler.prototype);\n\nBodyHandler.prototype.handleText = function(text) {\n  this.body = (this.body || '') + text;\n};\n\nfunction ReferenceHandler(property, context) {\n  this.property = property;\n  this.context = context;\n}\n\nReferenceHandler.prototype = Object.create(BodyHandler.prototype);\n\nReferenceHandler.prototype.handleNode = function(node) {\n\n  if (this.element) {\n    throw error('expected no sub nodes');\n  } else {\n    this.element = this.createReference(node);\n  }\n\n  return this;\n};\n\nReferenceHandler.prototype.handleEnd = function() {\n  this.element.id = this.body;\n};\n\nReferenceHandler.prototype.createReference = function(node) {\n  return {\n    property: this.property.ns.name,\n    id: ''\n  };\n};\n\nfunction ValueHandler(propertyDesc, element) {\n  this.element = element;\n  this.propertyDesc = propertyDesc;\n}\n\nValueHandler.prototype = Object.create(BodyHandler.prototype);\n\nValueHandler.prototype.handleEnd = function() {\n\n  var value = this.body || '',\n      element = this.element,\n      propertyDesc = this.propertyDesc;\n\n  value = coerceType(propertyDesc.type, value);\n\n  if (propertyDesc.isMany) {\n    element.get(propertyDesc.name).push(value);\n  } else {\n    element.set(propertyDesc.name, value);\n  }\n};\n\n\nfunction BaseElementHandler() {}\n\nBaseElementHandler.prototype = Object.create(BodyHandler.prototype);\n\nBaseElementHandler.prototype.handleNode = function(node) {\n  var parser = this,\n      element = this.element;\n\n  if (!element) {\n    element = this.element = this.createElement(node);\n\n    this.context.addElement(element);\n  } else {\n    parser = this.handleChild(node);\n  }\n\n  return parser;\n};\n\n/**\n * @class Reader.ElementHandler\n *\n */\nfunction ElementHandler(model, typeName, context) {\n  this.model = model;\n  this.type = model.getType(typeName);\n  this.context = context;\n}\n\nElementHandler.prototype = Object.create(BaseElementHandler.prototype);\n\nElementHandler.prototype.addReference = function(reference) {\n  this.context.addReference(reference);\n};\n\nElementHandler.prototype.handleText = function(text) {\n\n  var element = this.element,\n      descriptor = getModdleDescriptor(element),\n      bodyProperty = descriptor.bodyProperty;\n\n  if (!bodyProperty) {\n    throw error('unexpected body text <' + text + '>');\n  }\n\n  BodyHandler.prototype.handleText.call(this, text);\n};\n\nElementHandler.prototype.handleEnd = function() {\n\n  var value = this.body,\n      element = this.element,\n      descriptor = getModdleDescriptor(element),\n      bodyProperty = descriptor.bodyProperty;\n\n  if (bodyProperty && value !== undefined) {\n    value = coerceType(bodyProperty.type, value);\n    element.set(bodyProperty.name, value);\n  }\n};\n\n/**\n * Create an instance of the model from the given node.\n *\n * @param  {Element} node the xml node\n */\nElementHandler.prototype.createElement = function(node) {\n  var attributes = node.attributes,\n      Type = this.type,\n      descriptor = getModdleDescriptor(Type),\n      context = this.context,\n      instance = new Type({}),\n      model = this.model,\n      propNameNs;\n\n  forEach(attributes, function(value, name) {\n\n    var prop = descriptor.propertiesByName[name],\n        values;\n\n    if (prop && prop.isReference) {\n\n      if (!prop.isMany) {\n        context.addReference({\n          element: instance,\n          property: prop.ns.name,\n          id: value\n        });\n      } else {\n\n        // IDREFS: parse references as whitespace-separated list\n        values = value.split(' ');\n\n        forEach(values, function(v) {\n          context.addReference({\n            element: instance,\n            property: prop.ns.name,\n            id: v\n          });\n        });\n      }\n\n    } else {\n      if (prop) {\n        value = coerceType(prop.type, value);\n      } else if (name === 'xmlns') {\n        name = ':' + name;\n      } else {\n        propNameNs = parseNameNS(name, descriptor.ns.prefix);\n\n        // check whether attribute is defined in a well-known namespace\n        // if that is the case we emit a warning to indicate potential misuse\n        if (model.getPackage(propNameNs.prefix)) {\n\n          context.addWarning({\n            message: 'unknown attribute <' + name + '>',\n            element: instance,\n            property: name,\n            value: value\n          });\n        }\n      }\n\n      instance.set(name, value);\n    }\n  });\n\n  return instance;\n};\n\nElementHandler.prototype.getPropertyForNode = function(node) {\n\n  var name = node.name;\n  var nameNs = parseNameNS(name);\n\n  var type = this.type,\n      model = this.model,\n      descriptor = getModdleDescriptor(type);\n\n  var propertyName = nameNs.name,\n      property = descriptor.propertiesByName[propertyName];\n\n  // search for properties by name first\n\n  if (property && !property.isAttr) {\n\n    const serializationType = getSerializationType(property);\n\n    if (serializationType) {\n      const elementTypeName = node.attributes[serializationType];\n\n      // type is optional, if it does not exists the\n      // default type is assumed\n      if (elementTypeName) {\n\n        // convert the prefix used to the mapped form, but also\n        // take possible type prefixes from XML\n        // into account, i.e.: xsi:type=\"t{ActualType}\",\n        const normalizedTypeName = normalizeTypeName(elementTypeName, node.ns, model);\n\n        const elementType = model.getType(normalizedTypeName);\n\n        return assign({}, property, {\n          effectiveType: getModdleDescriptor(elementType).name\n        });\n      }\n    }\n\n    // search for properties by name first\n    return property;\n  }\n\n  var pkg = model.getPackage(nameNs.prefix);\n\n  if (pkg) {\n    const elementTypeName = aliasToName(nameNs, pkg);\n    const elementType = model.getType(elementTypeName);\n\n    // search for collection members later\n    property = find(descriptor.properties, function(p) {\n      return !p.isVirtual && !p.isReference && !p.isAttribute && elementType.hasType(p.type);\n    });\n\n    if (property) {\n      return assign({}, property, {\n        effectiveType: getModdleDescriptor(elementType).name\n      });\n    }\n  } else {\n\n    // parse unknown element (maybe extension)\n    property = find(descriptor.properties, function(p) {\n      return !p.isReference && !p.isAttribute && p.type === 'Element';\n    });\n\n    if (property) {\n      return property;\n    }\n  }\n\n  throw error('unrecognized element <' + nameNs.name + '>');\n};\n\nElementHandler.prototype.toString = function() {\n  return 'ElementDescriptor[' + getModdleDescriptor(this.type).name + ']';\n};\n\nElementHandler.prototype.valueHandler = function(propertyDesc, element) {\n  return new ValueHandler(propertyDesc, element);\n};\n\nElementHandler.prototype.referenceHandler = function(propertyDesc) {\n  return new ReferenceHandler(propertyDesc, this.context);\n};\n\nElementHandler.prototype.handler = function(type) {\n  if (type === 'Element') {\n    return new GenericElementHandler(this.model, type, this.context);\n  } else {\n    return new ElementHandler(this.model, type, this.context);\n  }\n};\n\n/**\n * Handle the child element parsing\n *\n * @param  {Element} node the xml node\n */\nElementHandler.prototype.handleChild = function(node) {\n  var propertyDesc, type, element, childHandler;\n\n  propertyDesc = this.getPropertyForNode(node);\n  element = this.element;\n\n  type = propertyDesc.effectiveType || propertyDesc.type;\n\n  if (isSimpleType(type)) {\n    return this.valueHandler(propertyDesc, element);\n  }\n\n  if (propertyDesc.isReference) {\n    childHandler = this.referenceHandler(propertyDesc).handleNode(node);\n  } else {\n    childHandler = this.handler(type).handleNode(node);\n  }\n\n  var newElement = childHandler.element;\n\n  // child handles may decide to skip elements\n  // by not returning anything\n  if (newElement !== undefined) {\n\n    if (propertyDesc.isMany) {\n      element.get(propertyDesc.name).push(newElement);\n    } else {\n      element.set(propertyDesc.name, newElement);\n    }\n\n    if (propertyDesc.isReference) {\n      assign(newElement, {\n        element: element\n      });\n\n      this.context.addReference(newElement);\n    } else {\n\n      // establish child -> parent relationship\n      newElement.$parent = element;\n    }\n  }\n\n  return childHandler;\n};\n\n/**\n * An element handler that performs special validation\n * to ensure the node it gets initialized with matches\n * the handlers type (namespace wise).\n *\n * @param {Moddle} model\n * @param {String} typeName\n * @param {Context} context\n */\nfunction RootElementHandler(model, typeName, context) {\n  ElementHandler.call(this, model, typeName, context);\n}\n\nRootElementHandler.prototype = Object.create(ElementHandler.prototype);\n\nRootElementHandler.prototype.createElement = function(node) {\n\n  var name = node.name,\n      nameNs = parseNameNS(name),\n      model = this.model,\n      type = this.type,\n      pkg = model.getPackage(nameNs.prefix),\n      typeName = pkg && aliasToName(nameNs, pkg) || name;\n\n  // verify the correct namespace if we parse\n  // the first element in the handler tree\n  //\n  // this ensures we don't mistakenly import wrong namespace elements\n  if (!type.hasType(typeName)) {\n    throw error('unexpected element <' + node.originalName + '>');\n  }\n\n  return ElementHandler.prototype.createElement.call(this, node);\n};\n\n\nfunction GenericElementHandler(model, typeName, context) {\n  this.model = model;\n  this.context = context;\n}\n\nGenericElementHandler.prototype = Object.create(BaseElementHandler.prototype);\n\nGenericElementHandler.prototype.createElement = function(node) {\n\n  var name = node.name,\n      ns = parseNameNS(name),\n      prefix = ns.prefix,\n      uri = node.ns[prefix + '$uri'],\n      attributes = node.attributes;\n\n  return this.model.createAny(name, uri, attributes);\n};\n\nGenericElementHandler.prototype.handleChild = function(node) {\n\n  var handler = new GenericElementHandler(this.model, 'Element', this.context).handleNode(node),\n      element = this.element;\n\n  var newElement = handler.element,\n      children;\n\n  if (newElement !== undefined) {\n    children = element.$children = element.$children || [];\n    children.push(newElement);\n\n    // establish child -> parent relationship\n    newElement.$parent = element;\n  }\n\n  return handler;\n};\n\nGenericElementHandler.prototype.handleEnd = function() {\n  if (this.body) {\n    this.element.$body = this.body;\n  }\n};\n\n/**\n * A reader for a meta-model\n *\n * @param {Object} options\n * @param {Model} options.model used to read xml files\n * @param {Boolean} options.lax whether to make parse errors warnings\n */\nfunction Reader(options) {\n\n  if (options instanceof Moddle) {\n    options = {\n      model: options\n    };\n  }\n\n  assign(this, { lax: false }, options);\n}\n\n/**\n * The fromXML result.\n *\n * @typedef {Object} ParseResult\n *\n * @property {ModdleElement} rootElement\n * @property {Array<Object>} references\n * @property {Array<Error>} warnings\n * @property {Object} elementsById - a mapping containing each ID -> ModdleElement\n */\n\n/**\n * The fromXML result.\n *\n * @typedef {Error} ParseError\n *\n * @property {Array<Error>} warnings\n */\n\n/**\n * Parse the given XML into a moddle document tree.\n *\n * @param {String} xml\n * @param {ElementHandler|Object} options or rootHandler\n *\n * @returns {Promise<ParseResult, ParseError>}\n */\nReader.prototype.fromXML = function(xml, options, done) {\n\n  var rootHandler = options.rootHandler;\n\n  if (options instanceof ElementHandler) {\n\n    // root handler passed via (xml, { rootHandler: ElementHandler }, ...)\n    rootHandler = options;\n    options = {};\n  } else {\n    if (typeof options === 'string') {\n\n      // rootHandler passed via (xml, 'someString', ...)\n      rootHandler = this.handler(options);\n      options = {};\n    } else if (typeof rootHandler === 'string') {\n\n      // rootHandler passed via (xml, { rootHandler: 'someString' }, ...)\n      rootHandler = this.handler(rootHandler);\n    }\n  }\n\n  var model = this.model,\n      lax = this.lax;\n\n  var context = new Context(assign({}, options, { rootHandler: rootHandler })),\n      parser = new Parser({ proxy: true }),\n      stack = createStack();\n\n  rootHandler.context = context;\n\n  // push root handler\n  stack.push(rootHandler);\n\n\n  /**\n   * Handle error.\n   *\n   * @param  {Error} err\n   * @param  {Function} getContext\n   * @param  {boolean} lax\n   *\n   * @return {boolean} true if handled\n   */\n  function handleError(err, getContext, lax) {\n\n    var ctx = getContext();\n\n    var line = ctx.line,\n        column = ctx.column,\n        data = ctx.data;\n\n    // we receive the full context data here,\n    // for elements trim down the information\n    // to the tag name, only\n    if (data.charAt(0) === '<' && data.indexOf(' ') !== -1) {\n      data = data.slice(0, data.indexOf(' ')) + '>';\n    }\n\n    var message =\n      'unparsable content ' + (data ? data + ' ' : '') + 'detected\\n\\t' +\n        'line: ' + line + '\\n\\t' +\n        'column: ' + column + '\\n\\t' +\n        'nested error: ' + err.message;\n\n    if (lax) {\n      context.addWarning({\n        message: message,\n        error: err\n      });\n\n      return true;\n    } else {\n      throw error(message);\n    }\n  }\n\n  function handleWarning(err, getContext) {\n\n    // just like handling errors in <lax=true> mode\n    return handleError(err, getContext, true);\n  }\n\n  /**\n   * Resolve collected references on parse end.\n   */\n  function resolveReferences() {\n\n    var elementsById = context.elementsById;\n    var references = context.references;\n\n    var i, r;\n\n    for (i = 0; (r = references[i]); i++) {\n      var element = r.element;\n      var reference = elementsById[r.id];\n      var property = getModdleDescriptor(element).propertiesByName[r.property];\n\n      if (!reference) {\n        context.addWarning({\n          message: 'unresolved reference <' + r.id + '>',\n          element: r.element,\n          property: r.property,\n          value: r.id\n        });\n      }\n\n      if (property.isMany) {\n        var collection = element.get(property.name),\n            idx = collection.indexOf(r);\n\n        // we replace an existing place holder (idx != -1) or\n        // append to the collection instead\n        if (idx === -1) {\n          idx = collection.length;\n        }\n\n        if (!reference) {\n\n          // remove unresolvable reference\n          collection.splice(idx, 1);\n        } else {\n\n          // add or update reference in collection\n          collection[idx] = reference;\n        }\n      } else {\n        element.set(property.name, reference);\n      }\n    }\n  }\n\n  function handleClose() {\n    stack.pop().handleEnd();\n  }\n\n  var PREAMBLE_START_PATTERN = /^<\\?xml /i;\n\n  var ENCODING_PATTERN = / encoding=\"([^\"]+)\"/i;\n\n  var UTF_8_PATTERN = /^utf-8$/i;\n\n  function handleQuestion(question) {\n\n    if (!PREAMBLE_START_PATTERN.test(question)) {\n      return;\n    }\n\n    var match = ENCODING_PATTERN.exec(question);\n    var encoding = match && match[1];\n\n    if (!encoding || UTF_8_PATTERN.test(encoding)) {\n      return;\n    }\n\n    context.addWarning({\n      message:\n        'unsupported document encoding <' + encoding + '>, ' +\n        'falling back to UTF-8'\n    });\n  }\n\n  function handleOpen(node, getContext) {\n    var handler = stack.peek();\n\n    try {\n      stack.push(handler.handleNode(node));\n    } catch (err) {\n\n      if (handleError(err, getContext, lax)) {\n        stack.push(new NoopHandler());\n      }\n    }\n  }\n\n  function handleCData(text, getContext) {\n\n    try {\n      stack.peek().handleText(text);\n    } catch (err) {\n      handleWarning(err, getContext);\n    }\n  }\n\n  function handleText(text, getContext) {\n\n    // strip whitespace only nodes, i.e. before\n    // <!CDATA[ ... ]> sections and in between tags\n\n    if (!text.trim()) {\n      return;\n    }\n\n    handleCData(text, getContext);\n  }\n\n  var uriMap = model.getPackages().reduce(function(uriMap, p) {\n    uriMap[p.uri] = p.prefix;\n\n    return uriMap;\n  }, Object.entries(DEFAULT_NS_MAP).reduce(function(map, [ prefix, url ]) {\n    map[url] = prefix;\n\n    return map;\n  }, model.config && model.config.nsMap || {}));\n\n  parser\n    .ns(uriMap)\n    .on('openTag', function(obj, decodeStr, selfClosing, getContext) {\n\n      // gracefully handle unparsable attributes (attrs=false)\n      var attrs = obj.attrs || {};\n\n      var decodedAttrs = Object.keys(attrs).reduce(function(d, key) {\n        var value = decodeStr(attrs[key]);\n\n        d[key] = value;\n\n        return d;\n      }, {});\n\n      var node = {\n        name: obj.name,\n        originalName: obj.originalName,\n        attributes: decodedAttrs,\n        ns: obj.ns\n      };\n\n      handleOpen(node, getContext);\n    })\n    .on('question', handleQuestion)\n    .on('closeTag', handleClose)\n    .on('cdata', handleCData)\n    .on('text', function(text, decodeEntities, getContext) {\n      handleText(decodeEntities(text), getContext);\n    })\n    .on('error', handleError)\n    .on('warn', handleWarning);\n\n  // async XML parsing to make sure the execution environment\n  // (node or brower) is kept responsive and that certain optimization\n  // strategies can kick in.\n  return new Promise(function(resolve, reject) {\n\n    var err;\n\n    try {\n      parser.parse(xml);\n\n      resolveReferences();\n    } catch (e) {\n      err = e;\n    }\n\n    var rootElement = rootHandler.element;\n\n    if (!err && !rootElement) {\n      err = error('failed to parse document as <' + rootHandler.type.$descriptor.name + '>');\n    }\n\n    var warnings = context.warnings;\n    var references = context.references;\n    var elementsById = context.elementsById;\n\n    if (err) {\n      err.warnings = warnings;\n\n      return reject(err);\n    } else {\n      return resolve({\n        rootElement: rootElement,\n        elementsById: elementsById,\n        references: references,\n        warnings: warnings\n      });\n    }\n  });\n};\n\nReader.prototype.handler = function(name) {\n  return new RootElementHandler(this.model, name);\n};\n\n\n// helpers //////////////////////////\n\nfunction createStack() {\n  var stack = [];\n\n  Object.defineProperty(stack, 'peek', {\n    value: function() {\n      return this[this.length - 1];\n    }\n  });\n\n  return stack;\n}\n\nvar XML_PREAMBLE = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n';\n\nvar ESCAPE_ATTR_CHARS = /<|>|'|\"|&|\\n\\r|\\n/g;\nvar ESCAPE_CHARS = /<|>|&/g;\n\n\nfunction Namespaces(parent) {\n\n  this.prefixMap = {};\n  this.uriMap = {};\n  this.used = {};\n\n  this.wellknown = [];\n  this.custom = [];\n  this.parent = parent;\n\n  this.defaultPrefixMap = parent && parent.defaultPrefixMap || {};\n}\n\nNamespaces.prototype.mapDefaultPrefixes = function(defaultPrefixMap) {\n  this.defaultPrefixMap = defaultPrefixMap;\n};\n\nNamespaces.prototype.defaultUriByPrefix = function(prefix) {\n  return this.defaultPrefixMap[prefix];\n};\n\nNamespaces.prototype.byUri = function(uri) {\n  return this.uriMap[uri] || (\n    this.parent && this.parent.byUri(uri)\n  );\n};\n\nNamespaces.prototype.add = function(ns, isWellknown) {\n\n  this.uriMap[ns.uri] = ns;\n\n  if (isWellknown) {\n    this.wellknown.push(ns);\n  } else {\n    this.custom.push(ns);\n  }\n\n  this.mapPrefix(ns.prefix, ns.uri);\n};\n\nNamespaces.prototype.uriByPrefix = function(prefix) {\n  return this.prefixMap[prefix || 'xmlns'] || (\n    this.parent && this.parent.uriByPrefix(prefix)\n  );\n};\n\nNamespaces.prototype.mapPrefix = function(prefix, uri) {\n  this.prefixMap[prefix || 'xmlns'] = uri;\n};\n\nNamespaces.prototype.getNSKey = function(ns) {\n  return (ns.prefix !== undefined) ? (ns.uri + '|' + ns.prefix) : ns.uri;\n};\n\nNamespaces.prototype.logUsed = function(ns) {\n\n  var uri = ns.uri;\n  var nsKey = this.getNSKey(ns);\n\n  this.used[nsKey] = this.byUri(uri);\n\n  // Inform parent recursively about the usage of this NS\n  if (this.parent) {\n    this.parent.logUsed(ns);\n  }\n};\n\nNamespaces.prototype.getUsed = function(ns) {\n\n  var allNs = [].concat(this.wellknown, this.custom);\n\n  return allNs.filter(ns => {\n    var nsKey = this.getNSKey(ns);\n\n    return this.used[nsKey];\n  });\n};\n\n\nfunction lower(string) {\n  return string.charAt(0).toLowerCase() + string.slice(1);\n}\n\nfunction nameToAlias(name, pkg) {\n  if (hasLowerCaseAlias(pkg)) {\n    return lower(name);\n  } else {\n    return name;\n  }\n}\n\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n}\n\nfunction nsName(ns) {\n  if (isString(ns)) {\n    return ns;\n  } else {\n    return (ns.prefix ? ns.prefix + ':' : '') + ns.localName;\n  }\n}\n\nfunction getNsAttrs(namespaces) {\n\n  return namespaces.getUsed().filter(function(ns) {\n\n    // do not serialize built in <xml> namespace\n    return ns.prefix !== 'xml';\n  }).map(function(ns) {\n    var name = 'xmlns' + (ns.prefix ? ':' + ns.prefix : '');\n    return { name: name, value: ns.uri };\n  });\n\n}\n\nfunction getElementNs(ns, descriptor) {\n  if (descriptor.isGeneric) {\n    return assign({ localName: descriptor.ns.localName }, ns);\n  } else {\n    return assign({ localName: nameToAlias(descriptor.ns.localName, descriptor.$pkg) }, ns);\n  }\n}\n\nfunction getPropertyNs(ns, descriptor) {\n  return assign({ localName: descriptor.ns.localName }, ns);\n}\n\nfunction getSerializableProperties(element) {\n  var descriptor = element.$descriptor;\n\n  return filter(descriptor.properties, function(p) {\n    var name = p.name;\n\n    if (p.isVirtual) {\n      return false;\n    }\n\n    // do not serialize defaults\n    if (!has(element, name)) {\n      return false;\n    }\n\n    var value = element[name];\n\n    // do not serialize default equals\n    if (value === p.default) {\n      return false;\n    }\n\n    // do not serialize null properties\n    if (value === null) {\n      return false;\n    }\n\n    return p.isMany ? value.length : true;\n  });\n}\n\nvar ESCAPE_ATTR_MAP = {\n  '\\n': '#10',\n  '\\n\\r': '#10',\n  '\"': '#34',\n  '\\'': '#39',\n  '<': '#60',\n  '>': '#62',\n  '&': '#38'\n};\n\nvar ESCAPE_MAP = {\n  '<': 'lt',\n  '>': 'gt',\n  '&': 'amp'\n};\n\nfunction escape(str, charPattern, replaceMap) {\n\n  // ensure we are handling strings here\n  str = isString(str) ? str : '' + str;\n\n  return str.replace(charPattern, function(s) {\n    return '&' + replaceMap[s] + ';';\n  });\n}\n\n/**\n * Escape a string attribute to not contain any bad values (line breaks, '\"', ...)\n *\n * @param {String} str the string to escape\n * @return {String} the escaped string\n */\nfunction escapeAttr(str) {\n  return escape(str, ESCAPE_ATTR_CHARS, ESCAPE_ATTR_MAP);\n}\n\nfunction escapeBody(str) {\n  return escape(str, ESCAPE_CHARS, ESCAPE_MAP);\n}\n\nfunction filterAttributes(props) {\n  return filter(props, function(p) { return p.isAttr; });\n}\n\nfunction filterContained(props) {\n  return filter(props, function(p) { return !p.isAttr; });\n}\n\n\nfunction ReferenceSerializer(tagName) {\n  this.tagName = tagName;\n}\n\nReferenceSerializer.prototype.build = function(element) {\n  this.element = element;\n  return this;\n};\n\nReferenceSerializer.prototype.serializeTo = function(writer) {\n  writer\n    .appendIndent()\n    .append('<' + this.tagName + '>' + this.element.id + '</' + this.tagName + '>')\n    .appendNewLine();\n};\n\nfunction BodySerializer() {}\n\nBodySerializer.prototype.serializeValue =\nBodySerializer.prototype.serializeTo = function(writer) {\n  writer.append(\n    this.escape\n      ? escapeBody(this.value)\n      : this.value\n  );\n};\n\nBodySerializer.prototype.build = function(prop, value) {\n  this.value = value;\n\n  if (prop.type === 'String' && value.search(ESCAPE_CHARS) !== -1) {\n    this.escape = true;\n  }\n\n  return this;\n};\n\nfunction ValueSerializer(tagName) {\n  this.tagName = tagName;\n}\n\ninherits(ValueSerializer, BodySerializer);\n\nValueSerializer.prototype.serializeTo = function(writer) {\n\n  writer\n    .appendIndent()\n    .append('<' + this.tagName + '>');\n\n  this.serializeValue(writer);\n\n  writer\n    .append('</' + this.tagName + '>')\n    .appendNewLine();\n};\n\nfunction ElementSerializer(parent, propertyDescriptor) {\n  this.body = [];\n  this.attrs = [];\n\n  this.parent = parent;\n  this.propertyDescriptor = propertyDescriptor;\n}\n\nElementSerializer.prototype.build = function(element) {\n  this.element = element;\n\n  var elementDescriptor = element.$descriptor,\n      propertyDescriptor = this.propertyDescriptor;\n\n  var otherAttrs,\n      properties;\n\n  var isGeneric = elementDescriptor.isGeneric;\n\n  if (isGeneric) {\n    otherAttrs = this.parseGenericNsAttributes(element);\n  } else {\n    otherAttrs = this.parseNsAttributes(element);\n  }\n\n  if (propertyDescriptor) {\n    this.ns = this.nsPropertyTagName(propertyDescriptor);\n  } else {\n    this.ns = this.nsTagName(elementDescriptor);\n  }\n\n  // compute tag name\n  this.tagName = this.addTagName(this.ns);\n\n  if (isGeneric) {\n    this.parseGenericContainments(element);\n  } else {\n    properties = getSerializableProperties(element);\n\n    this.parseAttributes(filterAttributes(properties));\n    this.parseContainments(filterContained(properties));\n  }\n\n  this.parseGenericAttributes(element, otherAttrs);\n\n  return this;\n};\n\nElementSerializer.prototype.nsTagName = function(descriptor) {\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\n  return getElementNs(effectiveNs, descriptor);\n};\n\nElementSerializer.prototype.nsPropertyTagName = function(descriptor) {\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\n  return getPropertyNs(effectiveNs, descriptor);\n};\n\nElementSerializer.prototype.isLocalNs = function(ns) {\n  return ns.uri === this.ns.uri;\n};\n\n/**\n * Get the actual ns attribute name for the given element.\n *\n * @param {Object} element\n * @param {Boolean} [element.inherited=false]\n *\n * @return {Object} nsName\n */\nElementSerializer.prototype.nsAttributeName = function(element) {\n\n  var ns;\n\n  if (isString(element)) {\n    ns = parseNameNS(element);\n  } else {\n    ns = element.ns;\n  }\n\n  // return just local name for inherited attributes\n  if (element.inherited) {\n    return { localName: ns.localName };\n  }\n\n  // parse + log effective ns\n  var effectiveNs = this.logNamespaceUsed(ns);\n\n  // LOG ACTUAL namespace use\n  this.getNamespaces().logUsed(effectiveNs);\n\n  // strip prefix if same namespace like parent\n  if (this.isLocalNs(effectiveNs)) {\n    return { localName: ns.localName };\n  } else {\n    return assign({ localName: ns.localName }, effectiveNs);\n  }\n};\n\nElementSerializer.prototype.parseGenericNsAttributes = function(element) {\n\n  return Object.entries(element).filter(\n    ([ key, value ]) => !key.startsWith('$') && this.parseNsAttribute(element, key, value)\n  ).map(\n    ([ key, value ]) => ({ name: key, value: value })\n  );\n};\n\nElementSerializer.prototype.parseGenericContainments = function(element) {\n  var body = element.$body;\n\n  if (body) {\n    this.body.push(new BodySerializer().build({ type: 'String' }, body));\n  }\n\n  var children = element.$children;\n\n  if (children) {\n    forEach(children, child => {\n      this.body.push(new ElementSerializer(this).build(child));\n    });\n  }\n};\n\nElementSerializer.prototype.parseNsAttribute = function(element, name, value) {\n  var model = element.$model;\n\n  var nameNs = parseNameNS(name);\n\n  var ns;\n\n  // parse xmlns:foo=\"http://foo.bar\"\n  if (nameNs.prefix === 'xmlns') {\n    ns = { prefix: nameNs.localName, uri: value };\n  }\n\n  // parse xmlns=\"http://foo.bar\"\n  if (!nameNs.prefix && nameNs.localName === 'xmlns') {\n    ns = { uri: value };\n  }\n\n  if (!ns) {\n    return {\n      name: name,\n      value: value\n    };\n  }\n\n  if (model && model.getPackage(value)) {\n\n    // register well known namespace\n    this.logNamespace(ns, true, true);\n  } else {\n\n    // log custom namespace directly as used\n    var actualNs = this.logNamespaceUsed(ns, true);\n\n    this.getNamespaces().logUsed(actualNs);\n  }\n};\n\n\n/**\n * Parse namespaces and return a list of left over generic attributes\n *\n * @param  {Object} element\n * @return {Array<Object>}\n */\nElementSerializer.prototype.parseNsAttributes = function(element) {\n  var self = this;\n\n  var genericAttrs = element.$attrs;\n\n  var attributes = [];\n\n  // parse namespace attributes first\n  // and log them. push non namespace attributes to a list\n  // and process them later\n  forEach(genericAttrs, function(value, name) {\n\n    var nonNsAttr = self.parseNsAttribute(element, name, value);\n\n    if (nonNsAttr) {\n      attributes.push(nonNsAttr);\n    }\n  });\n\n  return attributes;\n};\n\nElementSerializer.prototype.parseGenericAttributes = function(element, attributes) {\n\n  var self = this;\n\n  forEach(attributes, function(attr) {\n\n    try {\n      self.addAttribute(self.nsAttributeName(attr.name), attr.value);\n    } catch (e) {\n\n      // eslint-disable-next-line no-undef\n      typeof console !== 'undefined' && console.warn(\n        `missing namespace information for <${\n          attr.name\n        }=${ attr.value }> on`, element, e\n      );\n    }\n  });\n};\n\nElementSerializer.prototype.parseContainments = function(properties) {\n\n  var self = this,\n      body = this.body,\n      element = this.element;\n\n  forEach(properties, function(p) {\n    var value = element.get(p.name),\n        isReference = p.isReference,\n        isMany = p.isMany;\n\n    if (!isMany) {\n      value = [ value ];\n    }\n\n    if (p.isBody) {\n      body.push(new BodySerializer().build(p, value[0]));\n    } else if (isSimpleType(p.type)) {\n      forEach(value, function(v) {\n        body.push(new ValueSerializer(self.addTagName(self.nsPropertyTagName(p))).build(p, v));\n      });\n    } else if (isReference) {\n      forEach(value, function(v) {\n        body.push(new ReferenceSerializer(self.addTagName(self.nsPropertyTagName(p))).build(v));\n      });\n    } else {\n\n      // allow serialization via type\n      // rather than element name\n      var serialization = getSerialization(p);\n\n      forEach(value, function(v) {\n        var serializer;\n\n        if (serialization) {\n          if (serialization === SERIALIZE_PROPERTY) {\n            serializer = new ElementSerializer(self, p);\n          } else {\n            serializer = new TypeSerializer(self, p, serialization);\n          }\n        } else {\n          serializer = new ElementSerializer(self);\n        }\n\n        body.push(serializer.build(v));\n      });\n    }\n  });\n};\n\nElementSerializer.prototype.getNamespaces = function(local) {\n\n  var namespaces = this.namespaces,\n      parent = this.parent,\n      parentNamespaces;\n\n  if (!namespaces) {\n    parentNamespaces = parent && parent.getNamespaces();\n\n    if (local || !parentNamespaces) {\n      this.namespaces = namespaces = new Namespaces(parentNamespaces);\n    } else {\n      namespaces = parentNamespaces;\n    }\n  }\n\n  return namespaces;\n};\n\nElementSerializer.prototype.logNamespace = function(ns, wellknown, local) {\n  var namespaces = this.getNamespaces(local);\n\n  var nsUri = ns.uri,\n      nsPrefix = ns.prefix;\n\n  var existing = namespaces.byUri(nsUri);\n\n  if (!existing || local) {\n    namespaces.add(ns, wellknown);\n  }\n\n  namespaces.mapPrefix(nsPrefix, nsUri);\n\n  return ns;\n};\n\nElementSerializer.prototype.logNamespaceUsed = function(ns, local) {\n  var namespaces = this.getNamespaces(local);\n\n  // ns may be\n  //\n  //   * prefix only\n  //   * prefix:uri\n  //   * localName only\n\n  var prefix = ns.prefix,\n      uri = ns.uri,\n      newPrefix, idx,\n      wellknownUri;\n\n  // handle anonymous namespaces (elementForm=unqualified), cf. #23\n  if (!prefix && !uri) {\n    return { localName: ns.localName };\n  }\n\n  wellknownUri = namespaces.defaultUriByPrefix(prefix);\n\n  uri = uri || wellknownUri || namespaces.uriByPrefix(prefix);\n\n  if (!uri) {\n    throw new Error('no namespace uri given for prefix <' + prefix + '>');\n  }\n\n  ns = namespaces.byUri(uri);\n\n  // register new default prefix <xmlns> in local scope\n  if (!ns && !prefix) {\n    ns = this.logNamespace({ uri }, wellknownUri === uri, true);\n  }\n\n  if (!ns) {\n    newPrefix = prefix;\n    idx = 1;\n\n    // find a prefix that is not mapped yet\n    while (namespaces.uriByPrefix(newPrefix)) {\n      newPrefix = prefix + '_' + idx++;\n    }\n\n    ns = this.logNamespace({ prefix: newPrefix, uri: uri }, wellknownUri === uri);\n  }\n\n  if (prefix) {\n    namespaces.mapPrefix(prefix, uri);\n  }\n\n  return ns;\n};\n\nElementSerializer.prototype.parseAttributes = function(properties) {\n  var self = this,\n      element = this.element;\n\n  forEach(properties, function(p) {\n\n    var value = element.get(p.name);\n\n    if (p.isReference) {\n\n      if (!p.isMany) {\n        value = value.id;\n      } else {\n        var values = [];\n        forEach(value, function(v) {\n          values.push(v.id);\n        });\n\n        // IDREFS is a whitespace-separated list of references.\n        value = values.join(' ');\n      }\n\n    }\n\n    self.addAttribute(self.nsAttributeName(p), value);\n  });\n};\n\nElementSerializer.prototype.addTagName = function(nsTagName) {\n  var actualNs = this.logNamespaceUsed(nsTagName);\n\n  this.getNamespaces().logUsed(actualNs);\n\n  return nsName(nsTagName);\n};\n\nElementSerializer.prototype.addAttribute = function(name, value) {\n  var attrs = this.attrs;\n\n  if (isString(value)) {\n    value = escapeAttr(value);\n  }\n\n  // de-duplicate attributes\n  // https://github.com/bpmn-io/moddle-xml/issues/66\n  var idx = findIndex(attrs, function(element) {\n    return (\n      element.name.localName === name.localName &&\n      element.name.uri === name.uri &&\n      element.name.prefix === name.prefix\n    );\n  });\n\n  var attr = { name: name, value: value };\n\n  if (idx !== -1) {\n    attrs.splice(idx, 1, attr);\n  } else {\n    attrs.push(attr);\n  }\n};\n\nElementSerializer.prototype.serializeAttributes = function(writer) {\n  var attrs = this.attrs,\n      namespaces = this.namespaces;\n\n  if (namespaces) {\n    attrs = getNsAttrs(namespaces).concat(attrs);\n  }\n\n  forEach(attrs, function(a) {\n    writer\n      .append(' ')\n      .append(nsName(a.name)).append('=\"').append(a.value).append('\"');\n  });\n};\n\nElementSerializer.prototype.serializeTo = function(writer) {\n  var firstBody = this.body[0],\n      indent = firstBody && firstBody.constructor !== BodySerializer;\n\n  writer\n    .appendIndent()\n    .append('<' + this.tagName);\n\n  this.serializeAttributes(writer);\n\n  writer.append(firstBody ? '>' : ' />');\n\n  if (firstBody) {\n\n    if (indent) {\n      writer\n        .appendNewLine()\n        .indent();\n    }\n\n    forEach(this.body, function(b) {\n      b.serializeTo(writer);\n    });\n\n    if (indent) {\n      writer\n        .unindent()\n        .appendIndent();\n    }\n\n    writer.append('</' + this.tagName + '>');\n  }\n\n  writer.appendNewLine();\n};\n\n/**\n * A serializer for types that handles serialization of data types\n */\nfunction TypeSerializer(parent, propertyDescriptor, serialization) {\n  ElementSerializer.call(this, parent, propertyDescriptor);\n\n  this.serialization = serialization;\n}\n\ninherits(TypeSerializer, ElementSerializer);\n\nTypeSerializer.prototype.parseNsAttributes = function(element) {\n\n  // extracted attributes with serialization attribute\n  // <type=typeName> stripped; it may be later\n  var attributes = ElementSerializer.prototype.parseNsAttributes.call(this, element).filter(\n    attr => attr.name !== this.serialization\n  );\n\n  var descriptor = element.$descriptor;\n\n  // only serialize <type=typeName> if necessary\n  if (descriptor.name === this.propertyDescriptor.type) {\n    return attributes;\n  }\n\n  var typeNs = this.typeNs = this.nsTagName(descriptor);\n  this.getNamespaces().logUsed(this.typeNs);\n\n  // add xsi:type attribute to represent the elements\n  // actual type\n\n  var pkg = element.$model.getPackage(typeNs.uri),\n      typePrefix = (pkg.xml && pkg.xml.typePrefix) || '';\n\n  this.addAttribute(\n    this.nsAttributeName(this.serialization),\n    (typeNs.prefix ? typeNs.prefix + ':' : '') + typePrefix + descriptor.ns.localName\n  );\n\n  return attributes;\n};\n\nTypeSerializer.prototype.isLocalNs = function(ns) {\n  return ns.uri === (this.typeNs || this.ns).uri;\n};\n\nfunction SavingWriter() {\n  this.value = '';\n\n  this.write = function(str) {\n    this.value += str;\n  };\n}\n\nfunction FormatingWriter(out, format) {\n\n  var indent = [ '' ];\n\n  this.append = function(str) {\n    out.write(str);\n\n    return this;\n  };\n\n  this.appendNewLine = function() {\n    if (format) {\n      out.write('\\n');\n    }\n\n    return this;\n  };\n\n  this.appendIndent = function() {\n    if (format) {\n      out.write(indent.join('  '));\n    }\n\n    return this;\n  };\n\n  this.indent = function() {\n    indent.push('');\n    return this;\n  };\n\n  this.unindent = function() {\n    indent.pop();\n    return this;\n  };\n}\n\n/**\n * A writer for meta-model backed document trees\n *\n * @param {Object} options output options to pass into the writer\n */\nfunction Writer(options) {\n\n  options = assign({ format: false, preamble: true }, options || {});\n\n  function toXML(tree, writer) {\n    var internalWriter = writer || new SavingWriter();\n    var formatingWriter = new FormatingWriter(internalWriter, options.format);\n\n    if (options.preamble) {\n      formatingWriter.append(XML_PREAMBLE);\n    }\n\n    var serializer = new ElementSerializer();\n\n    var model = tree.$model;\n\n    serializer.getNamespaces().mapDefaultPrefixes(getDefaultPrefixMappings(model));\n\n    serializer.build(tree).serializeTo(formatingWriter);\n\n    if (!writer) {\n      return internalWriter.value;\n    }\n  }\n\n  return {\n    toXML: toXML\n  };\n}\n\n\n// helpers ///////////\n\n/**\n * @param {Moddle} model\n *\n * @return { Record<string, string> } map from prefix to URI\n */\nfunction getDefaultPrefixMappings(model) {\n\n  const nsMap = model.config && model.config.nsMap || {};\n\n  const prefixMap = {};\n\n  // { prefix -> uri }\n  for (const prefix in DEFAULT_NS_MAP) {\n    prefixMap[prefix] = DEFAULT_NS_MAP[prefix];\n  }\n\n  // { uri -> prefix }\n  for (const uri in nsMap) {\n    const prefix = nsMap[uri];\n\n    prefixMap[prefix] = uri;\n  }\n\n  for (const pkg of model.getPackages()) {\n    prefixMap[pkg.prefix] = pkg.uri;\n  }\n\n  return prefixMap;\n}\n\nexport { Reader, Writer };\n//# sourceMappingURL=index.js.map\n","import { isString, assign } from 'min-dash';\nimport { Moddle } from 'moddle';\nimport { Reader, Writer } from 'moddle-xml';\n\n/**\n * A sub class of {@link Moddle} with support for import and export of BPMN 2.0 xml files.\n *\n * @class BpmnModdle\n * @extends Moddle\n *\n * @param {Object|Array} packages to use for instantiating the model\n * @param {Object} [options] additional options to pass over\n */\nfunction BpmnModdle(packages, options) {\n  Moddle.call(this, packages, options);\n}\n\nBpmnModdle.prototype = Object.create(Moddle.prototype);\n\n/**\n * The fromXML result.\n *\n * @typedef {Object} ParseResult\n *\n * @property {ModdleElement} rootElement\n * @property {Array<Object>} references\n * @property {Array<Error>} warnings\n * @property {Object} elementsById - a mapping containing each ID -> ModdleElement\n */\n\n/**\n * The fromXML error.\n *\n * @typedef {Error} ParseError\n *\n * @property {Array<Error>} warnings\n */\n\n/**\n * Instantiates a BPMN model tree from a given xml string.\n *\n * @param {String}   xmlStr\n * @param {String}   [typeName='bpmn:Definitions'] name of the root element\n * @param {Object}   [options]  options to pass to the underlying reader\n *\n * @returns {Promise<ParseResult, ParseError>}\n */\nBpmnModdle.prototype.fromXML = function(xmlStr, typeName, options) {\n\n  if (!isString(typeName)) {\n    options = typeName;\n    typeName = 'bpmn:Definitions';\n  }\n\n  var reader = new Reader(assign({ model: this, lax: true }, options));\n  var rootHandler = reader.handler(typeName);\n\n  return reader.fromXML(xmlStr, rootHandler);\n};\n\n\n/**\n * The toXML result.\n *\n * @typedef {Object} SerializationResult\n *\n * @property {String} xml\n */\n\n/**\n * Serializes a BPMN 2.0 object tree to XML.\n *\n * @param {String}   element    the root element, typically an instance of `bpmn:Definitions`\n * @param {Object}   [options]  to pass to the underlying writer\n *\n * @returns {Promise<SerializationResult, Error>}\n */\nBpmnModdle.prototype.toXML = function(element, options) {\n\n  var writer = new Writer(options);\n\n  return new Promise(function(resolve, reject) {\n    try {\n      var result = writer.toXML(element);\n\n      return resolve({\n        xml: result\n      });\n    } catch (err) {\n      return reject(err);\n    }\n  });\n};\n\nvar name$5 = \"BPMN20\";\nvar uri$5 = \"http://www.omg.org/spec/BPMN/20100524/MODEL\";\nvar prefix$5 = \"bpmn\";\nvar associations$5 = [\n];\nvar types$5 = [\n\t{\n\t\tname: \"Interface\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operations\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"implementationRef\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Operation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inMessageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outMessageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"errorRef\",\n\t\t\t\ttype: \"Error\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"implementationRef\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"EndPoint\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Auditing\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalTask\",\n\t\tsuperClass: [\n\t\t\t\"CallableElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"resources\",\n\t\t\t\ttype: \"ResourceRole\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Monitoring\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Performer\",\n\t\tsuperClass: [\n\t\t\t\"ResourceRole\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Process\",\n\t\tsuperClass: [\n\t\t\t\"FlowElementsContainer\",\n\t\t\t\"CallableElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"processType\",\n\t\t\t\ttype: \"ProcessType\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isClosed\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"auditing\",\n\t\t\t\ttype: \"Auditing\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"monitoring\",\n\t\t\t\ttype: \"Monitoring\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"properties\",\n\t\t\t\ttype: \"Property\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"laneSets\",\n\t\t\t\tisMany: true,\n\t\t\t\treplaces: \"FlowElementsContainer#laneSets\",\n\t\t\t\ttype: \"LaneSet\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"flowElements\",\n\t\t\t\tisMany: true,\n\t\t\t\treplaces: \"FlowElementsContainer#flowElements\",\n\t\t\t\ttype: \"FlowElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"artifacts\",\n\t\t\t\ttype: \"Artifact\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resources\",\n\t\t\t\ttype: \"ResourceRole\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationSubscriptions\",\n\t\t\t\ttype: \"CorrelationSubscription\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"supports\",\n\t\t\t\ttype: \"Process\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"definitionalCollaborationRef\",\n\t\t\t\ttype: \"Collaboration\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isExecutable\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LaneSet\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"lanes\",\n\t\t\t\ttype: \"Lane\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Lane\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"partitionElementRef\",\n\t\t\t\ttype: \"BaseElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"partitionElement\",\n\t\t\t\ttype: \"BaseElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"flowNodeRef\",\n\t\t\t\ttype: \"FlowNode\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"childLaneSet\",\n\t\t\t\ttype: \"LaneSet\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalManualTask\",\n\t\tsuperClass: [\n\t\t\t\"GlobalTask\"\n\t\t]\n\t},\n\t{\n\t\tname: \"ManualTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t]\n\t},\n\t{\n\t\tname: \"UserTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"renderings\",\n\t\t\t\ttype: \"Rendering\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Rendering\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"HumanPerformer\",\n\t\tsuperClass: [\n\t\t\t\"Performer\"\n\t\t]\n\t},\n\t{\n\t\tname: \"PotentialOwner\",\n\t\tsuperClass: [\n\t\t\t\"HumanPerformer\"\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalUserTask\",\n\t\tsuperClass: [\n\t\t\t\"GlobalTask\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"renderings\",\n\t\t\t\ttype: \"Rendering\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Gateway\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"gatewayDirection\",\n\t\t\t\ttype: \"GatewayDirection\",\n\t\t\t\t\"default\": \"Unspecified\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"EventBasedGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"instantiate\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventGatewayType\",\n\t\t\t\ttype: \"EventBasedGatewayType\",\n\t\t\t\tisAttr: true,\n\t\t\t\t\"default\": \"Exclusive\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ComplexGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"activationCondition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ExclusiveGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"InclusiveGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ParallelGateway\",\n\t\tsuperClass: [\n\t\t\t\"Gateway\"\n\t\t]\n\t},\n\t{\n\t\tname: \"RootElement\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Relationship\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"type\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"direction\",\n\t\t\t\ttype: \"RelationshipDirection\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"source\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"target\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"BaseElement\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"id\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\",\n\t\t\t\tisId: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"documentation\",\n\t\t\t\ttype: \"Documentation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionDefinitions\",\n\t\t\t\ttype: \"ExtensionDefinition\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionElements\",\n\t\t\t\ttype: \"ExtensionElements\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Extension\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"mustUnderstand\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"definition\",\n\t\t\t\ttype: \"ExtensionDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ExtensionDefinition\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionAttributeDefinitions\",\n\t\t\t\ttype: \"ExtensionAttributeDefinition\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ExtensionAttributeDefinition\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"type\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isReference\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionDefinition\",\n\t\t\t\ttype: \"ExtensionDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ExtensionElements\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"valueRef\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"values\",\n\t\t\t\ttype: \"Element\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensionAttributeDefinition\",\n\t\t\t\ttype: \"ExtensionAttributeDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Documentation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"text\",\n\t\t\t\ttype: \"String\",\n\t\t\t\tisBody: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"textFormat\",\n\t\t\t\t\"default\": \"text/plain\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Event\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowNode\",\n\t\t\t\"InteractionNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"properties\",\n\t\t\t\ttype: \"Property\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"IntermediateCatchEvent\",\n\t\tsuperClass: [\n\t\t\t\"CatchEvent\"\n\t\t]\n\t},\n\t{\n\t\tname: \"IntermediateThrowEvent\",\n\t\tsuperClass: [\n\t\t\t\"ThrowEvent\"\n\t\t]\n\t},\n\t{\n\t\tname: \"EndEvent\",\n\t\tsuperClass: [\n\t\t\t\"ThrowEvent\"\n\t\t]\n\t},\n\t{\n\t\tname: \"StartEvent\",\n\t\tsuperClass: [\n\t\t\t\"CatchEvent\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isInterrupting\",\n\t\t\t\t\"default\": true,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ThrowEvent\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Event\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataInputs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataInputAssociations\",\n\t\t\t\ttype: \"DataInputAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSet\",\n\t\t\t\ttype: \"InputSet\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventDefinitions\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventDefinitionRef\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CatchEvent\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Event\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"parallelMultiple\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\t\"default\": false\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataOutputs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataOutputAssociations\",\n\t\t\t\ttype: \"DataOutputAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSet\",\n\t\t\t\ttype: \"OutputSet\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventDefinitions\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"eventDefinitionRef\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"BoundaryEvent\",\n\t\tsuperClass: [\n\t\t\t\"CatchEvent\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"cancelActivity\",\n\t\t\t\t\"default\": true,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"attachedToRef\",\n\t\t\t\ttype: \"Activity\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"EventDefinition\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"CancelEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t]\n\t},\n\t{\n\t\tname: \"ErrorEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"errorRef\",\n\t\t\t\ttype: \"Error\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"TerminateEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t]\n\t},\n\t{\n\t\tname: \"EscalationEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"escalationRef\",\n\t\t\t\ttype: \"Escalation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Escalation\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"structureRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"escalationCode\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"CompensateEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"waitForCompletion\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\t\"default\": true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"activityRef\",\n\t\t\t\ttype: \"Activity\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"TimerEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"timeDate\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"timeCycle\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"timeDuration\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LinkEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"target\",\n\t\t\t\ttype: \"LinkEventDefinition\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"source\",\n\t\t\t\ttype: \"LinkEventDefinition\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MessageEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ConditionalEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"condition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"SignalEventDefinition\",\n\t\tsuperClass: [\n\t\t\t\"EventDefinition\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"signalRef\",\n\t\t\t\ttype: \"Signal\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Signal\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"structureRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ImplicitThrowEvent\",\n\t\tsuperClass: [\n\t\t\t\"ThrowEvent\"\n\t\t]\n\t},\n\t{\n\t\tname: \"DataState\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ItemAwareElement\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"itemSubjectRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataState\",\n\t\t\t\ttype: \"DataState\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataAssociation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"ItemAwareElement\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"ItemAwareElement\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"transformation\",\n\t\t\t\ttype: \"FormalExpression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"assignment\",\n\t\t\t\ttype: \"Assignment\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataInput\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isCollection\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSetRef\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSetWithOptional\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSetWithWhileExecuting\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataOutput\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isCollection\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSetRef\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSetWithOptional\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSetWithWhileExecuting\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"InputSet\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataInputRefs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"optionalInputRefs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"whileExecutingInputRefs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSetRefs\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"OutputSet\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataOutputRefs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSetRefs\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"optionalOutputRefs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"whileExecutingOutputRefs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Property\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataInputAssociation\",\n\t\tsuperClass: [\n\t\t\t\"DataAssociation\"\n\t\t]\n\t},\n\t{\n\t\tname: \"DataOutputAssociation\",\n\t\tsuperClass: [\n\t\t\t\"DataAssociation\"\n\t\t]\n\t},\n\t{\n\t\tname: \"InputOutputSpecification\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataInputs\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataOutputs\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputSets\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputSets\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataObject\",\n\t\tsuperClass: [\n\t\t\t\"FlowElement\",\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isCollection\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"InputOutputBinding\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"inputDataRef\",\n\t\t\t\ttype: \"InputSet\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputDataRef\",\n\t\t\t\ttype: \"OutputSet\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Assignment\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"from\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"to\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataStore\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\",\n\t\t\t\"ItemAwareElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"capacity\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isUnlimited\",\n\t\t\t\t\"default\": true,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataStoreReference\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\",\n\t\t\t\"FlowElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataStoreRef\",\n\t\t\t\ttype: \"DataStore\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"DataObjectReference\",\n\t\tsuperClass: [\n\t\t\t\"ItemAwareElement\",\n\t\t\t\"FlowElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataObjectRef\",\n\t\t\t\ttype: \"DataObject\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ConversationLink\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"InteractionNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"InteractionNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ConversationAssociation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"innerConversationNodeRef\",\n\t\t\t\ttype: \"ConversationNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outerConversationNodeRef\",\n\t\t\t\ttype: \"ConversationNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CallConversation\",\n\t\tsuperClass: [\n\t\t\t\"ConversationNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"calledCollaborationRef\",\n\t\t\t\ttype: \"Collaboration\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantAssociations\",\n\t\t\t\ttype: \"ParticipantAssociation\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Conversation\",\n\t\tsuperClass: [\n\t\t\t\"ConversationNode\"\n\t\t]\n\t},\n\t{\n\t\tname: \"SubConversation\",\n\t\tsuperClass: [\n\t\t\t\"ConversationNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"conversationNodes\",\n\t\t\t\ttype: \"ConversationNode\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ConversationNode\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"InteractionNode\",\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageFlowRefs\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationKeys\",\n\t\t\t\ttype: \"CorrelationKey\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalConversation\",\n\t\tsuperClass: [\n\t\t\t\"Collaboration\"\n\t\t]\n\t},\n\t{\n\t\tname: \"PartnerEntity\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"PartnerRole\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationProperty\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"correlationPropertyRetrievalExpression\",\n\t\t\t\ttype: \"CorrelationPropertyRetrievalExpression\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"type\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Error\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"structureRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"errorCode\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationKey\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"correlationPropertyRef\",\n\t\t\t\ttype: \"CorrelationProperty\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Expression\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tisAbstract: false,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"body\",\n\t\t\t\tisBody: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"FormalExpression\",\n\t\tsuperClass: [\n\t\t\t\"Expression\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"language\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"evaluatesToTypeRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Message\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"itemRef\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ItemDefinition\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"itemKind\",\n\t\t\t\ttype: \"ItemKind\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"structureRef\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isCollection\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"import\",\n\t\t\t\ttype: \"Import\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"FlowElement\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"auditing\",\n\t\t\t\ttype: \"Auditing\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"monitoring\",\n\t\t\t\ttype: \"Monitoring\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"categoryValueRef\",\n\t\t\t\ttype: \"CategoryValue\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"SequenceFlow\",\n\t\tsuperClass: [\n\t\t\t\"FlowElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isImmediate\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"conditionExpression\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"FlowNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"FlowNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"FlowElementsContainer\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"laneSets\",\n\t\t\t\ttype: \"LaneSet\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"flowElements\",\n\t\t\t\ttype: \"FlowElement\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CallableElement\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ioSpecification\",\n\t\t\t\ttype: \"InputOutputSpecification\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"supportedInterfaceRef\",\n\t\t\t\ttype: \"Interface\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ioBinding\",\n\t\t\t\ttype: \"InputOutputBinding\",\n\t\t\t\tisMany: true,\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"FlowNode\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"incoming\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outgoing\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"lanes\",\n\t\t\t\ttype: \"Lane\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationPropertyRetrievalExpression\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"messagePath\",\n\t\t\t\ttype: \"FormalExpression\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationPropertyBinding\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"dataPath\",\n\t\t\t\ttype: \"FormalExpression\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationPropertyRef\",\n\t\t\t\ttype: \"CorrelationProperty\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Resource\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resourceParameters\",\n\t\t\t\ttype: \"ResourceParameter\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ResourceParameter\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isRequired\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"type\",\n\t\t\t\ttype: \"ItemDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CorrelationSubscription\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"correlationKeyRef\",\n\t\t\t\ttype: \"CorrelationKey\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationPropertyBinding\",\n\t\t\t\ttype: \"CorrelationPropertyBinding\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MessageFlow\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"InteractionNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"InteractionNode\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MessageFlowAssociation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"innerMessageFlowRef\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outerMessageFlowRef\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"InteractionNode\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"incomingConversationLinks\",\n\t\t\t\ttype: \"ConversationLink\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outgoingConversationLinks\",\n\t\t\t\ttype: \"ConversationLink\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Participant\",\n\t\tsuperClass: [\n\t\t\t\"InteractionNode\",\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"interfaceRef\",\n\t\t\t\ttype: \"Interface\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantMultiplicity\",\n\t\t\t\ttype: \"ParticipantMultiplicity\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"endPointRefs\",\n\t\t\t\ttype: \"EndPoint\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"processRef\",\n\t\t\t\ttype: \"Process\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ParticipantAssociation\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"innerParticipantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outerParticipantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ParticipantMultiplicity\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"minimum\",\n\t\t\t\t\"default\": 0,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"maximum\",\n\t\t\t\t\"default\": 1,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Collaboration\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isClosed\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participants\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageFlows\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"artifacts\",\n\t\t\t\ttype: \"Artifact\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"conversations\",\n\t\t\t\ttype: \"ConversationNode\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"conversationAssociations\",\n\t\t\t\ttype: \"ConversationAssociation\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantAssociations\",\n\t\t\t\ttype: \"ParticipantAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageFlowAssociations\",\n\t\t\t\ttype: \"MessageFlowAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationKeys\",\n\t\t\t\ttype: \"CorrelationKey\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"choreographyRef\",\n\t\t\t\ttype: \"Choreography\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"conversationLinks\",\n\t\t\t\ttype: \"ConversationLink\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ChoreographyActivity\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"participantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"initiatingParticipantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"correlationKeys\",\n\t\t\t\ttype: \"CorrelationKey\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopType\",\n\t\t\t\ttype: \"ChoreographyLoopType\",\n\t\t\t\t\"default\": \"None\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CallChoreography\",\n\t\tsuperClass: [\n\t\t\t\"ChoreographyActivity\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"calledChoreographyRef\",\n\t\t\t\ttype: \"Choreography\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantAssociations\",\n\t\t\t\ttype: \"ParticipantAssociation\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"SubChoreography\",\n\t\tsuperClass: [\n\t\t\t\"ChoreographyActivity\",\n\t\t\t\"FlowElementsContainer\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"artifacts\",\n\t\t\t\ttype: \"Artifact\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ChoreographyTask\",\n\t\tsuperClass: [\n\t\t\t\"ChoreographyActivity\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"messageFlowRef\",\n\t\t\t\ttype: \"MessageFlow\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Choreography\",\n\t\tsuperClass: [\n\t\t\t\"Collaboration\",\n\t\t\t\"FlowElementsContainer\"\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalChoreographyTask\",\n\t\tsuperClass: [\n\t\t\t\"Choreography\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"initiatingParticipantRef\",\n\t\t\t\ttype: \"Participant\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"TextAnnotation\",\n\t\tsuperClass: [\n\t\t\t\"Artifact\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"text\",\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"textFormat\",\n\t\t\t\t\"default\": \"text/plain\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Group\",\n\t\tsuperClass: [\n\t\t\t\"Artifact\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"categoryValueRef\",\n\t\t\t\ttype: \"CategoryValue\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Association\",\n\t\tsuperClass: [\n\t\t\t\"Artifact\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"associationDirection\",\n\t\t\t\ttype: \"AssociationDirection\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"sourceRef\",\n\t\t\t\ttype: \"BaseElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetRef\",\n\t\t\t\ttype: \"BaseElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Category\",\n\t\tsuperClass: [\n\t\t\t\"RootElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"categoryValue\",\n\t\t\t\ttype: \"CategoryValue\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Artifact\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"CategoryValue\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"categorizedFlowElements\",\n\t\t\t\ttype: \"FlowElement\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"value\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Activity\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"FlowNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isForCompensation\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\ttype: \"SequenceFlow\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ioSpecification\",\n\t\t\t\ttype: \"InputOutputSpecification\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"boundaryEventRefs\",\n\t\t\t\ttype: \"BoundaryEvent\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"properties\",\n\t\t\t\ttype: \"Property\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataInputAssociations\",\n\t\t\t\ttype: \"DataInputAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"dataOutputAssociations\",\n\t\t\t\ttype: \"DataOutputAssociation\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"startQuantity\",\n\t\t\t\t\"default\": 1,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resources\",\n\t\t\t\ttype: \"ResourceRole\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"completionQuantity\",\n\t\t\t\t\"default\": 1,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Integer\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopCharacteristics\",\n\t\t\t\ttype: \"LoopCharacteristics\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ServiceTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"SubProcess\",\n\t\tsuperClass: [\n\t\t\t\"Activity\",\n\t\t\t\"FlowElementsContainer\",\n\t\t\t\"InteractionNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"triggeredByEvent\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"artifacts\",\n\t\t\t\ttype: \"Artifact\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LoopCharacteristics\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"MultiInstanceLoopCharacteristics\",\n\t\tsuperClass: [\n\t\t\t\"LoopCharacteristics\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"isSequential\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"behavior\",\n\t\t\t\ttype: \"MultiInstanceBehavior\",\n\t\t\t\t\"default\": \"All\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopCardinality\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopDataInputRef\",\n\t\t\t\ttype: \"ItemAwareElement\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopDataOutputRef\",\n\t\t\t\ttype: \"ItemAwareElement\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"inputDataItem\",\n\t\t\t\ttype: \"DataInput\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"outputDataItem\",\n\t\t\t\ttype: \"DataOutput\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"property\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"complexBehaviorDefinition\",\n\t\t\t\ttype: \"ComplexBehaviorDefinition\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"completionCondition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"oneBehaviorEventRef\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"noneBehaviorEventRef\",\n\t\t\t\ttype: \"EventDefinition\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"StandardLoopCharacteristics\",\n\t\tsuperClass: [\n\t\t\t\"LoopCharacteristics\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"testBefore\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopCondition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"loopMaximum\",\n\t\t\t\ttype: \"Integer\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"CallActivity\",\n\t\tsuperClass: [\n\t\t\t\"Activity\",\n\t\t\t\"InteractionNode\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"calledElement\",\n\t\t\t\ttype: \"String\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Task\",\n\t\tsuperClass: [\n\t\t\t\"Activity\",\n\t\t\t\"InteractionNode\"\n\t\t]\n\t},\n\t{\n\t\tname: \"SendTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ReceiveTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"instantiate\",\n\t\t\t\t\"default\": false,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"operationRef\",\n\t\t\t\ttype: \"Operation\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageRef\",\n\t\t\t\ttype: \"Message\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ScriptTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"scriptFormat\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"script\",\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"BusinessRuleTask\",\n\t\tsuperClass: [\n\t\t\t\"Task\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"AdHocSubProcess\",\n\t\tsuperClass: [\n\t\t\t\"SubProcess\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"completionCondition\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ordering\",\n\t\t\t\ttype: \"AdHocOrdering\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"cancelRemainingInstances\",\n\t\t\t\t\"default\": true,\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Transaction\",\n\t\tsuperClass: [\n\t\t\t\"SubProcess\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"protocol\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"method\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalScriptTask\",\n\t\tsuperClass: [\n\t\t\t\"GlobalTask\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"scriptLanguage\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"script\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GlobalBusinessRuleTask\",\n\t\tsuperClass: [\n\t\t\t\"GlobalTask\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"implementation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ComplexBehaviorDefinition\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"condition\",\n\t\t\t\ttype: \"FormalExpression\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"event\",\n\t\t\t\ttype: \"ImplicitThrowEvent\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ResourceRole\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"resourceRef\",\n\t\t\t\ttype: \"Resource\",\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resourceParameterBindings\",\n\t\t\t\ttype: \"ResourceParameterBinding\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resourceAssignmentExpression\",\n\t\t\t\ttype: \"ResourceAssignmentExpression\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ResourceParameterBinding\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"expression\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"parameterRef\",\n\t\t\t\ttype: \"ResourceParameter\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"ResourceAssignmentExpression\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"expression\",\n\t\t\t\ttype: \"Expression\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Import\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"importType\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"location\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"namespace\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Definitions\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetNamespace\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"expressionLanguage\",\n\t\t\t\t\"default\": \"http://www.w3.org/1999/XPath\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"typeLanguage\",\n\t\t\t\t\"default\": \"http://www.w3.org/2001/XMLSchema\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"imports\",\n\t\t\t\ttype: \"Import\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extensions\",\n\t\t\t\ttype: \"Extension\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"rootElements\",\n\t\t\t\ttype: \"RootElement\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"diagrams\",\n\t\t\t\tisMany: true,\n\t\t\t\ttype: \"bpmndi:BPMNDiagram\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"exporter\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"relationships\",\n\t\t\t\ttype: \"Relationship\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"exporterVersion\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar enumerations$3 = [\n\t{\n\t\tname: \"ProcessType\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Public\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Private\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"GatewayDirection\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"Unspecified\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Converging\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Diverging\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Mixed\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"EventBasedGatewayType\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"Parallel\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Exclusive\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"RelationshipDirection\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Forward\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Backward\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Both\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ItemKind\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"Physical\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Information\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ChoreographyLoopType\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Standard\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"MultiInstanceSequential\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"MultiInstanceParallel\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"AssociationDirection\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"One\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Both\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MultiInstanceBehavior\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"One\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"All\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Complex\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"AdHocOrdering\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"Parallel\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"Sequential\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar xml$1 = {\n\ttagAlias: \"lowerCase\",\n\ttypePrefix: \"t\"\n};\nvar BpmnPackage = {\n\tname: name$5,\n\turi: uri$5,\n\tprefix: prefix$5,\n\tassociations: associations$5,\n\ttypes: types$5,\n\tenumerations: enumerations$3,\n\txml: xml$1\n};\n\nvar name$4 = \"BPMNDI\";\nvar uri$4 = \"http://www.omg.org/spec/BPMN/20100524/DI\";\nvar prefix$4 = \"bpmndi\";\nvar types$4 = [\n\t{\n\t\tname: \"BPMNDiagram\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"plane\",\n\t\t\t\ttype: \"BPMNPlane\",\n\t\t\t\tredefines: \"di:Diagram#rootElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"labelStyle\",\n\t\t\t\ttype: \"BPMNLabelStyle\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:Diagram\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNPlane\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"bpmnElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"bpmn:BaseElement\",\n\t\t\t\tredefines: \"di:DiagramElement#modelElement\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:Plane\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNShape\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"bpmnElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"bpmn:BaseElement\",\n\t\t\t\tredefines: \"di:DiagramElement#modelElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isHorizontal\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isExpanded\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isMarkerVisible\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"label\",\n\t\t\t\ttype: \"BPMNLabel\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isMessageVisible\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Boolean\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"participantBandKind\",\n\t\t\t\ttype: \"ParticipantBandKind\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"choreographyActivityShape\",\n\t\t\t\ttype: \"BPMNShape\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:LabeledShape\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNEdge\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"label\",\n\t\t\t\ttype: \"BPMNLabel\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"bpmnElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"bpmn:BaseElement\",\n\t\t\t\tredefines: \"di:DiagramElement#modelElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"sourceElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"di:DiagramElement\",\n\t\t\t\tredefines: \"di:Edge#source\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"targetElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"di:DiagramElement\",\n\t\t\t\tredefines: \"di:Edge#target\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"messageVisibleKind\",\n\t\t\t\ttype: \"MessageVisibleKind\",\n\t\t\t\tisAttr: true,\n\t\t\t\t\"default\": \"initiating\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:LabeledEdge\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNLabel\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"labelStyle\",\n\t\t\t\ttype: \"BPMNLabelStyle\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true,\n\t\t\t\tredefines: \"di:DiagramElement#style\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:Label\"\n\t\t]\n\t},\n\t{\n\t\tname: \"BPMNLabelStyle\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"font\",\n\t\t\t\ttype: \"dc:Font\"\n\t\t\t}\n\t\t],\n\t\tsuperClass: [\n\t\t\t\"di:Style\"\n\t\t]\n\t}\n];\nvar enumerations$2 = [\n\t{\n\t\tname: \"ParticipantBandKind\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"top_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"middle_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"bottom_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"top_non_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"middle_non_initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"bottom_non_initiating\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"MessageVisibleKind\",\n\t\tliteralValues: [\n\t\t\t{\n\t\t\t\tname: \"initiating\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"non_initiating\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar associations$4 = [\n];\nvar BpmnDiPackage = {\n\tname: name$4,\n\turi: uri$4,\n\tprefix: prefix$4,\n\ttypes: types$4,\n\tenumerations: enumerations$2,\n\tassociations: associations$4\n};\n\nvar name$3 = \"DC\";\nvar uri$3 = \"http://www.omg.org/spec/DD/20100524/DC\";\nvar prefix$3 = \"dc\";\nvar types$3 = [\n\t{\n\t\tname: \"Boolean\"\n\t},\n\t{\n\t\tname: \"Integer\"\n\t},\n\t{\n\t\tname: \"Real\"\n\t},\n\t{\n\t\tname: \"String\"\n\t},\n\t{\n\t\tname: \"Font\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\ttype: \"String\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"size\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isBold\",\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isItalic\",\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isUnderline\",\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"isStrikeThrough\",\n\t\t\t\ttype: \"Boolean\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Point\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"x\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\t\"default\": \"0\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"y\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\t\"default\": \"0\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Bounds\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"x\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\t\"default\": \"0\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"y\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\t\"default\": \"0\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"width\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\tisAttr: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"height\",\n\t\t\t\ttype: \"Real\",\n\t\t\t\tisAttr: true\n\t\t\t}\n\t\t]\n\t}\n];\nvar associations$3 = [\n];\nvar DcPackage = {\n\tname: name$3,\n\turi: uri$3,\n\tprefix: prefix$3,\n\ttypes: types$3,\n\tassociations: associations$3\n};\n\nvar name$2 = \"DI\";\nvar uri$2 = \"http://www.omg.org/spec/DD/20100524/DI\";\nvar prefix$2 = \"di\";\nvar types$2 = [\n\t{\n\t\tname: \"DiagramElement\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"id\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisId: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"extension\",\n\t\t\t\ttype: \"Extension\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"owningDiagram\",\n\t\t\t\ttype: \"Diagram\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"owningElement\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"modelElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"style\",\n\t\t\t\ttype: \"Style\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ownedElement\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Node\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"DiagramElement\"\n\t\t]\n\t},\n\t{\n\t\tname: \"Edge\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"DiagramElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"source\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"target\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"waypoint\",\n\t\t\t\tisUnique: false,\n\t\t\t\tisMany: true,\n\t\t\t\ttype: \"dc:Point\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Diagram\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"id\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisId: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"rootElement\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisVirtual: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"documentation\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"resolution\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"Real\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"ownedStyle\",\n\t\t\t\ttype: \"Style\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Shape\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Node\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"bounds\",\n\t\t\t\ttype: \"dc:Bounds\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Plane\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Node\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"planeElement\",\n\t\t\t\ttype: \"DiagramElement\",\n\t\t\t\tsubsettedProperty: \"DiagramElement-ownedElement\",\n\t\t\t\tisMany: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LabeledEdge\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Edge\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"ownedLabel\",\n\t\t\t\ttype: \"Label\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tsubsettedProperty: \"DiagramElement-ownedElement\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"LabeledShape\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Shape\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"ownedLabel\",\n\t\t\t\ttype: \"Label\",\n\t\t\t\tisReadOnly: true,\n\t\t\t\tsubsettedProperty: \"DiagramElement-ownedElement\",\n\t\t\t\tisMany: true,\n\t\t\t\tisVirtual: true\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Label\",\n\t\tisAbstract: true,\n\t\tsuperClass: [\n\t\t\t\"Node\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"bounds\",\n\t\t\t\ttype: \"dc:Bounds\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Style\",\n\t\tisAbstract: true,\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"id\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisId: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"Extension\",\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"values\",\n\t\t\t\tisMany: true,\n\t\t\t\ttype: \"Element\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar associations$2 = [\n];\nvar xml = {\n\ttagAlias: \"lowerCase\"\n};\nvar DiPackage = {\n\tname: name$2,\n\turi: uri$2,\n\tprefix: prefix$2,\n\ttypes: types$2,\n\tassociations: associations$2,\n\txml: xml\n};\n\nvar name$1 = \"bpmn.io colors for BPMN\";\nvar uri$1 = \"http://bpmn.io/schema/bpmn/biocolor/1.0\";\nvar prefix$1 = \"bioc\";\nvar types$1 = [\n\t{\n\t\tname: \"ColoredShape\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNShape\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"stroke\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"fill\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ColoredEdge\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNEdge\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"stroke\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"fill\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar enumerations$1 = [\n];\nvar associations$1 = [\n];\nvar BiocPackage = {\n\tname: name$1,\n\turi: uri$1,\n\tprefix: prefix$1,\n\ttypes: types$1,\n\tenumerations: enumerations$1,\n\tassociations: associations$1\n};\n\nvar name = \"BPMN in Color\";\nvar uri = \"http://www.omg.org/spec/BPMN/non-normative/color/1.0\";\nvar prefix = \"color\";\nvar types = [\n\t{\n\t\tname: \"ColoredLabel\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNLabel\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"color\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ColoredShape\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNShape\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"background-color\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"border-color\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tname: \"ColoredEdge\",\n\t\t\"extends\": [\n\t\t\t\"bpmndi:BPMNEdge\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"border-color\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t}\n];\nvar enumerations = [\n];\nvar associations = [\n];\nvar BpmnInColorPackage = {\n\tname: name,\n\turi: uri,\n\tprefix: prefix,\n\ttypes: types,\n\tenumerations: enumerations,\n\tassociations: associations\n};\n\nconst packages = {\n  bpmn: BpmnPackage,\n  bpmndi: BpmnDiPackage,\n  dc: DcPackage,\n  di: DiPackage,\n  bioc: BiocPackage,\n  color: BpmnInColorPackage\n};\n\nfunction SimpleBpmnModdle(additionalPackages, options) {\n  const pks = assign({}, packages, additionalPackages);\n\n  return new BpmnModdle(pks, options);\n}\n\nexport { SimpleBpmnModdle as default };\n//# sourceMappingURL=index.js.map\n","/**\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\n * under one or more contributor license agreements. See the NOTICE file\n * distributed with this work for additional information regarding copyright\n * ownership.\n *\n * Camunda licenses this file to you under the MIT; you may not use this file\n * except in compliance with the MIT License.\n */\n\nimport StaticResolver from 'bpmnlint/lib/resolver/static-resolver';\n\nimport validate from './rules/element-templates-validate';\nimport compatibility from './rules/element-templates-compatibility';\n\n\nimport BpmnModdle from 'bpmn-moddle';\n\nimport zeebeModdle from 'zeebe-bpmn-moddle/resources/zeebe';\n\nimport { Validator } from '../Validator';\n\nlet lastTemplates = [],\n    lastValidTemplates = [];\n\nexport const ElementTemplateLinterPlugin = function(templates) {\n\n  if (!templatesEqual(lastTemplates, templates)) {\n    const moddle = new BpmnModdle({ zeebe: zeebeModdle });\n\n    const validator = new Validator(moddle).addAll(templates);\n    const validTemplates = validator.getValidTemplates();\n    lastTemplates = templates;\n    lastValidTemplates = validTemplates;\n  }\n\n  return {\n    config: {\n      rules: {\n        'element-templates/validate': [ 'error', { templates: lastValidTemplates } ],\n        'element-templates/compatibility': [ 'warn', { templates: lastValidTemplates } ]\n      }\n    },\n    resolver: new StaticResolver({\n      'rule:bpmnlint-plugin-element-templates/validate': validate,\n      'rule:bpmnlint-plugin-element-templates/compatibility': compatibility\n    })\n  };\n};\n\nfunction templatesEqual(a, b) {\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  return JSON.stringify(a) === JSON.stringify(b);\n}\n"],"names":["shouldCastToFeel","property","feel","getFeelValue","includes","type","ALWAYS_CAST_TO_FEEL","binding","toFeelExpression","value","startsWith","toString","TEMPLATE_ID_ATTR","TEMPLATE_VERSION_ATTR","TEMPLATE_ICON_ATTR","getTemplateId","element","businessObject","getBusinessObject","get","getTemplateVersion","getTemplateIcon","findExtension","extensionElements","is","find","findZeebeProperty","zeebeProperties","name","findInputParameter","ioMapping","parameters","parameter","target","findOutputParameter","source","findTaskHeader","taskHeaders","headers","header","key","findMessage","eventDefinitions","length","findSignal","findTimerEventDefinition","def","getDefaultFixedValue","getDefaultValue","undefined","generatedValue","uuid","getIncompatibleEngines","template","checkEngines","templateEngines","engines","reduce","result","_","engine","has","isSemverCompatible","actual","required","isCompatible","Object","keys","buildTemplatesById","templates","templatesById","forEach","id","version","isUndefined","latest","findTemplates","elementOrTemplateId","templatesIndex","options","includeLatestOnly","deprecated","includeDeprecated","getVersions","versions","values","isNil","flatten","map","isObject","filter","isAny","appliesTo","isString","Error","findExtensions","types","getExtensionElements","findCamundaInOut","matcher","isInOut","findCamundaProperty","camundaProperties","inputOutput","scriptFormat","definition","findCamundaErrorEventDefinition","errorRef","errorEventDefinitions","error","sourceExpression","variables","local","packageVersion","process","ElementTemplates","constructor","commandStack","eventBus","modeling","injector","config","_commandStack","_eventBus","_injector","_modeling","_templatesById","_templates","_engines","_coerceEngines","on","event","set","_getTemplateId","_getTemplateVersion","getDefault","getAll","isDefault","getLatest","getCompatible","enginesOverrides","overridenEngines","_fire","getEngines","setEngines","elementTemplates","validEngines","coercedVersion","coerce","isSemverValid","console","raw","_isCompatible","_getIncompatibleEngines","_getTemplateVerions","applyTemplate","newTemplate","oldTemplate","context","execute","action","payload","fire","removeTemplate","newElement","unlinkTemplate","$inject","PROPERTY_TYPE","ZEBBE_PROPERTY_TYPE","ZEBBE_INPUT_TYPE","ZEEBE_OUTPUT_TYPE","ZEEBE_PROPERTY_TYPE","ZEEBE_TASK_DEFINITION_TYPE_TYPE","ZEEBE_TASK_DEFINITION","ZEEBE_TASK_HEADER_TYPE","MESSAGE_PROPERTY_TYPE","MESSAGE_ZEEBE_SUBSCRIPTION_PROPERTY_TYPE","SIGNAL_PROPERTY_TYPE","TIMER_EVENT_DEFINITION_PROPERTY_TYPE","ZEEBE_CALLED_ELEMENT","ZEEBE_LINKED_RESOURCE_PROPERTY","ZEEBE_USER_TASK","ZEEBE_CALLED_DECISION","ZEEBE_FORM_DEFINITION","ZEEBE_SCRIPT_TASK","ZEEBE_ASSIGNMENT_DEFINITION","ZEEBE_PRIORITY_DEFINITION","ZEEBE_AD_HOC","ZEEBE_TASK_SCHEDULE","EXTENSION_BINDING_TYPES","TASK_DEFINITION_TYPES","IO_BINDING_TYPES","MESSAGE_BINDING_TYPES","PROPERTY_BINDING_TYPES","isTimerExpressionTypeSupported","hasParentEventSubProcess","isInterrupting","isTimerTemplateApplicable","timerBinding","properties","timerType","canTimerTypeBeAppliedWithConversion","parent","$parent","TEMPLATE_FILTERS","DefaultElementTemplates","templateElementFactory","_templateElementFactory","_filterApplicableTemplates","filteredTemplates","filterFn","createElement","create","SUPPORTED_SCHEMA_VERSION","getTemplateSchemaVersion","MORPHABLE_TYPES","Validator","moddle","_validTemplates","_errors","_moddle","addAll","isArray","_logError","add","err","_validateTemplate","push","schemaVersion","$schema","getSchemaVersion","semverCompare","elementTypeError","_validateElementType","schemaValidationResult","validateAgainstSchema","errors","schemaErrors","valid","filteredSchemaErrors","message","enginesError","_validateEngines","rangeStr","isSemverRangeValid","elementType","_isType","sourceType","_canMorph","baseType","moddleType","getType","getElementDescriptor","allTypesByName","targetType","getErrors","getValidTemplates","schemaUri","re","match","instancePath","keyword","SUPPORTED_SCHEMA_PACKAGE","getTemplateSchemaPackage","BaseValidator","schema","isSchemaValid","ElementTemplatesLoader","_loadTemplates","_elementTemplates","isFunction","loadTemplates","reload","_templateErrors","setTemplates","validator","validTemplates","TemplatesLoader","factory","nextId","prefix","ids","Ids","nextPrefixed","getRoot","filterElementsByType","objectList","list","findRootElementsByType","referencedType","root","findRootElementById","elements","isSubprocess","createInputParameter","bpmnFactory","createOutputParameter","createTaskHeader","createTaskDefinition","attrs","createZeebeProperty","shouldUpdate","optional","ensureExtension","extension","getTaskDefinitionPropertyName","removeRootElement","rootElement","canvas","bpmnjs","getRootElement","definitions","getDefinitions","rootElements","newRootElements","e","updateModdleProperties","removeMessage","bo","getReferringElement","messageRef","removeSignal","signal","signalRef","EXPRESSION_TYPES","isExpression","propertyName","descriptor","$descriptor","propertiesByName","createExpression","expression","body","getExpressionValue","ChangeElementTemplateHandler","bpmnReplace","moddleCopy","_bpmnFactory","_bpmnReplace","_moddleCopy","preExecute","removeProperties","_updateZeebeModelerTemplate","_updateZeebeModelerTemplateIcon","_updateElementType","_updateProperties","_updateZeebeTaskDefinition","_updateZeebeInputOutputParameterProperties","_updateZeebeTaskHeaderProperties","_updateZeebePropertyProperties","_updateMessage","_updateSignal","_updateTimerEventDefinition","_updateZeebeModelerTemplateOnReferencedElement","_updateCalledElement","_updateLinkedResources","_updateZeebeUserTask","_updateCalledDecision","_updateZeebeFormDefinition","_updateScriptTask","_updateZeebeAssignmentDefinition","_updateZeebePriorityDefinition","_updateAdHoc","_updateZeebeTaskSchedule","_getOrCreateExtensionElements","updateProperties","newId","newVersion","newIcon","icon","newIconContents","contents","oldProperties","newProperties","oldProperty","oldBinding","oldBindingType","newProperty","newBinding","newBindingType","propertiesToRemove","moddleElement","findOldProperty","newBindingName","newPropertyValue","changedElement","shouldKeepValue","assignedValue","_updateSingleExtensionElement","bindingTypes","extensionType","getPropertyName","without","oldInputs","slice","oldOutputs","inputOrOutput","findBusinessObject","newInputOrOutput","remove","inputParameters","inputParameter","outputParameters","outputParameter","oldHeaders","oldHeader","newHeader","oldZeebeProperties","oldZeebeProperty","zeebeProperty","_updateMessageProperties","_updateMessageZeebeSubscriptionProperties","hasMessageProperties","_updateSignalProperties","hasSignalProperties","removedProperties","_getMessage","removedProperty","_ensureMessage","_getSignal","_ensureSignal","timerEventDefinition","hasTimeCycle","some","p","_ensureNonInterruptingForTimeCycle","timeDate","timeDuration","timeCycle","cancelActivity","messageExtensionElements","zeebeSubscription","_getSubscription","propertiesToSet","newSubscription","referencedElement","_createMessage","_createSignal","eventDefinition","newMessage","copyElement","newSignal","newType","shouldUpdateElementType","replacement","eventDefinitionType","replacedElement","replaceElement","linkedResources","unusedLinkedResources","newLinkedResource","oldLinkedResource","linkName","linkedResource","unusedResourceProperty","hasBinding","userTaskExtension","zeebeUserTask","extensionElement","oldPropertyName","bindingType","input","output","oldBindingName","newPropertyName","currentValue","getPropertyValue","choices","choice","propertyChanged","oldPropertyValue","bindingName","bindingProperty","array","item","index","indexOf","splice","oldType","getEventDefinitionType","$type","RemoveElementTemplateHandler","UnlinkElementTemplateHandler","MultiCommandHandler","command","cmd","ElementTemplatesCommands","registerHandler","hints","shape","createElementsBehavior","applyDefaultTemplate","connection","commandContext","__init__","elementTemplateCommands","ElementTemplateCommands","PropertyBindingProvider","TaskDefinitionTypeBindingProvider","taskDefinition","InputBindingProvider","OutputBindingProvider","TaskHeaderBindingProvider","ZeebePropertiesProvider","MessagePropertyBindingProvider","MessageZeebeSubscriptionBindingProvider","subscription","SignalPropertyBindingProvider","TimerPropertyBindingProvider","CalledElementBindingProvider","calledElement","ensureNoPropagation","LinkedResourcePropertyBindingProvider","ZeebeUserTaskBindingProvider","CalledDecisionBindingProvider","calledDecision","ScriptTaskBindingProvider","scriptTask","ZeebeFormDefinitionBindingProvider","formDefinition","AssignmentDefinitionBindingProvider","assignmentDefinition","PriorityDefinitionBindingProvider","priorityDefinition","AdHocBindingProvider","adHoc","TaskScheduleBindingProvider","taskSchedule","rawValue","getRawPropertyValue","getBooleanPropertyValue","defaultValue","userTask","unknownBindingError","NO_OP","setPropertyValue","propertyValue","commands","propertyType","parseInt","isNaN","existingExpression","oldTaskDefinition","newTaskDefinition","oldZeebeInputParameter","newZeebeInputParameter","oldZeebeOutputParameter","newZeebeOutputParameter","oldTaskHeader","newTaskHeader","newZeebeProperty","commandsToExecute","validateProperty","translate","defaultTranslate","constraints","label","maxLength","minLength","notEmpty","isEmpty","isFeel","pattern","matchesPattern","trim","string","RegExp","test","replacements","replace","applyConditions","elementTemplate","filteredProperties","isPropertyAllowed","isConditionMet","condition","allMatch","conditions","every","isSimpleConditionMet","equals","oneOf","isActive","relatedCondition","propertyObject","getProperty","hasProperty","compareProperty","propertyId","isEventSubProcess","propertyObj","Number","Boolean","obj","prototype","hasOwnProperty","call","TemplateElementFactory","elementFactory","_elementFactory","_providers","TaskDefinitionBindingProvider","ZeebeAssignmentDefinitionBindingProvider","ZeebePriorityDefinitionBindingProvider","_createShape","_setModelerTemplate","hasIcon","_setModelerTemplateIcon","_applyProperties","isExpanded","createShape","_ensureExtensionElements","processedProperties","_applyProperty","dependentProperties","findDependentProperties","_bindProperty","bindingProvider","dependentProperty","findPropertyById","ConditionalBehavior","CommandInterceptor","_saveConditionalState","postExecute","_applyConditions","_ensureConditional","oldTemplateWithConditions","isMetaUpdate","newTemplateWithConditions","hasDifferentPropertyBindings","changeContext","sourceTemplate","targetTemplate","hasNewProperties","hasRemovedProperties","targetProp","sourceProp","compareProps","getMissingProperties","findPropertyWithBinding","areBindingsEqual","prop1","prop2","normalizeReplacer","sort","binding1","binding2","normalizeBinding","a","b","JSON","stringify","ReplaceBehavior","postExecuted","oldShape","oldBo","newShape","newBo","modelerTemplate","modelerTemplateVersion","shouldUnlinkEvent","allowed","TimerTemplateBehavior","_handlePropertiesChange","_unlinkIfInvalidTimerTemplate","el","isRelevantPropertyChange","UpdateTemplatePropertiesOrder","_updatePropertiesOrder","templateProperties","_updateZeebePropertiesOrder","_updateInputOrder","_updateOutputOrder","_updateTaskHeadersOrder","findIndex","propertyToFind","prop","newPropertiesOrder","sortProperties","arrayEquals","newInputOrder","newOutputOrder","newHeadersOrder","objectEquals","idx","aIndex","bIndex","ReferencedElementBehavior","_handlePropertiesUpdate","_handleReplacement","_handleRemoval","referencedRootElement","canHaveReferencedElement","canHaveMessage","_addMessage","canHaveSignal","_addSignal","isLabel","GeneratedValueBehavior","generatedProps","CalledElementBehavior","_ensureNoPropagation","UserTaskBehavior","assign","elementTemplatesReplaceBehavior","elementTemplatesConditionalBehavior","elementTemplatesGeneratedValueBehavior","elementTemplatesReferencedElementBehavior","elementTemplatesUpdatePropertiesOrderBehavior","UpdatePropertiesOrderBehavior","elementTemplatesCalledElementBehavior","elementTemplatesUserTaskBehavior","elementTemplatesTimerTemplateBehavior","__depends__","commandsModule","behaviorModule","createModule","elementTemplatesLoader","getVersionOrDateFromTemplate","metadata","created","toDateString","updated","timestamp","date","Date","year","getFullYear","month","withLeadingZeros","String","getMonth","day","getDate","hours","getHours","minutes","getMinutes","leftPad","character","createElementTemplatesGroup","props","ElementTemplatesGroup","entries","open","setOpen","useLayoutState","empty","toggleOpen","_jsxs","class","children","classnames","onClick","_jsx","TemplateGroupButtons","SectionToggle","entry","component","Component","_createElement","HeaderButton","title","ArrowIcon","useService","templateState","getTemplateState","SelectEntryTemplate","AppliedTemplate","UnknownTemplate","DeprecatedTemplate","IncompatibleTemplate","OutdatedTemplate","selectTemplate","CreateIcon","menuItems","RemoveTemplate","DropdownButton","NotFoundText","separator","newerTemplate","compatible","UpdateAvailableText","cls","text","templateVersion","DeprecationWarning","documentationRef","_Fragment","href","DocumentationIcon","width","height","viewBox","fill","xmlns","fillRule","clipRule","d","IncompatibleText","templateId","latestTemplate","TemplateProps","localTemplate","TemplateId","TemplateName","TemplateVersion","TemplateDescription","TextEntry","content","description","r","t","o","n","i","DOMParser","parseFromString","document","implementation","createHTMLDocument","style","cssText","setAttribute","appendChild","contentWindow","write","close","l","getElementsByTagName","s","firstChild","nodeName","toLowerCase","removeChild","lastChild","textContent","nodeValue","NODE_TYPE_TEXT","NODE_TYPE_ELEMENT","ALLOWED_NODES","ALLOWED_ATTRIBUTES","ALLOWED_URI_PATTERN","ATTR_WHITESPACE_PATTERN","FORM_ELEMENT","sanitizeHTML","html","doc","normalize","sanitizeNode","XMLSerializer","serializeToString","node","nodeType","lcTag","tagName","attributes","attribute","lcName","removeAttribute","isValidAttribute","getAttribute","childNodes","PropertyTooltip","tooltip","Markup","markup","usePropertyAccessors","directSet","useCallback","propertySetter","directGet","propertyGetter","isFeelEnabled","setIsFeelEnabled","useState","feelEnabled","handleFeelToggle","fromFeelExpression","getValue","setValue","propertyValidator","groupByGroupId","groupBy","findCustomGroup","groups","g","isExternalProperty","PropertyDescription","TextAreaProperty","editable","language","placeholder","debounce","TextAreaEntry","monospace","autoResize","validate","disabled","StringProperty","TextFieldEntry","useServiceIfAvailable","service","fallback","resolved","withVariableContext","bpmnElement","setVariables","variableResolver","getVariablesForElement","useEffect","extractVariables","variable","info","origin","join","callback","off","withTooltipContainer","tooltipContainer","useMemo","propertiesPanel","feelTooltipContainer","FeelEntry","BaseFeelEntry","FeelTextAreaEntry","BaseFeelTextAreaEntry","FeelEntryWithVariableContext","FeelTextAreaEntryWithVariableContext","FeelProperty","TextFieldComponent","FeelTextAreaProperty","TextAreaComponent","DropdownProperty","getOptions","dropdownOptions","SelectEntry","BooleanProperty","FeelCheckboxEntry","CheckboxEntry","NumberProperty","FeelNumberEntry","NumberFieldEntry","isNumber","defaultValidator","step","CustomProperties","propertyGroups","groupedProperties","defaultProps","groupId","group","addCustomGroup","openByDefault","customPropertiesGroup","Group","shouldOpen","createCustomEntry","getDefaultType","isEdited","createIsEdited","isFeelEntryEdited","isNumberFieldEntryEdited","isCheckboxEntryEdited","isSelectEntryEdited","isTextFieldEntryEdited","isTextAreaEntryEdited","isEditedEntry","actualValue","ReferenceSelectEntry","autoFocusEntry","prevOptions","usePrevious","domQuery","focusableInput","select","getEventDefinition","eventType","isMessageSupported","getMessageEventDefinition","getMessage","messageEventDefinition","getSignalEventDefinition","isSignalSupported","getSignal","signalEventDefinition","EMPTY_OPTION","CREATE_NEW_OPTION","MessageProps","MessageRef","messages","filteredMessages","withoutTemplatedMessages","sortByName","ReferenceSelect","sortBy","SignalProps","SignalRef","signals","filteredSignals","withoutTemplatedSignals","LOWER_PRIORITY","ALWAYS_VISIBLE_GROUPS","ElementTemplatesPropertiesProvider","registerProvider","getGroups","updateMessageGroup","updateSignalGroup","_shouldShowTemplateProperties","templatesGroup","addGroupsAfter","templateSpecificGroups","concat","getVisibleGroups","messageGroup","findGroup","overrideGenericEntries","signalGroup","oldEntries","newEntries","oldEntry","newEntry","idOrIds","groupsToAdd","Array","acc","unshift","entriesVisible","translateModule","elementTemplatesPropertiesProvider","coreModule","propertiesProviderModule","handleLegacyScopes","scopes","scopesAsArray","scopeName","parameterValue","parameterDefinition","createCamundaProperty","createCamundaIn","createCamundaInOutAttrs","createCamundaInWithBusinessKey","businessKey","createCamundaOut","createCamundaExecutionListener","implementationType","script","createCamundaFieldInjection","DEFAULT_PROPS","createCamundaErrorEventDefinition","errorEventDefinition","createError","bindingErrorRef","CAMUNDA_SERVICE_TASK_LIKE","_updateCamundaModelerTemplate","_updateTaskType","_updateCamundaExecutionListenerProperties","_updateCamundaFieldProperties","_updateCamundaInOutProperties","_updateCamundaInputOutputParameterProperties","_updateCamundaPropertyProperties","_updateCamundaErrorEventDefinitionProperties","newScopeTemplate","_updateScopeProperties","oldErrorEventDefinitions","oldEventDefinition","findOldBusinessObject","newError","newEventDefinition","oldExecutionListeners","newExecutionListeners","oldFields","oldField","newCamundaFieldInjection","oldInsAndOuts","oldInOurOut","newInOrOut","oldInputOrOutput","oldCamundaProperties","oldCamundaProperty","newCamundaProperty","_updateConditionExpression","conditionExpression","camundaServiceTaskLikeProperty","scopeElement","findOldScopeElement","oldScopeTemplate","findOldScopeTemplate","isRootElementScope","oldBusinessObject","newBindingRef","oldBindingRef","scopeTemplate","errorEventDefinitionBinding","findErrorEventDefinitionBinding","scopeId","scope","templateErrorId","elementRegistry","_elementRegistry","_canvas","_replace","_removeTemplate","_removeRootTemplate","_getEventDefinitionType","newBusinessObject","_createBlankBusinessObject","isPlane","shapeId","getShapeIdFromPlane","setRootElement","findRoot","newRoot","oldRoot","moveElements","x","y","getLabel","categoryValueRef","setLabel","CAMUNDA_ERROR_EVENT_DEFINITION_TYPE","CAMUNDA_EXECUTION_LISTENER_TYPE","CAMUNDA_FIELD_TYPE","CAMUNDA_IN_BUSINESS_KEY_TYPE","CAMUNDA_IN_TYPE","CAMUNDA_INPUT_PARAMETER_TYPE","CAMUNDA_OUT_TYPE","CAMUNDA_OUTPUT_PARAMETER_TYPE","CAMUNDA_PROPERTY_TYPE","IN_OUT_BINDING_TYPES","PRIMITIVE_MODDLE_TYPES","getScopeBusinessObject","camundaFields","camundaField","camundaProperty","camundaInOut","propertyDescriptor","oldCamundaErrorEventDefinition","newCamundaErrorEventDefinition","oldCamundaFields","newCamundaFields","oldCamundaInputParameter","newCamundaInputParameter","oldCamundaOutputParameter","newCamundaOutputParameter","oldCamundaInOut","newCamundaInOut","isEmptyString","ErrorProperties","errorGroup","originalItem","items","removeEntry","Expression","getErrorLabel","suffix","endsWith","errorCode","InputProperties","inputGroup","LocalVariableAssignment","Description","addInputParameter","removeInputParameter","ToggleSwitchEntry","switcherLabel","updatedBusinessObject","update","createExtensionElements","createInputOutput","SPACE_REGEX","containsSpace","OutputProperties","ProcessVariableAssignment","AssignToProcessVariable","addOutputParameter","removeOutputParameter","ALWAYS_DISPLAYED_GROUPS","createInputGroup","createOutputGroup","createErrorGroup","filterWithEntriesVisible","ListGroup","CamundaPlatformPropertiesProviderModule","EventBus","check","reporter","versionText","report","entryIds","getEntryId","path","isUpdateAvailable","getEnginesConfig","incomp","getIncompatibilityText","executionPlatform","executionPlatformVersion","camunda","updateAvailable","Base","$model","fromCharCode","ENTITY_PATTERN","ENTITY_MAPPING","k","toUpperCase","replaceEntities","z","decodeEntities","hasLowerCaseAlias","pkg","xml","tagAlias","DEFAULT_NS_MAP","SERIALIZE_PROPERTY","getSerialization","serialize","getSerializationType","BpmnModdle","packages","Moddle","fromXML","xmlStr","typeName","reader","Reader","model","lax","rootHandler","handler","toXML","writer","Writer","Promise","resolve","reject","lastTemplates","lastValidTemplates","ElementTemplateLinterPlugin","templatesEqual","zeebe","zeebeModdle","rules","resolver","StaticResolver","compatibility"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAcA,IAAIo/B,aAAa,GAAG,EAAE;AAClBC,EAAAA,kBAAkB,GAAG,EAAE;MAEdC,2BAA2B,GAAG,UAASlpC,SAAS,EAAE;AAE7D,EAAA,IAAI,CAACmpC,cAAc,CAACH,aAAa,EAAEhpC,SAAS,CAAC,EAAE;AAC7C,IAAA,MAAMoJ,MAAM,GAAG,IAAI0+B,gBAAU,CAAC;AAAEsB,MAAAA,KAAK,EAAEC;AAAY,KAAC,CAAC;IAErD,MAAMv8B,SAAS,GAAG,IAAI3D,SAAS,CAACC,MAAM,CAAC,CAACI,MAAM,CAACxJ,SAAS,CAAC;AACzD,IAAA,MAAM+M,cAAc,GAAGD,SAAS,CAACnB,iBAAiB,EAAE;AACpDq9B,IAAAA,aAAa,GAAGhpC,SAAS;AACzBipC,IAAAA,kBAAkB,GAAGl8B,cAAc;AACrC,EAAA;EAEA,OAAO;AACL3J,IAAAA,MAAM,EAAE;AACNkmC,MAAAA,KAAK,EAAE;QACL,4BAA4B,EAAE,CAAE,OAAO,EAAE;AAAEtpC,UAAAA,SAAS,EAAEipC;AAAmB,SAAC,CAAE;QAC5E,iCAAiC,EAAE,CAAE,MAAM,EAAE;AAAEjpC,UAAAA,SAAS,EAAEipC;SAAoB;AAChF;KACD;IACDM,QAAQ,EAAE,IAAIC,cAAc,CAAC;AAC3B,MAAA,iDAAiD,EAAE5V,QAAQ;AAC3D,MAAA,sDAAsD,EAAE6V;KACzD;GACF;AACH;AAEA,SAASN,cAAcA,CAAChlB,CAAC,EAAEC,CAAC,EAAE;AAC5B,EAAA,IAAID,CAAC,CAAC7lB,MAAM,KAAK8lB,CAAC,CAAC9lB,MAAM,EAAE;AACzB,IAAA,OAAO,KAAK;AACd,EAAA;AAEA,EAAA,OAAO+lB,IAAI,CAACC,SAAS,CAACH,CAAC,CAAC,KAAKE,IAAI,CAACC,SAAS,CAACF,CAAC,CAAC;AAChD;;;;","x_google_ignoreList":[59,103,104,105,106]}